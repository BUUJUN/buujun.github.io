<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/bj.apple-touch.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/bj.medium.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/bj.small.png"><link rel="mask-icon" href="/images/bj.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"buujun.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat","show_result":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta property="og:type" content="website"><meta property="og:title" content="BUUJUN&#39;s Notes"><meta property="og:url" content="http://buujun.github.io/index.html"><meta property="og:site_name" content="BUUJUN&#39;s Notes"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="BUUJUN WANG"><meta name="twitter:card" content="summary"><link rel="canonical" href="http://buujun.github.io/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>BUUJUN's Notes</title><link rel="dns-prefetch" href="https://waline-server-buujun.vercel.app"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>mjx-container[jax=SVG]{direction:ltr}mjx-container[jax=SVG]>svg{overflow:visible}mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=SVG][justify=left]{text-align:left}mjx-container[jax=SVG][justify=right]{text-align:right}g[data-mml-node=merror]>g{fill:red;stroke:red}g[data-mml-node=merror]>rect[data-background]{fill:#ff0;stroke:none}g[data-mml-node=mtable]>line[data-line]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>rect[data-frame]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>.mjx-dashed{stroke-dasharray:140}g[data-mml-node=mtable]>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}g[data-mml-node=mtable]>svg{overflow:visible}[jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}[jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#f8f8f8;color:#000;box-shadow:2px 2px 5px #aaa}g[data-mml-node=maction][data-toggle]{cursor:pointer}mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#f8f8f8;color:#000}foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}.MathJax path{stroke-width:3}mjx-container[display=true]{overflow:auto hidden}mjx-container[display=true]+br{display:none}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">BUUJUN's Notes</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">love and share</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">15</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">2</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">27</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-globe fa-fw"></i>友链</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-overview-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="BUUJUN WANG" src="/images/bj.avatar.gif"><p class="site-author-name" itemprop="name">BUUJUN WANG</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">27</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">2</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://gitee.com/buujun" title="GitHub → https:&#x2F;&#x2F;gitee.com&#x2F;buujun" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:wangbj27@mail2.sysu.edu.cn" title="E-Mail → mailto:wangbj27@mail2.sysu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=0&id=7323360894&auto=1&height=66"></iframe><div class="sidebar-line"></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li><a href="/2022/cdo/09-pandas-time_series/" title="数据分析-09-Pandas and Time Series" target="_blank">数据分析-09-Pandas and Time Series</a></li><li><a href="/2022/cdo/08-pandas_and_seaborn/" title="数据分析-08-Pandas and Seaborn" target="_blank">数据分析-08-Pandas and Seaborn</a></li><li><a href="/2022/cdo/07-matplotlib/" title="数据分析-07-Matplotlib" target="_blank">数据分析-07-Matplotlib</a></li><li><a href="/2022/cdo/06-pandas-data_wrangling_03/" title="数据分析-06-Pandas-数据重塑 Pt.3" target="_blank">数据分析-06-Pandas-数据重塑 Pt.3</a></li><li><a href="/2022/cdo/06-pandas-data_wrangling_02/" title="数据分析-06-Pandas-数据重塑 Pt.2" target="_blank">数据分析-06-Pandas-数据重塑 Pt.2</a></li></ul></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner index posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/hello-world/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/hello-world/" class="post-title-link" itemprop="url">Welcome to BUUJUN's Blog!</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-thumb-tack"></i> </span><span class="post-meta-item-text">Top</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-29 17:47:23" itemprop="dateCreated datePublished" datetime="2022-07-29T17:47:23Z">2022-07-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-07-30 13:24:29" itemprop="dateModified" datetime="2022-07-30T13:24:29Z">2022-07-30</time></span></div></div></header><div class="post-body" itemprop="articleBody"><p>大家好呀，欢迎来到我的博客！我是大气科学（Atmosphere Science）专业的一名在读研究生，目前所做的工作主要涉及 <strong>人工智能</strong> 和 <strong>气候预测</strong> ，所以我的博客内容也将围绕气象数据处理（ CDO 和 Python）、统计计算和动力方程诊断（Python）、图形绘制（ Matplotlib 和 Cartopy）、深度学习（PyTorch）、模式模拟（ WRF 和 CESM）和文献阅读等方面展开，欢迎大家阅读和讨论！</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/09-pandas-time_series/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/09-pandas-time_series/" class="post-title-link" itemprop="url">数据分析-09-Pandas and Time Series</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 17:02:55 / 修改时间：10:35:48" itemprop="dateCreated datePublished" datetime="2022-07-31T17:02:55Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta</span><br><span class="line"><span class="keyword">from</span> dateutil.parser <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><h2 id="日期和时间数据的类型">日期和时间数据的类型</h2><h3 id="datetime-类型"><strong><em>datetime</em></strong> 类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">now = datetime.now()</span><br><span class="line">now</span><br></pre></td></tr></table></figure><pre><code>datetime.datetime(2021, 10, 9, 21, 38, 2, 642419)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">now.year, now.month, now.day, now.hour, now.minute, now.second</span><br></pre></td></tr></table></figure><pre><code>(2021, 10, 9, 21, 38, 2)</code></pre><h3 id="timedelta-类型"><strong><em>timedelta</em></strong> 类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">delta = datetime(<span class="number">2021</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">40</span>) - datetime(<span class="number">2019</span>, <span class="number">5</span>, <span class="number">1</span>)</span><br><span class="line">delta</span><br></pre></td></tr></table></figure><pre><code>datetime.timedelta(days=731, seconds=520)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">start = datetime(<span class="number">2019</span>, <span class="number">5</span>, <span class="number">1</span>)</span><br><span class="line">start + timedelta(<span class="number">20</span>, <span class="number">20</span>)</span><br></pre></td></tr></table></figure><pre><code>datetime.datetime(2019, 5, 21, 0, 0, 20)</code></pre><h2 id="datetime-与-string-的转换">datetime 与 string 的转换</h2><h3 id="pdto_datetime-list---datetime--string"><strong><em>pd.to_datetime( list )</em></strong> : datetime → string</h3><p>to_datetime 方法可以解析多种不同的日期表示形式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">datestrs = [<span class="string">'2019/5/1/00:00:00'</span>, <span class="string">'2021-5-1 00:00:00'</span>]</span><br><span class="line">pd.to_datetime(datestrs)</span><br></pre></td></tr></table></figure><pre><code>DatetimeIndex(['2019-05-01', '2021-05-01'], dtype='datetime64[ns]', freq=None)</code></pre><h3 id="strdatetime-datetimestrftimey-m-d--datetime--string"><strong><em>str(datetime), datetime.strftime('%Y-%m-%d')</em></strong> : datetime → string</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">now = datetime.now()</span><br><span class="line">now, <span class="built_in">str</span>(now), now.strftime(<span class="string">'%Y-%m-%d'</span>)</span><br></pre></td></tr></table></figure><pre><code>(datetime.datetime(2021, 10, 9, 21, 38, 2, 880786),
 '2021-10-09 21:38:02.880786',
 '2021-10-09')</code></pre><p><strong><em>datetime</em></strong> 格式定义</p><table><thead><tr class="header"><th><strong>代码</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr class="odd"><td>%Y, %y</td><td>4 位数的年, 2 位数的年</td></tr><tr class="even"><td>%m , %h</td><td>2 位数的月 [01, 12], 英文缩写表示的月 [Jan, Feb, ..., Dec]</td></tr><tr class="odd"><td>%d</td><td>2 位数的日 [01, 31]</td></tr><tr class="even"><td></td><td></td></tr><tr class="odd"><td>%H , %l</td><td>24 小时制的时 [00, 23], 12 小时制的时 [01, 12]</td></tr><tr class="even"><td>%M, %S</td><td>2 位数的分 [00, 59], 2 位数的秒 [00, 59]</td></tr><tr class="odd"><td></td><td></td></tr><tr class="even"><td>%w</td><td>整数表示的星期几 [0, 6]</td></tr><tr class="odd"><td>%W</td><td>2 位数的每年的第几周 [00， 53], 以星期一为每周的开始</td></tr><tr class="even"><td>%U</td><td>2 位数的每年的第几周 [00， 53], 以星期日为每周的开始</td></tr><tr class="odd"><td></td><td></td></tr><tr class="even"><td>%F</td><td>%Y-%m-%d</td></tr><tr class="odd"><td>%D</td><td>%m/%d/%y</td></tr></tbody></table><h3 id="datetimestrptimestring-y-m-d--string--datetime"><strong><em>datetime.strptime(string, '%Y-%m-%d')</em></strong> : string → datetime</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">value = <span class="string">'2019-05-01'</span></span><br><span class="line">datetime.strptime(value, <span class="string">'%Y-%m-%d'</span>)</span><br></pre></td></tr></table></figure><pre><code>datetime.datetime(2019, 5, 1, 0, 0)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">datestrs = [<span class="string">'7/25/1998'</span>, <span class="string">'11/24/1997'</span>]</span><br><span class="line">[datetime.strptime(x, <span class="string">'%m/%d/%Y'</span>) <span class="keyword">for</span> x <span class="keyword">in</span> datestrs]</span><br></pre></td></tr></table></figure><pre><code>[datetime.datetime(1998, 7, 25, 0, 0), datetime.datetime(1997, 11, 24, 0, 0)]</code></pre><h3 id="dateutilparserparse-string-dayfirst---string--datetime"><strong><em>dateutil.parser.parse( string, dayfirst )</em></strong> : string → datetime</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parse(<span class="string">'2019-05-01'</span>)</span><br></pre></td></tr></table></figure><pre><code>datetime.datetime(2019, 5, 1, 0, 0)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parse(<span class="string">'May 1, 2019 10:45 PM'</span>)</span><br></pre></td></tr></table></figure><pre><code>datetime.datetime(2019, 5, 1, 22, 45)</code></pre><p>在国际通用的格式中, 日出现在月的前面很普遍, 传入 dayfirst=True 即可解决这个问题</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parse(<span class="string">'1/5/2019'</span>), parse(<span class="string">'1/5/2019'</span>, dayfirst=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><pre><code>(datetime.datetime(2019, 1, 5, 0, 0), datetime.datetime(2019, 5, 1, 0, 0))</code></pre><h2 id="时间序列的索引">时间序列的索引</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dates = [datetime(<span class="number">2011</span>, <span class="number">1</span>, <span class="number">2</span>), datetime(<span class="number">2011</span>, <span class="number">1</span>, <span class="number">5</span>),</span><br><span class="line">         datetime(<span class="number">2011</span>, <span class="number">1</span>, <span class="number">7</span>), datetime(<span class="number">2011</span>, <span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">         datetime(<span class="number">2011</span>, <span class="number">1</span>, <span class="number">10</span>), datetime(<span class="number">2011</span>, <span class="number">1</span>, <span class="number">12</span>)]</span><br><span class="line">ts = pd.Series(np.random.randn(<span class="number">6</span>), index=dates)</span><br><span class="line">ts</span><br></pre></td></tr></table></figure><pre><code>2011-01-02   -1.248703
2011-01-05   -0.072871
2011-01-07    1.672176
2011-01-08   -0.761810
2011-01-10   -0.044322
2011-01-12   -0.701274
dtype: float64</code></pre><p>可以传入一个可以被解释为日期的字符串进行切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ts = pd.Series(np.arange(<span class="number">1000</span>),</span><br><span class="line">                      index=pd.date_range(<span class="string">'1/1/2000'</span>, periods=<span class="number">1000</span>))</span><br><span class="line">ts.head()</span><br></pre></td></tr></table></figure><pre><code>2000-01-01    0
2000-01-02    1
2000-01-03    2
2000-01-04    3
2000-01-05    4
Freq: D, dtype: int32</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts[<span class="string">'2000-1-1'</span>:<span class="string">'2000-1-3'</span>]</span><br></pre></td></tr></table></figure><pre><code>2000-01-01    0
2000-01-02    1
2000-01-03    2
Freq: D, dtype: int32</code></pre><p>对于较长的时间序列, 只需传入“年”或“年月”即可轻松选取数据的切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts[<span class="string">'2001'</span>].head()</span><br></pre></td></tr></table></figure><pre><code>2001-01-01    366
2001-01-02    367
2001-01-03    368
2001-01-04    369
2001-01-05    370
Freq: D, dtype: int32</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts[<span class="string">'2001-2'</span>].head()</span><br></pre></td></tr></table></figure><pre><code>2001-02-01    397
2001-02-02    398
2001-02-03    399
2001-02-04    400
2001-02-05    401
Freq: D, dtype: int32</code></pre><p>传入 datetime 对象也可以进行切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts[datetime(<span class="number">2001</span>,<span class="number">1</span>,<span class="number">7</span>):datetime(<span class="number">2001</span>,<span class="number">1</span>,<span class="number">8</span>)]</span><br></pre></td></tr></table></figure><pre><code>2001-01-07    372
2001-01-08    373
Freq: D, dtype: int32</code></pre><h3 id="tstruncate-before-after-"><strong><em>ts.truncate( before, after )</em></strong></h3><p>before : 向后切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.truncate(before=<span class="string">'2001-9'</span>).head()</span><br></pre></td></tr></table></figure><pre><code>2001-09-01    609
2001-09-02    610
2001-09-03    611
2001-09-04    612
2001-09-05    613
Freq: D, dtype: int32</code></pre><p>after : 向前切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.truncate(after=<span class="string">'2000-2-4'</span>).head()</span><br></pre></td></tr></table></figure><pre><code>2000-01-01    0
2000-01-02    1
2000-01-03    2
2000-01-04    3
2000-01-05    4
Freq: D, dtype: int32</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.truncate(before = <span class="string">'2000-1-1'</span>, after=<span class="string">'2000-1-4'</span>)</span><br></pre></td></tr></table></figure><pre><code>2000-01-01    0
2000-01-02    1
2000-01-03    2
2000-01-04    3
Freq: D, dtype: int32</code></pre><h2 id="时间的范围频率和位移">时间的范围、频率和位移</h2><h3 id="pddate_range-start-end-periods-freq-"><strong><em>pd.date_range( start, end, periods, freq )</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.date_range(<span class="string">'2019-05-01'</span>, <span class="string">'2021-05-01'</span>)</span><br></pre></td></tr></table></figure><pre><code>DatetimeIndex(['2019-05-01', '2019-05-02', '2019-05-03', '2019-05-04',
               '2019-05-05', '2019-05-06', '2019-05-07', '2019-05-08',
               '2019-05-09', '2019-05-10',
               ...
               '2021-04-22', '2021-04-23', '2021-04-24', '2021-04-25',
               '2021-04-26', '2021-04-27', '2021-04-28', '2021-04-29',
               '2021-04-30', '2021-05-01'],
              dtype='datetime64[ns]', length=732, freq='D')</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.date_range(<span class="string">'2019-05-01'</span>, periods=<span class="number">3</span>)</span><br></pre></td></tr></table></figure><pre><code>DatetimeIndex(['2019-05-01', '2019-05-02', '2019-05-03'], dtype='datetime64[ns]', freq='D')</code></pre><p><strong><em>freq = 'BM'</em></strong> : 'business end of month' 每月最后一个工作日</p><table><thead><tr class="header"><th><strong><em>时间的频率表示</em></strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr class="odd"><td>H, T/min, S, L/ms, U</td><td>每小时, 每分钟, 每秒, 每毫秒, 每微秒</td></tr><tr class="even"><td>D, M, MS</td><td>每日历日, 每月的最后一个日历日, 每月的第一个日历日</td></tr><tr class="odd"><td>B, BM, BMS</td><td>每工作日, 每月的最后一个工作日, 每月的第一个工作日</td></tr><tr class="even"><td>W-MON, W-TUE, ..., W-SUN</td><td>每周, 从指定的星期几开始算起</td></tr><tr class="odd"><td>WOM-1MON, WOM-2MON, ..., WOM-4SUN</td><td>每月, 从指定的第几周的星期几开始算起</td></tr><tr class="even"><td>Q-JAN, Q-FEB, ..., Q-DEC</td><td>每季, 从指定的月份的最后一个日历日开始算起</td></tr><tr class="odd"><td>QS-JAN, QS-FEB, ..., QS-DEC</td><td>每季, 从指定的月份的第一个日历日开始算起</td></tr><tr class="even"><td>BQ-JAN, BQ-FEB, ..., BQ-DEC</td><td>每季, 从指定的月份的最后一个工作日开始算起</td></tr><tr class="odd"><td>BQS-JAN, BQS-FEB, ..., BQS-DEC</td><td>每季, 从指定的月份的第一个工作日开始算起</td></tr><tr class="even"><td>A-JAN, A-FEB, ..., A-DEC</td><td>每年, 从指定的月份的最后一个日历日开始算起</td></tr><tr class="odd"><td>AS-JAN, AS-FEB, ..., AS-DEC</td><td>每年, 从指定的月份的第一个日历日开始算起</td></tr><tr class="even"><td>BA-JAN, BA-FEB, ..., BA-DEC</td><td>每年, 从指定的月份的最后一个工作日开始算起</td></tr><tr class="odd"><td>BAS-JAN, BAS-FEB, ..., BAS-DEC</td><td>每年, 从指定的月份的第一个工作日开始算起</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.date_range(<span class="string">'2020-01-01'</span>, <span class="string">'2021-01-01'</span>, freq=<span class="string">'M'</span>)</span><br></pre></td></tr></table></figure><pre><code>DatetimeIndex(['2020-01-31', '2020-02-29', '2020-03-31', '2020-04-30',
               '2020-05-31', '2020-06-30', '2020-07-31', '2020-08-31',
               '2020-09-30', '2020-10-31', '2020-11-30', '2020-12-31'],
              dtype='datetime64[ns]', freq='M')</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.date_range(<span class="string">'2020-01-01'</span>, <span class="string">'2021-01-01'</span>, freq=<span class="string">'4M'</span>)</span><br></pre></td></tr></table></figure><pre><code>DatetimeIndex(['2020-01-31', '2020-05-31', '2020-09-30'], dtype='datetime64[ns]', freq='4M')</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.date_range(<span class="string">'2020-01-01'</span>, <span class="string">'2020-01-02'</span>, freq=<span class="string">'2h30min'</span>)</span><br></pre></td></tr></table></figure><pre><code>DatetimeIndex(['2020-01-01 00:00:00', '2020-01-01 02:30:00',
               '2020-01-01 05:00:00', '2020-01-01 07:30:00',
               '2020-01-01 10:00:00', '2020-01-01 12:30:00',
               '2020-01-01 15:00:00', '2020-01-01 17:30:00',
               '2020-01-01 20:00:00', '2020-01-01 22:30:00'],
              dtype='datetime64[ns]', freq='150T')</code></pre><h3 id="tsshift-periods-freq---时间序列的平移"><strong><em>ts.shift( periods, freq )</em></strong> : 时间序列的平移</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ts = pd.Series(np.arange(<span class="number">1</span>, <span class="number">5</span>),</span><br><span class="line">               index=pd.date_range(<span class="string">'1/1/2000'</span>, periods=<span class="number">4</span>, freq=<span class="string">'D'</span>))</span><br><span class="line">ts</span><br></pre></td></tr></table></figure><pre><code>2000-01-01    1
2000-01-02    2
2000-01-03    3
2000-01-04    4
Freq: D, dtype: int32</code></pre><p>Series 和 DataFrame 都有一个 shift 方法用于执行单纯的前移或后移操作, 保持索引不变</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.shift(-<span class="number">1</span>), ts / ts.shift(<span class="number">1</span>) -<span class="number">1</span> <span class="comment">#计算随时间的变化</span></span><br></pre></td></tr></table></figure><pre><code>(2000-01-01    2.0
 2000-01-02    3.0
 2000-01-03    4.0
 2000-01-04    NaN
 Freq: D, dtype: float64,
 2000-01-01         NaN
 2000-01-02    1.000000
 2000-01-03    0.500000
 2000-01-04    0.333333
 Freq: D, dtype: float64)</code></pre><p><strong><em>ts.shift(-1) vs ts.shfit(-1, freq='D')</em></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.shift(-<span class="number">1</span>, freq=<span class="string">'D'</span>) <span class="comment"># 时间序列向后平移3个 'D'</span></span><br></pre></td></tr></table></figure><pre><code>1999-12-31    1
2000-01-01    2
2000-01-02    3
2000-01-03    4
Freq: D, dtype: int32</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.shift(<span class="number">1</span>, freq=<span class="string">'3D'</span>) <span class="comment"># 时间序列向后平移3个 'D'</span></span><br></pre></td></tr></table></figure><pre><code>2000-01-04    1
2000-01-05    2
2000-01-06    3
2000-01-07    4
Freq: D, dtype: int32</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.shift(<span class="number">1</span>, freq=<span class="string">'90T'</span>) <span class="comment"># 时间序列向后平移90个 'min'</span></span><br></pre></td></tr></table></figure><pre><code>2000-01-01 01:30:00    1
2000-01-02 01:30:00    2
2000-01-03 01:30:00    3
2000-01-04 01:30:00    4
Freq: D, dtype: int32</code></pre><h3 id="hour-minute-day-monthend--通过偏移量对日期进行平移"><strong><em>Hour(), Minute(), Day(), MonthEnd()</em></strong> : 通过偏移量对日期进行平移</h3><blockquote><p><strong><em>Hour(), Minute(), Day(), MonthEnd(), ...</em></strong> : 日期偏移量（ date offset ）对象</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas.tseries.offsets <span class="keyword">import</span> Day, MonthEnd</span><br><span class="line">now = datetime.now()</span><br><span class="line">now</span><br></pre></td></tr></table></figure><pre><code>datetime.datetime(2021, 10, 9, 21, 38, 3, 837907)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">now + <span class="number">3</span> * Day(), now + Day(<span class="number">3</span>)</span><br></pre></td></tr></table></figure><pre><code>(Timestamp('2021-10-12 21:38:03.837907'),
 Timestamp('2021-10-12 21:38:03.837907'))</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">now + <span class="number">1</span> * MonthEnd()</span><br></pre></td></tr></table></figure><pre><code>Timestamp('2021-10-31 21:38:03.837907')</code></pre><h4 id="offsetrollforward-datetime--offsetrollback-datetime---控制将日期向前或向后滚动"><strong><em>offset.rollforward( datetime ), offset.rollback( datetime )</em></strong> : 控制将日期向前或向后“滚动”</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">offset = MonthEnd()</span><br><span class="line">offset.rollforward(now), offset.rollback(now)</span><br></pre></td></tr></table></figure><pre><code>(Timestamp('2021-10-31 21:38:03.837907'),
 Timestamp('2021-09-30 21:38:03.837907'))</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ts = pd.Series(np.ones(<span class="number">20</span>), index=pd.date_range(<span class="string">'1/15/2000'</span>, periods=<span class="number">20</span>, freq=<span class="string">'4d'</span>))</span><br><span class="line">ts</span><br></pre></td></tr></table></figure><pre><code>2000-01-15    1.0
2000-01-19    1.0
2000-01-23    1.0
2000-01-27    1.0
2000-01-31    1.0
2000-02-04    1.0
2000-02-08    1.0
2000-02-12    1.0
2000-02-16    1.0
2000-02-20    1.0
2000-02-24    1.0
2000-02-28    1.0
2000-03-03    1.0
2000-03-07    1.0
2000-03-11    1.0
2000-03-15    1.0
2000-03-19    1.0
2000-03-23    1.0
2000-03-27    1.0
2000-03-31    1.0
Freq: 4D, dtype: float64</code></pre><p><strong><em>ts.groupby( offset.rollforward )</em></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">offset = MonthEnd()</span><br><span class="line">ts.groupby(MonthEnd().rollforward).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure><pre><code>2000-01-31    5.0
2000-02-29    7.0
2000-03-31    8.0
dtype: float64</code></pre><p><strong><em>ts.resample( freq )</em></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.resample(<span class="string">'M'</span>).mean()</span><br></pre></td></tr></table></figure><pre><code>2000-01-31    1.0
2000-02-29    1.0
2000-03-31    1.0
Freq: M, dtype: float64</code></pre><h2 id="时期-period-及其计算">时期 (period) 及其计算</h2><h3 id="pdperiod-value-freq---时期的创建"><strong><em>pd.Period( value, freq )</em></strong> : 时期的创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="number">2021</span>, freq=<span class="string">'A-MAY'</span>)</span><br><span class="line">p</span><br></pre></td></tr></table></figure><pre><code>Period('2021', 'A-MAY')</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p + <span class="number">3</span></span><br></pre></td></tr></table></figure><pre><code>Period('2024', 'A-MAY')</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p - pd.Period(<span class="number">2019</span>, freq=<span class="string">'A-MAY'</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;2 * YearEnds: month=5&gt;</code></pre><h3 id="pdperiod_range-start-end-freq---时期范围的创建"><strong><em>pd.period_range( start, end, freq )</em></strong> : 时期范围的创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.period_range(<span class="string">'2000-01-01'</span>, <span class="string">'2000-06-30'</span>, freq=<span class="string">'M'</span>)</span><br><span class="line">rng</span><br></pre></td></tr></table></figure><pre><code>PeriodIndex(['2000-01', '2000-02', '2000-03', '2000-04', '2000-05', '2000-06'], dtype='period[M]')</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(np.arange(<span class="number">6</span>), index=rng)</span><br></pre></td></tr></table></figure><pre><code>2000-01    0
2000-02    1
2000-03    2
2000-04    3
2000-05    4
2000-06    5
Freq: M, dtype: int32</code></pre><h3 id="pdperiodindex-values-freq-year-quarter---季度时期范围的创建"><strong><em>pd.PeriodIndex( values, freq, year, quarter )</em></strong> : 季度时期范围的创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">values = [<span class="string">'2001Q3'</span>, <span class="string">'2002Q2'</span>, <span class="string">'2003Q1'</span>]</span><br><span class="line">pd.PeriodIndex(values, freq=<span class="string">'Q-DEC'</span>)</span><br></pre></td></tr></table></figure><pre><code>PeriodIndex(['2001Q3', '2002Q2', '2003Q1'], dtype='period[Q-DEC]')</code></pre><p>通过数组创建 PeriodIndex</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/macrodata.csv'</span>)</span><br><span class="line">data.year, data.quarter</span><br></pre></td></tr></table></figure><pre><code>(0      1959.0
 1      1959.0
 2      1959.0
 3      1959.0
 4      1960.0
         ...  
 198    2008.0
 199    2008.0
 200    2009.0
 201    2009.0
 202    2009.0
 Name: year, Length: 203, dtype: float64,
 0      1.0
 1      2.0
 2      3.0
 3      4.0
 4      1.0
       ... 
 198    3.0
 199    4.0
 200    1.0
 201    2.0
 202    3.0
 Name: quarter, Length: 203, dtype: float64)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index = pd.PeriodIndex(year=data.year, quarter=data.quarter,</span><br><span class="line">                       freq=<span class="string">'Q-DEC'</span>)</span><br><span class="line">index</span><br></pre></td></tr></table></figure><pre><code>PeriodIndex(['1959Q1', '1959Q2', '1959Q3', '1959Q4', '1960Q1', '1960Q2',
             '1960Q3', '1960Q4', '1961Q1', '1961Q2',
             ...
             '2007Q2', '2007Q3', '2007Q4', '2008Q1', '2008Q2', '2008Q3',
             '2008Q4', '2009Q1', '2009Q2', '2009Q3'],
            dtype='period[Q-DEC]', length=203)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.index = index</span><br><span class="line">data</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>year</th><th>quarter</th><th>realgdp</th><th>realcons</th><th>realinv</th><th>realgovt</th><th>realdpi</th><th>cpi</th><th>m1</th><th>tbilrate</th><th>unemp</th><th>pop</th><th>infl</th><th>realint</th></tr></thead><tbody><tr><th>1959Q1</th><td>1959.0</td><td>1.0</td><td>2710.349</td><td>1707.4</td><td>286.898</td><td>470.045</td><td>1886.9</td><td>28.980</td><td>139.7</td><td>2.82</td><td>5.8</td><td>177.146</td><td>0.00</td><td>0.00</td></tr><tr><th>1959Q2</th><td>1959.0</td><td>2.0</td><td>2778.801</td><td>1733.7</td><td>310.859</td><td>481.301</td><td>1919.7</td><td>29.150</td><td>141.7</td><td>3.08</td><td>5.1</td><td>177.830</td><td>2.34</td><td>0.74</td></tr><tr><th>1959Q3</th><td>1959.0</td><td>3.0</td><td>2775.488</td><td>1751.8</td><td>289.226</td><td>491.260</td><td>1916.4</td><td>29.350</td><td>140.5</td><td>3.82</td><td>5.3</td><td>178.657</td><td>2.74</td><td>1.09</td></tr><tr><th>1959Q4</th><td>1959.0</td><td>4.0</td><td>2785.204</td><td>1753.7</td><td>299.356</td><td>484.052</td><td>1931.3</td><td>29.370</td><td>140.0</td><td>4.33</td><td>5.6</td><td>179.386</td><td>0.27</td><td>4.06</td></tr><tr><th>1960Q1</th><td>1960.0</td><td>1.0</td><td>2847.699</td><td>1770.5</td><td>331.722</td><td>462.199</td><td>1955.5</td><td>29.540</td><td>139.6</td><td>3.50</td><td>5.2</td><td>180.007</td><td>2.31</td><td>1.19</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>2008Q3</th><td>2008.0</td><td>3.0</td><td>13324.600</td><td>9267.7</td><td>1990.693</td><td>991.551</td><td>9838.3</td><td>216.889</td><td>1474.7</td><td>1.17</td><td>6.0</td><td>305.270</td><td>-3.16</td><td>4.33</td></tr><tr><th>2008Q4</th><td>2008.0</td><td>4.0</td><td>13141.920</td><td>9195.3</td><td>1857.661</td><td>1007.273</td><td>9920.4</td><td>212.174</td><td>1576.5</td><td>0.12</td><td>6.9</td><td>305.952</td><td>-8.79</td><td>8.91</td></tr><tr><th>2009Q1</th><td>2009.0</td><td>1.0</td><td>12925.410</td><td>9209.2</td><td>1558.494</td><td>996.287</td><td>9926.4</td><td>212.671</td><td>1592.8</td><td>0.22</td><td>8.1</td><td>306.547</td><td>0.94</td><td>-0.71</td></tr><tr><th>2009Q2</th><td>2009.0</td><td>2.0</td><td>12901.504</td><td>9189.0</td><td>1456.678</td><td>1023.528</td><td>10077.5</td><td>214.469</td><td>1653.6</td><td>0.18</td><td>9.2</td><td>307.226</td><td>3.37</td><td>-3.19</td></tr><tr><th>2009Q3</th><td>2009.0</td><td>3.0</td><td>12990.341</td><td>9256.0</td><td>1486.398</td><td>1044.088</td><td>10040.6</td><td>216.385</td><td>1673.9</td><td>0.12</td><td>9.6</td><td>308.013</td><td>3.56</td><td>-3.44</td></tr></tbody></table><p>203 rows × 14 columns</p></div><h3 id="periodasfreq-freq-how---时期的频率转换"><strong><em>period.asfreq( freq, how )</em></strong> : 时期的频率转换</h3><h4 id="年--月">年 → 月</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="string">'2021'</span>, freq=<span class="string">'A-MAY'</span>)</span><br><span class="line">p, p.asfreq(<span class="string">'M'</span>, how=<span class="string">'start'</span>), p.asfreq(<span class="string">'M'</span>, how=<span class="string">'end'</span>)  <span class="comment"># 2020.6 开始  # 2021.5 结束</span></span><br></pre></td></tr></table></figure><p>(Period('2021', 'A-MAY'), Period('2020-06', 'M'), Period('2021-05', 'M'))</p><h4 id="月--年">月 → 年</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="string">'May-2021'</span>, <span class="string">'M'</span>)</span><br><span class="line">p, p.asfreq(<span class="string">'A-DEC'</span>)</span><br></pre></td></tr></table></figure><p>(Period('2021-05', 'M'), Period('2021', 'A-DEC'))</p><h4 id="年--日">年 → 日</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.period_range(<span class="string">'2006'</span>, <span class="string">'2009'</span>, freq=<span class="string">'A-DEC'</span>)</span><br><span class="line">ts = pd.Series(np.random.randn(<span class="built_in">len</span>(rng)), index=rng)</span><br><span class="line">ts, ts.asfreq(<span class="string">'M'</span>, how=<span class="string">'start'</span>),  ts.asfreq(<span class="string">'D'</span>, how=<span class="string">'start'</span>)</span><br></pre></td></tr></table></figure><p>(2006 -0.954789<br>2007 2.045184<br>2008 -0.367045<br>2009 -0.672529<br>Freq: A-DEC, dtype: float64,<br>2006-01 -0.954789<br>2007-01 2.045184<br>2008-01 -0.367045<br>2009-01 -0.672529<br>Freq: M, dtype: float64,<br>2006-01-01 -0.954789<br>2007-01-01 2.045184<br>2008-01-01 -0.367045<br>2009-01-01 -0.672529<br>Freq: D, dtype: float64)</p><h4 id="按季度计算的时期">按季度计算的时期</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="string">'2021Q1'</span>, freq=<span class="string">'Q-DEC'</span>) <span class="comment"># 季度以DEC为一年的分界, 2021第一季度为2021.1-2021.3</span></span><br><span class="line">p, p.asfreq(<span class="string">'D'</span>, <span class="string">'start'</span>), p.asfreq(<span class="string">'D'</span>, <span class="string">'end'</span>)</span><br></pre></td></tr></table></figure><p>(Period('2021Q1', 'Q-DEC'),<br>Period('2021-01-01', 'D'),<br>Period('2021-03-31', 'D'))</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="string">'2021Q1'</span>, freq=<span class="string">'Q-JUN'</span>) <span class="comment"># 季度以JUN为一年的分界, 2021第一季度为2020.7-2020.9</span></span><br><span class="line">p, p.asfreq(<span class="string">'D'</span>, <span class="string">'start'</span>), p.asfreq(<span class="string">'D'</span>, <span class="string">'end'</span>)</span><br></pre></td></tr></table></figure><p>(Period('2021Q1', 'Q-JUN'),<br>Period('2020-07-01', 'D'),<br>Period('2020-09-30', 'D'))</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="string">'2021Q4'</span>, freq=<span class="string">'Q-JUN'</span>) <span class="comment"># 季度以JUN为一年的分界, 2021第四季度为2021.4-2021.6</span></span><br><span class="line">p, p.asfreq(<span class="string">'D'</span>, <span class="string">'start'</span>), p.asfreq(<span class="string">'D'</span>, <span class="string">'end'</span>)</span><br></pre></td></tr></table></figure><p>(Period('2021Q4', 'Q-JUN'),<br>Period('2021-04-01', 'D'),<br>Period('2021-06-30', 'D'))</p><p>获取该季度倒数第二个工作日下午4点的时间戳 :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas.tseries.offsets <span class="keyword">import</span> Hour</span><br><span class="line">p4pm = (p.asfreq(<span class="string">'B'</span>, <span class="string">'end'</span>) - <span class="number">1</span>).asfreq(<span class="string">'T'</span>, <span class="string">'start'</span>) + Hour(<span class="number">16</span>)</span><br><span class="line">p4pm, p4pm.to_timestamp()</span><br></pre></td></tr></table></figure><p>(Period('2021-06-29 16:00', 'T'), Timestamp('2021-06-29 16:00:00'))</p><p>季度型范围的算术运算</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.period_range(<span class="string">'2019Q3'</span>, <span class="string">'2021Q4'</span>, freq=<span class="string">'Q-DEC'</span>)</span><br><span class="line">ts = pd.Series(np.arange(<span class="built_in">len</span>(rng)), index=rng)</span><br><span class="line">ts</span><br></pre></td></tr></table></figure><p>2019Q3 0<br>2019Q4 1<br>2020Q1 2<br>2020Q2 3<br>2020Q3 4<br>2020Q4 5<br>2021Q1 6<br>2021Q2 7<br>2021Q3 8<br>2021Q4 9<br>Freq: Q-DEC, dtype: int32</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">new_rng = rng.asfreq(<span class="string">'D'</span>, <span class="string">'end'</span>).asfreq(<span class="string">'T'</span>, <span class="string">'start'</span>) + <span class="number">16</span> * <span class="number">60</span></span><br><span class="line">ts.index = new_rng.to_timestamp()</span><br><span class="line">ts</span><br></pre></td></tr></table></figure><p>2019-09-30 16:00:00 0<br>2019-12-31 16:00:00 1<br>2020-03-31 16:00:00 2<br>2020-06-30 16:00:00 3<br>2020-09-30 16:00:00 4<br>2020-12-31 16:00:00 5<br>2021-03-31 16:00:00 6<br>2021-06-30 16:00:00 7<br>2021-09-30 16:00:00 8<br>2021-12-31 16:00:00 9<br>Freq: Q-DEC, dtype: int32</p><h3 id="tsto_period-freq-copy---时间戳--时期"><strong><em>ts.to_period( freq, copy )</em></strong> : 时间戳 → 时期</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.date_range(<span class="string">'2021-01-01'</span>, periods=<span class="number">3</span>, freq=<span class="string">'M'</span>)</span><br><span class="line">ts = pd.Series(np.random.randn(<span class="number">3</span>), index=rng)</span><br><span class="line">ts, ts.to_period()</span><br></pre></td></tr></table></figure><p>(2021-01-31 0.799601<br>2021-02-28 -0.747543<br>2021-03-31 -0.333042<br>Freq: M, dtype: float64,<br>2021-01 0.799601<br>2021-02 -0.747543<br>2021-03 -0.333042<br>Freq: M, dtype: float64)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.date_range(<span class="string">'1/29/2021'</span>, periods=<span class="number">6</span>, freq=<span class="string">'D'</span>)</span><br><span class="line">ts2 = pd.Series(np.random.randn(<span class="number">6</span>), index=rng)</span><br><span class="line">ts2, ts2.to_period(<span class="string">'M'</span>)</span><br></pre></td></tr></table></figure><p>(2021-01-29 -0.917420<br>2021-01-30 -1.667312<br>2021-01-31 0.370422<br>2021-02-01 -1.841920<br>2021-02-02 0.067595<br>2021-02-03 0.539212<br>Freq: D, dtype: float64,<br>2021-01 -0.917420<br>2021-01 -1.667312<br>2021-01 0.370422<br>2021-02 -1.841920<br>2021-02 0.067595<br>2021-02 0.539212<br>Freq: M, dtype: float64)</p><h3 id="tsto_timestamp-freq-how-copy---时期--时间戳"><strong><em>ts.to_timestamp( freq, how, copy )</em></strong> : 时期 → 时间戳</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.period_range(<span class="string">'1/29/2021'</span>, periods=<span class="number">2</span>, freq=<span class="string">'M'</span>)</span><br><span class="line">ts3 = pd.Series(np.random.randn(<span class="number">2</span>), index=rng)</span><br><span class="line">ts3, ts3.to_timestamp()</span><br></pre></td></tr></table></figure><p>(2021-01 -2.029517<br>2021-02 -0.154121<br>Freq: M, dtype: float64,<br>2021-01-01 -2.029517<br>2021-02-01 -0.154121<br>dtype: float64)</p><h2 id="重采样和频率转换">重采样和频率转换</h2><h3 id="tsresample-freq-axis-closed-label-kind-fill_method-limit-convention-"><strong><em>ts.resample( freq, axis, closed, label, kind, fill_method, limit, convention )</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.date_range(<span class="string">'2000-01-01'</span>, periods=<span class="number">100</span>, freq=<span class="string">'D'</span>)</span><br><span class="line">ts = pd.Series(np.ones(<span class="built_in">len</span>(rng)), index=rng)</span><br><span class="line">ts</span><br></pre></td></tr></table></figure><p>2000-01-01 1.0<br>2000-01-02 1.0<br>2000-01-03 1.0<br>2000-01-04 1.0<br>2000-01-05 1.0<br>...<br>2000-04-05 1.0<br>2000-04-06 1.0<br>2000-04-07 1.0<br>2000-04-08 1.0<br>2000-04-09 1.0<br>Freq: D, Length: 100, dtype: float64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.resample(<span class="string">'M'</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure><p>2000-01-31 31.0<br>2000-02-29 29.0<br>2000-03-31 31.0<br>2000-04-30 9.0<br>Freq: M, dtype: float64</p><p><strong><em>kind</em></strong> : 聚合到周期 ( 'period' ) 或 时间戳 ( 'timestamp' )</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts.resample(<span class="string">'M'</span>, kind=<span class="string">'period'</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure><p>2000-01 31.0<br>2000-02 29.0<br>2000-03 31.0<br>2000-04 9.0<br>Freq: M, dtype: float64</p><p><strong><em>closed</em></strong> : 降采样中, 设置时间闭合的一端, 'right' (start, end] 或 'left' [start, end)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng2 = pd.date_range(<span class="string">'2000-01-01'</span>, periods=<span class="number">7</span>, freq=<span class="string">'T'</span>)</span><br><span class="line">ts2 = pd.Series(np.arange(<span class="number">7</span>), index=rng2)</span><br><span class="line">ts2</span><br></pre></td></tr></table></figure><p>2000-01-01 00:00:00 0<br>2000-01-01 00:01:00 1<br>2000-01-01 00:02:00 2<br>2000-01-01 00:03:00 3<br>2000-01-01 00:04:00 4<br>2000-01-01 00:05:00 5<br>2000-01-01 00:06:00 6<br>Freq: T, dtype: int32</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts2.resample(<span class="string">'5T'</span>, closed=<span class="string">'right'</span>).<span class="built_in">sum</span>() <span class="comment"># ( , ]</span></span><br></pre></td></tr></table></figure><p>1999-12-31 23:55:00 0<br>2000-01-01 00:00:00 15<br>2000-01-01 00:05:00 6<br>Freq: 5T, dtype: int32</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts2.resample(<span class="string">'5T'</span>, closed=<span class="string">'left'</span>).<span class="built_in">sum</span>() <span class="comment"># [ , )</span></span><br></pre></td></tr></table></figure><p>2000-01-01 00:00:00 10<br>2000-01-01 00:05:00 11<br>Freq: 5T, dtype: int32</p><p><strong><em>label</em></strong> : 降采样中, 设置聚合值的标签, 'right' 或 'left'</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts2.resample(<span class="string">'5T'</span>, closed=<span class="string">'right'</span>, label=<span class="string">'right'</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure><p>2000-01-01 00:00:00 0<br>2000-01-01 00:05:00 15<br>2000-01-01 00:10:00 6<br>Freq: 5T, dtype: int32</p><p><strong><em>convention</em></strong> : 升采样中, 设置低频周期对应的高频时间戳, 'start' 或 'end'</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.random.randn(<span class="number">2</span>, <span class="number">4</span>),</span><br><span class="line">                     index=pd.date_range(<span class="string">'1/1/2000'</span>, periods=<span class="number">2</span>,</span><br><span class="line">                                         freq=<span class="string">'M'</span>),</span><br><span class="line">                     columns=[<span class="string">'Colorado'</span>, <span class="string">'Texas'</span>, <span class="string">'New York'</span>, <span class="string">'Ohio'</span>])</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Colorado</th><th>Texas</th><th>New York</th><th>Ohio</th></tr></thead><tbody><tr><th>2000-01-31</th><td>1.025930</td><td>-0.974227</td><td>0.842722</td><td>1.017311</td></tr><tr><th>2000-02-29</th><td>1.171868</td><td>-1.525096</td><td>-0.159692</td><td>0.148648</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_month = frame.resample(<span class="string">'M'</span>, kind=<span class="string">'period'</span>).<span class="built_in">sum</span>()</span><br><span class="line">df_month</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Colorado</th><th>Texas</th><th>New York</th><th>Ohio</th></tr></thead><tbody><tr><th>2000-01</th><td>1.025930</td><td>-0.974227</td><td>0.842722</td><td>1.017311</td></tr><tr><th>2000-02</th><td>1.171868</td><td>-1.525096</td><td>-0.159692</td><td>0.148648</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_daily = df_month.resample(<span class="string">'D'</span>, convention=<span class="string">'start'</span>).asfreq()</span><br><span class="line">df_daily.head()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Colorado</th><th>Texas</th><th>New York</th><th>Ohio</th></tr></thead><tbody><tr><th>2000-01-01</th><td>1.02593</td><td>-0.974227</td><td>0.842722</td><td>1.017311</td></tr><tr><th>2000-01-02</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>2000-01-03</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>2000-01-04</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>2000-01-05</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr></tbody></table></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/08-pandas_and_seaborn/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/08-pandas_and_seaborn/" class="post-title-link" itemprop="url">数据分析-08-Pandas and Seaborn</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:50:07 / 修改时间：10:35:31" itemprop="dateCreated datePublished" datetime="2022-07-31T16:50:07Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure><h3 id="objplot-use_index-xlim-xticks-xlabel-rot-logy-figsize-label-legend-title-kind-style-alpha-grid-ax-"><strong><em>obj.plot( use_index, xlim, xticks, xlabel, rot, logy, figsize, label, legend, title, kind, style, alpha, grid, ax )</em></strong></h3><blockquote><p><strong><em>use_index</em></strong> : 是否将对象索引用作刻度标签<br><strong><em>xlim</em></strong> : x轴界限, <strong><em>xticks</em></strong> : x轴刻度值, <strong><em>xlabel</em></strong> : x轴名称<br><strong><em>logy</em></strong> : 是否在y轴使用对数标尺（ <em>log(p) → h</em> ）<br><strong><em>label, legend</em></strong> : 图例<br><strong><em>kind</em></strong> : 控制画图种类, 如: <em>'line', 'bar', 'barh', 'kde'</em><br><strong><em>style</em></strong> : 控制画图属性, 如: <em>'ko--'</em><br><strong><em>grid</em></strong> : 是否显示网格线<br><strong><em>ax</em></strong> : 指定要在其上进行绘制的 <strong><em>subplot</em></strong> 对象</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig, axes = plt.subplots(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">s = pd.Series(np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]))</span><br><span class="line">s.plot(kind=<span class="string">'bar'</span>, grid=<span class="literal">True</span>, rot=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;AxesSubplot:&gt;</code></pre><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_4_1.png" alt="png"></p><h3 id="frameplot---subplots-sharex-sharey-sortcolumns-"><strong><em>frame.plot( ... ..., subplots, sharex, sharey, sortcolumns )</em></strong></h3><blockquote><p><strong><em>subplots</em></strong> : 是否将 frame 各列单独绘制<br><strong><em>sharex</em></strong> : <em>subplots=True</em> : 是否共用一个 x 轴, <strong><em>sharey</em></strong> : <em>subplots=True</em> : 是否共用一个 y 轴<br><strong><em>sort_columns</em></strong> : 是否以字母表顺序绘制各列</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">10</span>, <span class="number">4</span>).cumsum(<span class="number">0</span>),</span><br><span class="line">                  columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>],</span><br><span class="line">                  index=np.arange(<span class="number">0</span>, <span class="number">100</span>, <span class="number">10</span>))</span><br><span class="line">df.plot()</span><br></pre></td></tr></table></figure><pre><code>&lt;AxesSubplot:&gt;</code></pre><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_6_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.plot(subplots=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><pre><code>array([&lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;],
      dtype=object)</code></pre><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_7_1.png" alt="png"></p><h3 id="frameplotline-----折线图"><strong><em>frame.plot.line( ... ... )</em></strong> : 折线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">fig.subplots_adjust()</span><br><span class="line">data = pd.DataFrame(np.random.rand(<span class="number">6</span>, <span class="number">4</span>), </span><br><span class="line">                    index=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'five'</span>, <span class="string">'six'</span>],</span><br><span class="line">                    columns=pd.Index([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>], </span><br><span class="line">                    name=<span class="string">'Genus'</span>))</span><br><span class="line">data.plot.bar(ax=axes[<span class="number">0</span>])</span><br><span class="line">data.plot.line(ax=axes[<span class="number">1</span>])</span><br></pre></td></tr></table></figure><pre><code>&lt;AxesSubplot:&gt;</code></pre><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_9_1.png" alt="png"></p><h3 id="frameplotbar-stacked---frameplotbarh-stacked----条形图"><strong><em>frame.plot.bar( stacked, ... ), frame.plot.barh( stacked, ... )</em></strong> : 条形图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = pd.DataFrame(np.arange(<span class="number">1</span>,<span class="number">25</span>).reshape(<span class="number">4</span>, <span class="number">6</span>).T, </span><br><span class="line">                    index=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'five'</span>, <span class="string">'six'</span>],</span><br><span class="line">                    columns=pd.Index([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>], </span><br><span class="line">                    name=<span class="string">'Genus'</span>))</span><br><span class="line">data</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th>Genus</th><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><th>one</th><td>1</td><td>7</td><td>13</td><td>19</td></tr><tr><th>two</th><td>2</td><td>8</td><td>14</td><td>20</td></tr><tr><th>three</th><td>3</td><td>9</td><td>15</td><td>21</td></tr><tr><th>four</th><td>4</td><td>10</td><td>16</td><td>22</td></tr><tr><th>five</th><td>5</td><td>11</td><td>17</td><td>23</td></tr><tr><th>six</th><td>6</td><td>12</td><td>18</td><td>24</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.plot.bar()</span><br><span class="line">data.plot.barh(stacked=<span class="literal">True</span>) <span class="comment">#叠加</span></span><br></pre></td></tr></table></figure><p>&lt;AxesSubplot:&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_12_1.png" alt="png"></p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_12_2.png" alt="png"></p><h3 id="snsbarplot-data-x-y-hue-orient---平均值及置信度"><strong><em>sns.barplot( data, x, y, hue, orient )</em></strong> : 平均值及置信度</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tips = pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/tips.csv'</span>)</span><br><span class="line">tips.head()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>total_bill</th><th>tip</th><th>smoker</th><th>day</th><th>time</th><th>size</th></tr></thead><tbody><tr><th>0</th><td>16.99</td><td>1.01</td><td>No</td><td>Sun</td><td>Dinner</td><td>2</td></tr><tr><th>1</th><td>10.34</td><td>1.66</td><td>No</td><td>Sun</td><td>Dinner</td><td>3</td></tr><tr><th>2</th><td>21.01</td><td>3.50</td><td>No</td><td>Sun</td><td>Dinner</td><td>3</td></tr><tr><th>3</th><td>23.68</td><td>3.31</td><td>No</td><td>Sun</td><td>Dinner</td><td>2</td></tr><tr><th>4</th><td>24.59</td><td>3.61</td><td>No</td><td>Sun</td><td>Dinner</td><td>4</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tips[<span class="string">'tip/total_bill'</span>] = tips[<span class="string">'tip'</span>] / tips[<span class="string">'total_bill'</span>]</span><br><span class="line">sns.barplot(data=tips, x=<span class="string">'tip/total_bill'</span>, y=<span class="string">'day'</span>, orient=<span class="string">'h'</span>)</span><br></pre></td></tr></table></figure><p>&lt;AxesSubplot:xlabel='tip/total_bill', ylabel='day'&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_15_1.png" alt="png"></p><h3 id="frameplothist-bins---frameplotdensity----直方图和密度图"><strong><em>frame.plot.hist( bins, ... ), frame.plot.density( ... )</em></strong> : 直方图和密度图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tips = pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/tips.csv'</span>)</span><br><span class="line">tips[<span class="string">'tip/total_bill'</span>] = tips[<span class="string">'tip'</span>] / tips[<span class="string">'total_bill'</span>]</span><br><span class="line">tips.head()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>total_bill</th><th>tip</th><th>smoker</th><th>day</th><th>time</th><th>size</th><th>tip/total_bill</th></tr></thead><tbody><tr><th>0</th><td>16.99</td><td>1.01</td><td>No</td><td>Sun</td><td>Dinner</td><td>2</td><td>0.059447</td></tr><tr><th>1</th><td>10.34</td><td>1.66</td><td>No</td><td>Sun</td><td>Dinner</td><td>3</td><td>0.160542</td></tr><tr><th>2</th><td>21.01</td><td>3.50</td><td>No</td><td>Sun</td><td>Dinner</td><td>3</td><td>0.166587</td></tr><tr><th>3</th><td>23.68</td><td>3.31</td><td>No</td><td>Sun</td><td>Dinner</td><td>2</td><td>0.139780</td></tr><tr><th>4</th><td>24.59</td><td>3.61</td><td>No</td><td>Sun</td><td>Dinner</td><td>4</td><td>0.146808</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tips[<span class="string">'tip/total_bill'</span>].plot.hist(bins=<span class="number">50</span>)</span><br></pre></td></tr></table></figure><p>&lt;AxesSubplot:ylabel='Frequency'&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_18_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tips[<span class="string">'tip/total_bill'</span>].plot.density()</span><br></pre></td></tr></table></figure><p>&lt;AxesSubplot:ylabel='Density'&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_19_1.png" alt="png"></p><h3 id="snsregplot-data-x-y-hue---散点图"><strong><em>sns.regplot( data, x, y, hue )</em></strong> : 散点图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">macro = pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/macrodata.csv'</span>)</span><br><span class="line">data = macro[[<span class="string">'cpi'</span>, <span class="string">'m1'</span>, <span class="string">'tbilrate'</span>, <span class="string">'unemp'</span>]]</span><br><span class="line">trans_data = np.log(data).diff().dropna()</span><br><span class="line">trans_data.head()</span><br><span class="line">sns.regplot(x = <span class="string">'m1'</span>, y = <span class="string">'unemp'</span>, data=trans_data)</span><br></pre></td></tr></table></figure><p>&lt;AxesSubplot:xlabel='m1', ylabel='unemp'&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_21_1.png" alt="png"></p><h3 id="snspairplot-data-diag_kind-plot_kws---散步图矩阵"><strong><em>sns.pairplot( data, diag_kind, plot_kws )</em></strong> : 散步图矩阵</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(trans_data, diag_kind=<span class="string">'kde'</span>)</span><br></pre></td></tr></table></figure><p>&lt;seaborn.axisgrid.PairGrid at 0x2244980c220&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_23_1.png" alt="png"></p><h3 id="snscatplot-data-x-y-hue-row-col-kind---分面网格"><strong><em>sns.catplot( data, x, y, hue, row, col, kind )</em></strong> : 分面网格</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tips = pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/tips.csv'</span>)</span><br><span class="line">tips[<span class="string">'tip_pct'</span>] = tips[<span class="string">'tip'</span>] / tips[<span class="string">'total_bill'</span>]</span><br><span class="line">sns.catplot(x=<span class="string">'day'</span>, y=<span class="string">'tip_pct'</span>, hue=<span class="string">'time'</span>, col=<span class="string">'smoker'</span>,</span><br><span class="line">               kind=<span class="string">'bar'</span>, data=tips)</span><br></pre></td></tr></table></figure><p>&lt;seaborn.axisgrid.FacetGrid at 0x224497158b0&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_25_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">'day'</span>, y=<span class="string">'tip_pct'</span>, row=<span class="string">'time'</span>,</span><br><span class="line">               col=<span class="string">'smoker'</span>,</span><br><span class="line">               kind=<span class="string">'bar'</span>, data=tips)</span><br></pre></td></tr></table></figure><p>&lt;seaborn.axisgrid.FacetGrid at 0x2244a232370&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_26_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">'tip_pct'</span>, y=<span class="string">'day'</span>, kind=<span class="string">'bar'</span>,</span><br><span class="line">               data=tips[tips.tip_pct &lt; <span class="number">0.5</span>])</span><br></pre></td></tr></table></figure><p>&lt;seaborn.axisgrid.FacetGrid at 0x2244a653100&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_27_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">'tip_pct'</span>, y=<span class="string">'day'</span>, kind=<span class="string">'box'</span>,</span><br><span class="line">               data=tips[tips.tip_pct &lt; <span class="number">0.5</span>])</span><br></pre></td></tr></table></figure><p>&lt;seaborn.axisgrid.FacetGrid at 0x2244a830af0&gt;</p><p><img src="/2022/cdo/08-pandas_and_seaborn/08-pandas_and_seaborn_28_1.png" alt="png"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/07-matplotlib/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/07-matplotlib/" class="post-title-link" itemprop="url">数据分析-07-Matplotlib</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:49:44 / 修改时间：10:35:08" itemprop="dateCreated datePublished" datetime="2022-07-31T16:49:44Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure><h3 id="pltplot-data-color-linestyle-marker-label-drawstyle-"><strong><em>plt.plot( data, color, linestyle, marker, label, drawstyle )</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = np.arange(<span class="number">10</span>)</span><br><span class="line">plt.plot(data)</span><br></pre></td></tr></table></figure><pre><code>[&lt;matplotlib.lines.Line2D at 0x11dba8e1e50&gt;]</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_4_1.png" alt="png"></p><h4 id="color-linestyle-marker-label--颜色-标记-线型-图例"><strong><em>color, linestyle, marker, label</em></strong> : 颜色, 标记, 线型, 图例</h4><p><strong><em>plt.subplots( nrows, ncols, sharex, sharey )</em></strong> : 调整图片大小</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randn(<span class="number">30</span>).cumsum()</span><br><span class="line">plt.plot(data, color=<span class="string">'b'</span>, linestyle=<span class="string">'--'</span>, marker=<span class="string">'o'</span>)</span><br><span class="line">plt.plot(-data, <span class="string">'ro--'</span>)</span><br><span class="line">plt.subplots_adjust(top=<span class="number">0.6</span>)</span><br></pre></td></tr></table></figure><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_7_0.png" alt="png"></p><h4 id="drawstyle"><strong><em>drawstyle</em></strong></h4><p><strong><em>plt.legend( loc )</em></strong> : 设置图例</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randn(<span class="number">30</span>).cumsum()</span><br><span class="line">plt.plot(data, <span class="string">'k--'</span>, label=<span class="string">'Default'</span>)</span><br><span class="line">plt.plot(data, <span class="string">'k-'</span>, drawstyle=<span class="string">'steps-post'</span>, label=<span class="string">'steps-post'</span>)</span><br><span class="line">plt.legend(loc=<span class="string">'best'</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.legend.Legend at 0x11dbb0d9850&gt;</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_10_1.png" alt="png"></p><h2 id="figure-和-subplot">Figure 和 Subplot</h2><h3 id="pltfigure-figsize---创建一个的-figure-对象-matplotlib-的图像都位于-figure-对象中"><strong><em>plt.figure( figsize )</em></strong> : 创建一个的 Figure 对象; matplotlib 的图像都位于 Figure 对象中</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure() <span class="comment">#创建一个的 Figure 对象</span></span><br></pre></td></tr></table></figure><pre><code>&lt;Figure size 432x288 with 0 Axes&gt;</code></pre><h3 id="figadd_subplot-nrows-ncols-index---创建一个的-axessubplot-对象-位于--nrows-ncols--的-index-位置"><strong><em>fig.add_subplot( nrows, ncols, index )</em></strong> : 创建一个的 AxesSubplot 对象, 位于 <em>[ nrows, ncols ]</em> 的 <em>index</em> 位置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure() <span class="comment">#创建一个的 Figure 对象</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">ax2 = fig.add_subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">ax4 = fig.add_subplot(<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">data = np.random.randn(<span class="number">100</span>)</span><br><span class="line">plt.plot(data.cumsum(), <span class="string">'k--'</span>)</span><br><span class="line">ax1.plot(data.cumsum())</span><br><span class="line">ax2.hist(data, bins=<span class="number">12</span>, color=<span class="string">'k'</span>, alpha=<span class="number">0.3</span>) <span class="comment"># 统计直方图</span></span><br><span class="line">ax3.scatter(np.arange(<span class="number">100</span>), data.cumsum()) <span class="comment"># 散点图</span></span><br><span class="line">plt.savefig(<span class="string">'normal.png'</span>, dpi=<span class="number">1080</span>, bbox_inches=<span class="string">'tight'</span>)</span><br></pre></td></tr></table></figure><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_15_0.png" alt="png"></p><h3 id="pltsubplots-nrows-ncols-sharex-sharey---创建-figure-对象和-一组-axessubplot-对象存放于-ndarray-中"><strong><em>plt.subplots( nrows, ncols, sharex, sharey )</em></strong> : 创建 Figure 对象和 一组 AxesSubplot 对象（存放于 ndarray 中）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">1</span>, sharex=<span class="string">'all'</span>, sharey=<span class="string">'all'</span>) <span class="comment"># 共享x轴, y轴</span></span><br><span class="line"><span class="comment"># fig : Figure 对象 ; axes : ndarray 对象, 用于索引 AxesSubplot</span></span><br><span class="line">plt.plot(data, <span class="string">'k--'</span>)</span><br><span class="line">axes[<span class="number">0</span>].plot(data) <span class="comment">#对图片进行索引</span></span><br></pre></td></tr></table></figure><pre><code>[&lt;matplotlib.lines.Line2D at 0x11dbb291610&gt;]</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_17_1.png" alt="png"></p><h3 id="pltsubplots_adjust-left-bottom-right-top-wspace-hspace---调整-subplot-大小和间距"><strong><em>plt.subplots_adjust( left, bottom, right, top, wspace, hspace )</em></strong> : 调整 subplot 大小和间距</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, sharex=<span class="literal">True</span>, sharey=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        axes[i, j].hist(np.random.randn(<span class="number">500</span>), bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.subplots_adjust(left=<span class="number">0</span>, bottom=<span class="number">0</span>, right=<span class="number">2</span>, top=<span class="number">1.2</span>, </span><br><span class="line">                    wspace=<span class="number">0</span>, hspace=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_19_0.png" alt="png"></p><h2 id="刻度-标签-和-图例">刻度, 标签 和 图例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randn(<span class="number">500</span>)</span><br><span class="line">_ = plt.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_21_0.png" alt="png"></p><h3 id="pltxlim--pltxlim--start-stop---控制绘图范围"><strong><em>plt.xlim( ), plt.xlim( [ start, stop] )</em></strong> : 控制绘图范围</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.xlim(), plt.xlim([-<span class="number">2</span>, <span class="number">2</span>])</span><br></pre></td></tr></table></figure><pre><code>((-3.411006317547548, 3.221768778645931), (-2.0, 2.0))</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_23_1.png" alt="png"></p><h3 id="axget_xlim--axset_xlim--start-stop---控制绘图范围"><strong><em>ax.get_xlim( ), ax.set_xlim( [ start, stop] )</em></strong> : 控制绘图范围</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">ax.get_xlim(), ax.set_xlim([-<span class="number">2</span>,<span class="number">2</span>])</span><br></pre></td></tr></table></figure><pre><code>((-3.411006317547548, 3.221768778645931), (-2.0, 2.0))</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_25_1.png" alt="png"></p><h3 id="pltxticks--pltxticks-ticks-labels---控制刻度位置和标签"><strong><em>plt.xticks( ), plt.xticks( ticks, labels )</em></strong> : 控制刻度位置和标签</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randn(<span class="number">500</span>)</span><br><span class="line">plt.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.xticks(ticks = [-<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>] )</span><br></pre></td></tr></table></figure><pre><code>([&lt;matplotlib.axis.XTick at 0x11dbb949430&gt;,
  &lt;matplotlib.axis.XTick at 0x11dbb949400&gt;,
  &lt;matplotlib.axis.XTick at 0x11dbb937f40&gt;],
 [Text(0, 0, ''), Text(0, 0, ''), Text(0, 0, '')])</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_27_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randn(<span class="number">500</span>)</span><br><span class="line">plt.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.xticks(ticks = [-<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>], labels=[<span class="string">'negative'</span>, <span class="string">'zero'</span>, <span class="string">'positive'</span>] )</span><br></pre></td></tr></table></figure><pre><code>([&lt;matplotlib.axis.XTick at 0x11dbba06310&gt;,
  &lt;matplotlib.axis.XTick at 0x11dbba062e0&gt;,
  &lt;matplotlib.axis.XTick at 0x11dbb8735e0&gt;],
 [Text(-2, 0, 'negative'), Text(0, 0, 'zero'), Text(2, 0, 'positive')])</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_28_1.png" alt="png"></p><h3 id="axget_xticks--axset_xticks-ticks---控制刻度位置"><strong><em>ax.get_xticks( ), ax.set_xticks( ticks )</em></strong> : 控制刻度位置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">ax.get_xticks(), ax.set_xticks([-<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>])</span><br></pre></td></tr></table></figure><pre><code>(array([-4., -3., -2., -1.,  0.,  1.,  2.,  3.,  4.]),
 [&lt;matplotlib.axis.XTick at 0x11dbbac5760&gt;,
  &lt;matplotlib.axis.XTick at 0x11dbbac5730&gt;,
  &lt;matplotlib.axis.XTick at 0x11dbbabe040&gt;])</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_30_1.png" alt="png"></p><h3 id="axget_xticklabels--axset_xticklabels-list---控制刻度标签"><strong><em>ax.get_xticklabels( ), ax.set_xticklabels( list )</em></strong> : 控制刻度标签</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">ax.set_xticks([-<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>])</span><br><span class="line">ax.set_xticklabels([<span class="string">'negative'</span>, <span class="string">'zero'</span>, <span class="string">'positive'</span>])</span><br></pre></td></tr></table></figure><pre><code>[Text(-2, 0, 'negative'), Text(0, 0, 'zero'), Text(2, 0, 'positive')]</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_32_1.png" alt="png"></p><h2 id="标题-和-轴标签">标题 和 轴标签</h2><h3 id="axset_xlabel-xlabel--axset_title-title-"><strong><em>ax.set_xlabel( xlabel ), ax.set_title( title )</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">'XLABEL'</span>), ax.set_title(<span class="string">'TITLE'</span>)</span><br></pre></td></tr></table></figure><pre><code>(Text(0.5, 0, 'XLABEL'), Text(0.5, 1.0, 'TITLE'))</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_35_1.png" alt="png"></p><h3 id="axset-kwargs-"><strong><em>ax.set( *</em>kwargs )</strong>*</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>)</span><br><span class="line">props = {</span><br><span class="line">    <span class="string">'title'</span>: <span class="string">'My first matplotlib plot'</span>,</span><br><span class="line">    <span class="string">'xlabel'</span>: <span class="string">'Stages'</span></span><br><span class="line">}</span><br><span class="line">ax.<span class="built_in">set</span>(**props)</span><br></pre></td></tr></table></figure><pre><code>[Text(0.5, 1.0, 'My first matplotlib plot'), Text(0.5, 0, 'Stages')]</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_37_1.png" alt="png"></p><h2 id="图例">图例</h2><h3 id="axlegend-loc-"><strong><em>ax.legend( loc )</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>, label=<span class="string">'one'</span>)</span><br><span class="line">ax.legend(loc=<span class="string">'best'</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.legend.Legend at 0x11dbcdba2e0&gt;</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_40_1.png" alt="png"></p><h2 id="添加文本">添加文本</h2><h3 id="axtext-x-y-str-rotation-ha-va-fontdict--dict---bbox--dict---"><strong><em>ax.text( x, y, str, rotation, ha, va, fontdict = dict( ... ), bbox = dict( ... ) )</em></strong></h3><p><strong><em>fontdict = dict( fontsize, color, family, weight )</em></strong><br><strong><em>bbox = dict( facecolor, edgecolor, edgewidth, alpha, pad )</em></strong></p><blockquote><p><strong><em>rotation</em></strong> : 旋转 , <strong><em>ha</em></strong> : 左右对齐方式 , <strong><em>va</em></strong> : 上下对齐方式</p><p><strong><em>fontdict</em></strong> : 字体属性字典<br><strong><em>family</em></strong> : 字体 , <strong><em>weight</em></strong> : 磅值</p><p><strong><em>bbox</em></strong> : 边框填充属性字典<br><strong><em>facecolor</em></strong> : 填充色 , <strong><em>edgecolor</em></strong> : 边框色, <strong><em>edgewidth</em></strong> : 边框粗细<br><strong><em>alpha</em></strong> : 透明度 , <strong><em>pad</em></strong> : 文本与框周围距离, <strong><em>boxstyle</em></strong> : 形状参数</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>, label=<span class="string">'one'</span>)</span><br><span class="line">ax.text(<span class="number">0</span>, <span class="number">10</span>, <span class="string">'Hello world!'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'bottom'</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(family=<span class="string">'monospace'</span>, fontsize=<span class="number">20</span>), </span><br><span class="line">        bbox = <span class="built_in">dict</span>(facecolor=<span class="string">'#74c476'</span>, edgecolor=<span class="string">'b'</span>, alpha=<span class="number">0.7</span>))</span><br></pre></td></tr></table></figure><pre><code>Text(0, 10, 'Hello world!')</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_44_1.png" alt="png"></p><h3 id="axannotate-text-xy-xytext-xycoords-textcoords-ha-va-weight-color-bbox-arrowprops-"><strong><em>ax.annotate( text, xy, xytext, xycoords, textcoords, ha, va, weight, color, bbox, arrowprops )</em></strong></h3><p><strong><em>xy = ( x, y )</em></strong><br><strong><em>xytext = ( x, y )</em></strong><br><strong><em>bbox = dict( facecolor, edgecolor, edgewidth, alpha, pad )</em></strong><br><strong><em>arrowprops = dict( facecolor, hatch, alpha, shrink, width, headwidth, headlength )</em></strong></p><blockquote><p><strong><em>xy</em></strong> : 箭头指向位置 , <strong><em>xytext</em></strong> : 文本位置<br><strong><em>xycoords</em></strong> : 箭头位置的参考坐标系 , <strong><em>textcoords</em></strong> : 选择文本位置的参考坐标系<br><strong><em>ha</em></strong> : 文本左右对齐方式 , <strong><em>va</em></strong> : 文本上下对齐方式<br><strong><em>weight</em></strong> : 文本磅值 , <strong><em>va</em></strong> : 文本颜色<br><strong><em>bbox</em></strong> : 文本边框填充属性字典</p><p><strong><em>arrowprops</em></strong> : 箭头属性字典<br><strong><em>facecolor</em></strong> : 填充色 , <strong><em>hatch</em></strong> : 填充形状<br><strong><em>shrink</em></strong> : 两端收缩控制, <strong><em>width</em></strong> : 箭身宽度<br><strong><em>headwidth</em></strong> : 箭头宽度, <strong><em>headlength</em></strong> : 箭头长度</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.hist(data, bins=<span class="number">50</span>, color=<span class="string">'k'</span> ,alpha=<span class="number">0.5</span>, label=<span class="string">'one'</span>)</span><br><span class="line">ax.annotate(<span class="string">'Hello World!'</span>, (<span class="number">0</span>, <span class="number">10</span>), (<span class="number">2</span>, <span class="number">25</span>), ha = <span class="string">'center'</span>, va = <span class="string">'top'</span>, fontsize=<span class="number">20</span>, </span><br><span class="line">            arrowprops=<span class="built_in">dict</span>(facecolor=<span class="string">'k'</span>, width=<span class="number">0.1</span>, headwidth=<span class="number">5</span>, headlength=<span class="number">5</span>, shrink=<span class="number">0.05</span>), </span><br><span class="line">            bbox = <span class="built_in">dict</span>(facecolor=<span class="string">'#74c476'</span>, edgecolor=<span class="string">'b'</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">            )</span><br></pre></td></tr></table></figure><pre><code>Text(2, 25, 'Hello World!')</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_47_1.png" alt="png"></p><h2 id="添加图形">添加图形</h2><h3 id="axadd_patch-shp-"><strong><em>ax.add_patch( shp )</em></strong></h3><p><strong><em>plt.Rectangle( xy, width, height, angle, color, alpha )</em></strong><br><strong><em>plt.Circle( xy, r, color, alpha )</em></strong><br><strong><em>plt.Polygon( [ xy1, xy2, ... ], color, alpha )</em></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure(figsize=(<span class="number">4.5</span>, <span class="number">9.5</span>))</span><br><span class="line">ax = fig.add_subplot(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.set_xlim(<span class="number">0</span>,<span class="number">9</span>)</span><br><span class="line">ax.set_ylim(<span class="number">1</span>,<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 正方形</span></span><br><span class="line">rect = plt.Rectangle((<span class="number">0</span>, <span class="number">1</span>), <span class="number">9</span>, <span class="number">20</span>, color=<span class="string">'#b7e464'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line">rect = plt.Rectangle((<span class="number">0.6</span>, <span class="number">13.9</span>), <span class="number">3.2</span>, <span class="number">5.5</span>, color=<span class="string">'#8db53c'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line">rect = plt.Rectangle((<span class="number">0.7</span>, <span class="number">14</span>), <span class="number">3</span>, <span class="number">5.3</span>, color=<span class="string">'#b7e464'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line">rect = plt.Rectangle((<span class="number">6.3</span>, <span class="number">0</span>), <span class="number">2</span>, <span class="number">20</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line">rect = plt.Rectangle((<span class="number">5.5</span>, <span class="number">0</span>), <span class="number">0.4</span>, <span class="number">20</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line"><span class="comment"># 圆形</span></span><br><span class="line">circ = plt.Circle((<span class="number">1.75</span>, <span class="number">15.15</span>), <span class="number">0.8</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">1.75</span>, <span class="number">15.15</span>), <span class="number">0.25</span>, color=<span class="string">'#121233'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">1.75</span>, <span class="number">18.15</span>), <span class="number">0.8</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">1.75</span>, <span class="number">18.15</span>), <span class="number">0.25</span>, color=<span class="string">'#121233'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">16.65</span>), <span class="number">0.4</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">16.65</span>), <span class="number">0.25</span>, color=<span class="string">'#121233'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">15.15</span>), <span class="number">0.35</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">18.15</span>), <span class="number">0.35</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">15.15</span>), <span class="number">0.25</span>, color=<span class="string">'w'</span>, alpha=<span class="number">0.9</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">18.15</span>), <span class="number">0.25</span>, color=<span class="string">'w'</span>, alpha=<span class="number">0.9</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">ax.text(<span class="number">7.3</span>, <span class="number">2.5</span>, <span class="string">'realme'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'bottom'</span>, rotation=<span class="number">90</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">30</span>, color=<span class="string">'#74c476'</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">9</span>):</span><br><span class="line">        ax.text(<span class="number">5.7</span>, <span class="number">1.4</span>+i*<span class="number">2</span>, <span class="string">'DARE TO LEAP'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'bottom'</span>, rotation=<span class="number">90</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">7</span>, color=<span class="string">'w'</span>))</span><br><span class="line">ax.text(<span class="number">5.7</span>, <span class="number">1.4</span>+(i+<span class="number">1</span>)*<span class="number">2</span>, <span class="string">'DAR'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'bottom'</span>, rotation=<span class="number">90</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">7</span>, color=<span class="string">'w'</span>))</span><br><span class="line">ax.text(<span class="number">1.75</span>, <span class="number">16.75</span>, <span class="string">'64MP'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'center'</span>, alpha=<span class="number">0.9</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">16</span>, color=<span class="string">'#EEEEEE'</span>, weight=<span class="string">'light'</span>))</span><br><span class="line">ax.text(<span class="number">1.75</span>, <span class="number">16.35</span>, <span class="string">'MATRIX CAMERA'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'center'</span>, alpha=<span class="number">0.9</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">5</span>, color=<span class="string">'#EEEEEE'</span>, weight=<span class="string">'light'</span>))</span><br></pre></td></tr></table></figure><pre><code>Text(1.75, 16.35, 'MATRIX CAMERA')</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_51_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">pgon = plt.Polygon([[<span class="number">0.1</span>, <span class="number">0.1</span>], [<span class="number">0.6</span>, <span class="number">0.9</span>], [<span class="number">0.9</span>, <span class="number">0.6</span>]])</span><br><span class="line">ax.add_patch(pgon)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.patches.Polygon at 0x11dbb80d640&gt;</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_52_1.png" alt="png"></p><h2 id="保存图片">保存图片</h2><h3 id="pltsavefig-fname-dpi-bbox_inches-"><strong><em>plt.savefig( fname, dpi, bbox_inches )</em></strong></h3><blockquote><p><strong><em>dpi</em></strong> : 每英寸点数分辨率, default: 100<br><strong><em>bbox_inches</em></strong> : 控制图片周围白边, bbox_inches = 'tight'</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure(figsize=(<span class="number">4.5</span>, <span class="number">9.5</span>))</span><br><span class="line">ax = fig.add_subplot(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.set_xlim(<span class="number">0</span>,<span class="number">9</span>)</span><br><span class="line">ax.set_ylim(<span class="number">1</span>,<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 正方形</span></span><br><span class="line">rect = plt.Rectangle((<span class="number">0</span>, <span class="number">1</span>), <span class="number">9</span>, <span class="number">20</span>, color=<span class="string">'#b7e464'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line">rect = plt.Rectangle((<span class="number">0.6</span>, <span class="number">13.9</span>), <span class="number">3.2</span>, <span class="number">5.5</span>, color=<span class="string">'#8db53c'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line">rect = plt.Rectangle((<span class="number">0.7</span>, <span class="number">14</span>), <span class="number">3</span>, <span class="number">5.3</span>, color=<span class="string">'#b7e464'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line">rect = plt.Rectangle((<span class="number">6.3</span>, <span class="number">0</span>), <span class="number">2</span>, <span class="number">20</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line">rect = plt.Rectangle((<span class="number">5.5</span>, <span class="number">0</span>), <span class="number">0.4</span>, <span class="number">20</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(rect)</span><br><span class="line"><span class="comment"># 圆形</span></span><br><span class="line">circ = plt.Circle((<span class="number">1.75</span>, <span class="number">15.15</span>), <span class="number">0.8</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">1.75</span>, <span class="number">15.15</span>), <span class="number">0.25</span>, color=<span class="string">'#121233'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">1.75</span>, <span class="number">18.15</span>), <span class="number">0.8</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)<span class="comment">## </span></span><br><span class="line">circ = plt.Circle((<span class="number">1.75</span>, <span class="number">18.15</span>), <span class="number">0.25</span>, color=<span class="string">'#121233'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">16.65</span>), <span class="number">0.4</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">16.65</span>), <span class="number">0.25</span>, color=<span class="string">'#121233'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">15.15</span>), <span class="number">0.35</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">18.15</span>), <span class="number">0.35</span>, color=<span class="string">'k'</span>, alpha=<span class="number">1</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">15.15</span>), <span class="number">0.25</span>, color=<span class="string">'w'</span>, alpha=<span class="number">0.9</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">circ = plt.Circle((<span class="number">3.1</span>, <span class="number">18.15</span>), <span class="number">0.25</span>, color=<span class="string">'w'</span>, alpha=<span class="number">0.9</span>)</span><br><span class="line">ax.add_patch(circ)</span><br><span class="line">ax.text(<span class="number">7.3</span>, <span class="number">2.5</span>, <span class="string">'realme'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'bottom'</span>, rotation=<span class="number">90</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">30</span>, color=<span class="string">'#74c476'</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">9</span>):</span><br><span class="line">        ax.text(<span class="number">5.7</span>, <span class="number">1.4</span>+i*<span class="number">2</span>, <span class="string">'DARE TO LEAP'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'bottom'</span>, rotation=<span class="number">90</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">7</span>, color=<span class="string">'w'</span>))</span><br><span class="line">ax.text(<span class="number">5.7</span>, <span class="number">1.4</span>+(i+<span class="number">1</span>)*<span class="number">2</span>, <span class="string">'DAR'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'bottom'</span>, rotation=<span class="number">90</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">7</span>, color=<span class="string">'w'</span>))</span><br><span class="line">ax.text(<span class="number">1.75</span>, <span class="number">16.75</span>, <span class="string">'64MP'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'center'</span>, alpha=<span class="number">0.9</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">16</span>, color=<span class="string">'#EEEEEE'</span>, weight=<span class="string">'light'</span>))</span><br><span class="line">ax.text(<span class="number">1.75</span>, <span class="number">16.35</span>, <span class="string">'MATRIX CAMERA'</span>, ha = <span class="string">'center'</span>, va = <span class="string">'center'</span>, alpha=<span class="number">0.9</span>, </span><br><span class="line">        fontdict = <span class="built_in">dict</span>(fontsize=<span class="number">5</span>, color=<span class="string">'#EEEEEE'</span>, weight=<span class="string">'light'</span>))</span><br><span class="line">plt.savefig(<span class="string">'realmeneo2.png'</span>, dpi=<span class="number">1080</span>, bbox_inches=<span class="string">'tight'</span>)</span><br></pre></td></tr></table></figure><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_55_0.png" alt="png"></p><h2 id="matplotlib-的全局配置">matplotlib 的全局配置</h2><h3 id="pltrc-group-kwargs---全局参数的定义"><strong><em>plt.rc( group, *</em>kwargs )</strong>* : 全局参数的定义</h3><blockquote><p><strong><em>group</em></strong> : <em>figure, font, axes, xtick, grid, legend</em> , 希望定义的对象</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># plt.rc('figure', figsize=(4, 3))</span></span><br><span class="line"><span class="comment"># font_options = {</span></span><br><span class="line"><span class="comment">#     'family' : 'monospace', </span></span><br><span class="line"><span class="comment">#     'weight' : 'bold', </span></span><br><span class="line"><span class="comment">#     'size' : 10}</span></span><br><span class="line"><span class="comment"># plt.rc('font', **font_options)</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">ax.text(<span class="number">0.2</span>, <span class="number">0.2</span>, <span class="string">'Hello world!'</span>, ha = <span class="string">'left'</span>, va = <span class="string">'bottom'</span>, </span><br><span class="line">        fontdict=<span class="built_in">dict</span>(fontsize=<span class="number">20</span>),   </span><br><span class="line">        bbox = <span class="built_in">dict</span>(facecolor=<span class="string">'#74c476'</span>, edgecolor=<span class="string">'b'</span>, alpha=<span class="number">0.7</span>))</span><br></pre></td></tr></table></figure><pre><code>Text(0.2, 0.2, 'Hello world!')</code></pre><p><img src="/2022/cdo/07-matplotlib/07-matplotlib_59_1.png" alt="png"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/06-pandas-data_wrangling_03/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/06-pandas-data_wrangling_03/" class="post-title-link" itemprop="url">数据分析-06-Pandas-数据重塑 Pt.3</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:42:06 / 修改时间：10:34:37" itemprop="dateCreated datePublished" datetime="2022-07-31T16:42:06Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><h2 id="合并数据">合并数据</h2><h3 id="pt2-合并数据回顾"><a href="./06-pandas-data_wrangling_02.md">Pt.2 合并数据回顾</a></h3><blockquote><p><strong><em>pd.merge( left, right, on, how, suffixes )</em></strong><br><strong><em>pd.merge( left, right, left_on, right_on, how, suffixes )</em></strong> : 分别根据左右指定列进行合并<br><strong><em>pd.merge( left, right, left_index, right_index, how, suffixes )</em></strong> : 分别根据左右索引进行合并<br><strong><em>left.join( right, how, on )</em></strong> : 更方便地实现按索引合并, 但要求没有重叠的列<br><strong><em>np.concatenate( arrs, axis )</em></strong> : NumPy 的轴向连接</p></blockquote><h3 id="pdconcat-objs-axis-join-keys-ignore_index---pandas-的轴向连接-可以将值和索引连在一起"><strong><em>pd.concat( objs, axis, join, keys, ignore_index )</em></strong> : pandas 的轴向连接, 可以将值和索引连在一起</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s1 = pd.Series([<span class="number">0</span>, <span class="number">1</span>], index=[<span class="string">'a'</span>, <span class="string">'b'</span>])</span><br><span class="line">s2 = pd.Series([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'e'</span>])</span><br><span class="line">s3 = pd.Series([<span class="number">5</span>, <span class="number">6</span>], index=[<span class="string">'a'</span>, <span class="string">'b'</span>])</span><br><span class="line">s1, s2, s3</span><br></pre></td></tr></table></figure><pre><code>(a    0
 b    1
 dtype: int64,
 a    2
 b    3
 e    4
 dtype: int64,
 a    5
 b    6
 dtype: int64)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([s1, s2, s3])</span><br></pre></td></tr></table></figure><pre><code>a    0
b    1
a    2
b    3
e    4
a    5
b    6
dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([s1, s2, s3], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>a</th><td>0.0</td><td>2</td><td>5.0</td></tr><tr><th>b</th><td>1.0</td><td>3</td><td>6.0</td></tr><tr><th>e</th><td>NaN</td><td>4</td><td>NaN</td></tr></tbody></table></div><h4 id="join--默认为-outer"><strong><em>join</em></strong> : 默认为 'outer'</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([s1, s2, s3], axis=<span class="number">1</span>, join=<span class="string">'inner'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>a</th><td>0</td><td>2</td><td>5</td></tr><tr><th>b</th><td>1</td><td>3</td><td>6</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([s1, s2, s3], axis=<span class="number">1</span>, join=<span class="string">'outer'</span>) </span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><th>a</th><td>0.0</td><td>2</td><td>5.0</td></tr><tr><th>b</th><td>1.0</td><td>3</td><td>6.0</td></tr><tr><th>e</th><td>NaN</td><td>4</td><td>NaN</td></tr></tbody></table></div><h4 id="keys"><strong><em>keys</em></strong></h4><p>沿着 axis=0 对 series 进行合并, 在连接轴创建一个层次化索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([s1, s1, s3], keys=[<span class="string">'one'</span>,<span class="string">'two'</span>, <span class="string">'three'</span>])</span><br></pre></td></tr></table></figure><p>one a 0<br>b 1<br>two a 0<br>b 1<br>three a 5<br>b 6<br>dtype: int64</p><p>沿着 axis=1 对 series 进行合并, keys 为列头</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([s1, s1, s3], axis=<span class="number">1</span>, keys=[<span class="string">'one'</span>,<span class="string">'two'</span>, <span class="string">'three'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th></tr></thead><tbody><tr><th>a</th><td>0</td><td>0</td><td>5</td></tr><tr><th>b</th><td>1</td><td>1</td><td>6</td></tr></tbody></table></div><p>同样的逻辑适用于 DataFrame</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(np.arange(<span class="number">6</span>).reshape(<span class="number">3</span>, <span class="number">2</span>), index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>],</span><br><span class="line">                   columns=[<span class="string">'one'</span>, <span class="string">'two'</span>])</span><br><span class="line">df2 = pd.DataFrame(<span class="number">5</span> + np.arange(<span class="number">4</span>).reshape(<span class="number">2</span>, <span class="number">2</span>), index=[<span class="string">'a'</span>, <span class="string">'c'</span>],</span><br><span class="line">                   columns=[<span class="string">'three'</span>, <span class="string">'four'</span>])</span><br><span class="line">df1, df2</span><br></pre></td></tr></table></figure><p>( one two<br>a 0 1<br>b 2 3<br>c 4 5,<br>three four<br>a 5 6<br>c 7 8)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df1, df2], axis=<span class="number">1</span>, keys=[<span class="string">'level1'</span>, <span class="string">'level2'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}</style><table border="1" class="dataframe"><thead><tr><th></th><th colspan="2" halign="left">level1</th><th colspan="2" halign="left">level2</th></tr><tr><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>a</th><td>0</td><td>1</td><td>5.0</td><td>6.0</td></tr><tr><th>b</th><td>2</td><td>3</td><td>NaN</td><td>NaN</td></tr><tr><th>c</th><td>4</td><td>5</td><td>7.0</td><td>8.0</td></tr></tbody></table></div><p>如果传入的 objs 不是列表而是一个字典, 则字典的键就会被当做 keys 的值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat({<span class="string">'level1'</span>: df1, <span class="string">'level2'</span>: df2}, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}</style><table border="1" class="dataframe"><thead><tr><th></th><th colspan="2" halign="left">level1</th><th colspan="2" halign="left">level2</th></tr><tr><th></th><th>one</th><th>two</th><th>three</th><th>four</th></tr></thead><tbody><tr><th>a</th><td>0</td><td>1</td><td>5.0</td><td>6.0</td></tr><tr><th>b</th><td>2</td><td>3</td><td>NaN</td><td>NaN</td></tr><tr><th>c</th><td>4</td><td>5</td><td>7.0</td><td>8.0</td></tr></tbody></table></div><h4 id="ignore_index--不保留连接轴上的索引-而是产生一组新索引"><strong><em>ignore_index</em></strong> : 不保留连接轴上的索引, 而是产生一组新索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(np.random.randn(<span class="number">3</span>, <span class="number">4</span>), columns=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>])</span><br><span class="line">df2 = pd.DataFrame(np.random.randn(<span class="number">2</span>, <span class="number">3</span>), columns=[<span class="string">'b'</span>, <span class="string">'d'</span>, <span class="string">'a'</span>])</span><br><span class="line">df1, df2</span><br></pre></td></tr></table></figure><p>( a b c d<br>0 -0.384417 -0.394028 0.098734 0.325203<br>1 2.274706 -1.128029 -2.126771 0.412944<br>2 1.957194 1.825529 0.009230 -0.479239,<br>b d a<br>0 -0.757975 -1.809006 -0.396801<br>1 0.112866 2.343804 0.815144)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df1, df2], ignore_index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th></tr></thead><tbody><tr><th>0</th><td>-0.384417</td><td>-0.394028</td><td>0.098734</td><td>0.325203</td></tr><tr><th>1</th><td>2.274706</td><td>-1.128029</td><td>-2.126771</td><td>0.412944</td></tr><tr><th>2</th><td>1.957194</td><td>1.825529</td><td>0.009230</td><td>-0.479239</td></tr><tr><th>0</th><td>-0.396801</td><td>-0.757975</td><td>NaN</td><td>-1.809006</td></tr><tr><th>1</th><td>0.815144</td><td>0.112866</td><td>NaN</td><td>2.343804</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df1, df2], ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th></tr></thead><tbody><tr><th>0</th><td>-0.384417</td><td>-0.394028</td><td>0.098734</td><td>0.325203</td></tr><tr><th>1</th><td>2.274706</td><td>-1.128029</td><td>-2.126771</td><td>0.412944</td></tr><tr><th>2</th><td>1.957194</td><td>1.825529</td><td>0.009230</td><td>-0.479239</td></tr><tr><th>3</th><td>-0.396801</td><td>-0.757975</td><td>NaN</td><td>-1.809006</td></tr><tr><th>4</th><td>0.815144</td><td>0.112866</td><td>NaN</td><td>2.343804</td></tr></tbody></table></div><h3 id="npwhere-condition-arr1-arr2---numpy-合并索引全部或部分重叠的数据的方法"><strong><em>np.where( condition, arr1, arr2 )</em></strong> : Numpy 合并索引全部或部分重叠的数据的方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = pd.Series([np.nan, <span class="number">2.5</span>, np.nan, <span class="number">3.5</span>, <span class="number">4.5</span>, np.nan],</span><br><span class="line">              index=[<span class="string">'f'</span>, <span class="string">'e'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>])</span><br><span class="line">b = pd.Series(np.arange(<span class="built_in">len</span>(a), dtype=np.float64),</span><br><span class="line">              index=[<span class="string">'f'</span>, <span class="string">'e'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>])</span><br><span class="line">b[-<span class="number">1</span>] = np.nan</span><br><span class="line">a, b</span><br></pre></td></tr></table></figure><p>(f NaN<br>e 2.5<br>d NaN<br>c 3.5<br>b 4.5<br>a NaN<br>dtype: float64,<br>f 0.0<br>e 1.0<br>d 2.0<br>c 3.0<br>b 4.0<br>a NaN<br>dtype: float64)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.where(pd.notnull(a), a, b)</span><br></pre></td></tr></table></figure><p>array([0. , 2.5, 2. , 3.5, 4.5, nan])</p><h3 id="obj1combine_first-obj2---pandas-合并索引全部或部分重叠的数据的方法"><strong><em>obj1.combine_first( obj2 )</em></strong> : pandas 合并索引全部或部分重叠的数据的方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.combine_first(b)</span><br><span class="line"><span class="comment"># 将 b 覆盖到 a 上, 值已经存在的部分不填充, 值为缺失的部分填充</span></span><br></pre></td></tr></table></figure><p>f 0.0<br>e 2.5<br>d 2.0<br>c 3.5<br>b 4.5<br>a NaN<br>dtype: float64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame({<span class="string">'a'</span>: [<span class="number">1.</span>, np.nan, <span class="number">5.</span>, np.nan],</span><br><span class="line">                    <span class="string">'b'</span>: [np.nan, <span class="number">2.</span>, np.nan, <span class="number">6.</span>],</span><br><span class="line">                    <span class="string">'c'</span>: <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">18</span>, <span class="number">4</span>)})</span><br><span class="line">df2 = pd.DataFrame({<span class="string">'a'</span>: [<span class="number">5.</span>, <span class="number">4.</span>, np.nan, <span class="number">3.</span>, <span class="number">7.</span>],</span><br><span class="line">                    <span class="string">'b'</span>: [np.nan, <span class="number">3.</span>, <span class="number">4.</span>, <span class="number">6.</span>, <span class="number">8.</span>]})</span><br><span class="line">df1, df2</span><br></pre></td></tr></table></figure><p>( a b c<br>0 1.0 NaN 2<br>1 NaN 2.0 6<br>2 5.0 NaN 10<br>3 NaN 6.0 14,<br>a b<br>0 5.0 NaN<br>1 4.0 3.0<br>2 NaN 4.0<br>3 3.0 6.0<br>4 7.0 8.0)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1.combine_first(df2) </span><br><span class="line"><span class="comment"># 将 df2 覆盖到 df1 上, 值已经存在的部分不填充, 值为缺失的部分填充</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>0</th><td>1.0</td><td>NaN</td><td>2.0</td></tr><tr><th>1</th><td>4.0</td><td>2.0</td><td>6.0</td></tr><tr><th>2</th><td>5.0</td><td>4.0</td><td>10.0</td></tr><tr><th>3</th><td>3.0</td><td>6.0</td><td>14.0</td></tr><tr><th>4</th><td>7.0</td><td>8.0</td><td>NaN</td></tr></tbody></table></div><h2 id="数据重塑和轴向旋转">数据重塑和轴向旋转</h2><p>进行 unstack 或 stack 时, 返回的结果中, 作为 <strong>旋转轴（即 <em>level</em> ）</strong> 的级别将成为 <strong>最低级别</strong></p><h3 id="framestack-level---将横轴旋转为竖轴-dataframe--series"><strong><em>frame.stack( level )</em></strong> : 将横轴旋转为竖轴, DataFrame → Series</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.arange(<span class="number">6</span>).reshape((<span class="number">2</span>, <span class="number">3</span>)),</span><br><span class="line">                    index=pd.Index([<span class="string">'Ohio'</span>, <span class="string">'Colorado'</span>], name=<span class="string">'state'</span>),</span><br><span class="line">                    columns=pd.Index([<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>],</span><br><span class="line">                    name=<span class="string">'number'</span>))</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th>number</th><th>one</th><th>two</th><th>three</th></tr><tr><th>state</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>Ohio</th><td>0</td><td>1</td><td>2</td></tr><tr><th>Colorado</th><td>3</td><td>4</td><td>5</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">series = frame.stack()</span><br><span class="line">series</span><br></pre></td></tr></table></figure><p>state number<br>Ohio one 0<br>two 1<br>three 2<br>Colorado one 3<br>two 4<br>three 5<br>dtype: int32</p><p><strong><em>level</em></strong> : 进行 unstack 或 stack 时, 返回的结果中, 作为 <strong>旋转轴（即 <em>level</em> ）</strong> 的级别将成为 <strong>最低级别</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(</span><br><span class="line">                  {<span class="string">'left'</span>: series, <span class="string">'right'</span>: series + <span class="number">5</span>},</span><br><span class="line">                  columns = pd.Index([<span class="string">'left'</span>, <span class="string">'right'</span>], name=<span class="string">'side'</span>)</span><br><span class="line">                 )</span><br><span class="line">df1</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>side</th><th>left</th><th>right</th></tr><tr><th>state</th><th>number</th><th></th><th></th></tr></thead><tbody><tr><th rowspan="3" valign="top">Ohio</th><th>one</th><td>0</td><td>5</td></tr><tr><th>two</th><td>1</td><td>6</td></tr><tr><th>three</th><td>2</td><td>7</td></tr><tr><th rowspan="3" valign="top">Colorado</th><th>one</th><td>3</td><td>8</td></tr><tr><th>two</th><td>4</td><td>9</td></tr><tr><th>three</th><td>5</td><td>10</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df2 = df1.unstack(<span class="string">'state'</span>)</span><br><span class="line">df2</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th>side</th><th colspan="2" halign="left">left</th><th colspan="2" halign="left">right</th></tr><tr><th>state</th><th>Ohio</th><th>Colorado</th><th>Ohio</th><th>Colorado</th></tr><tr><th>number</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>one</th><td>0</td><td>3</td><td>5</td><td>8</td></tr><tr><th>two</th><td>1</td><td>4</td><td>6</td><td>9</td></tr><tr><th>three</th><td>2</td><td>5</td><td>7</td><td>10</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df3 = df2.stack(<span class="string">'side'</span>)</span><br><span class="line">df3</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>state</th><th>Colorado</th><th>Ohio</th></tr><tr><th>number</th><th>side</th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">one</th><th>left</th><td>3</td><td>0</td></tr><tr><th>right</th><td>8</td><td>5</td></tr><tr><th rowspan="2" valign="top">two</th><th>left</th><td>4</td><td>1</td></tr><tr><th>right</th><td>9</td><td>6</td></tr><tr><th rowspan="2" valign="top">three</th><th>left</th><td>5</td><td>2</td></tr><tr><th>right</th><td>10</td><td>7</td></tr></tbody></table></div><h3 id="seriesunstack-level---将竖轴旋转为横轴-series--dataframe"><strong><em>series.unstack( level )</em></strong> : 将竖轴旋转为横轴, Series → DataFrame</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series</span><br></pre></td></tr></table></figure><p>state number<br>Ohio one 0<br>two 1<br>three 2<br>Colorado one 3<br>two 4<br>three 5<br>dtype: int32</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series.unstack()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th>number</th><th>one</th><th>two</th><th>three</th></tr><tr><th>state</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>Ohio</th><td>0</td><td>1</td><td>2</td></tr><tr><th>Colorado</th><td>3</td><td>4</td><td>5</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series.unstack(level=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th>state</th><th>Ohio</th><th>Colorado</th></tr><tr><th>number</th><th></th><th></th></tr></thead><tbody><tr><th>one</th><td>0</td><td>3</td></tr><tr><th>two</th><td>1</td><td>4</td></tr><tr><th>three</th><td>2</td><td>5</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series.unstack(level=<span class="string">'state'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th>state</th><th>Ohio</th><th>Colorado</th></tr><tr><th>number</th><th></th><th></th></tr></thead><tbody><tr><th>one</th><td>0</td><td>3</td></tr><tr><th>two</th><td>1</td><td>4</td></tr><tr><th>three</th><td>2</td><td>5</td></tr></tbody></table></div><p>如果不是所有的索引都能在各分组中找到的话, 则 unstack 可能会引入缺失值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s1 = pd.Series([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>])</span><br><span class="line">s2 = pd.Series([<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], index=[<span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>])</span><br><span class="line">s = pd.concat([s1, s2], keys=[<span class="string">'one'</span>, <span class="string">'two'</span>])</span><br><span class="line">s</span><br></pre></td></tr></table></figure><p>one a 0<br>b 1<br>c 2<br>d 3<br>two c 4<br>d 5<br>e 6<br>dtype: int64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = s.unstack()</span><br><span class="line"><span class="comment"># two 分组中找不到 a, b 这两个索引</span></span><br><span class="line">df</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>one</th><td>0.0</td><td>1.0</td><td>2.0</td><td>3.0</td><td>NaN</td></tr><tr><th>two</th><td>NaN</td><td>NaN</td><td>4.0</td><td>5.0</td><td>6.0</td></tr></tbody></table></div><p>stack 会默认过滤掉缺失值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.stack()</span><br></pre></td></tr></table></figure><p>one a 0.0<br>b 1.0<br>c 2.0<br>d 3.0<br>two c 4.0<br>d 5.0<br>e 6.0<br>dtype: float64</p><p>可以利用 <strong><em>dropna</em></strong> 控制是否过滤缺失值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.stack(dropna = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>one a 0.0<br>b 1.0<br>c 2.0<br>d 3.0<br>e NaN<br>two a NaN<br>b NaN<br>c 4.0<br>d 5.0<br>e 6.0<br>dtype: float64</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/06-pandas-data_wrangling_02/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/06-pandas-data_wrangling_02/" class="post-title-link" itemprop="url">数据分析-06-Pandas-数据重塑 Pt.2</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:42:05 / 修改时间：10:34:37" itemprop="dateCreated datePublished" datetime="2022-07-31T16:42:05Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><h2 id="合并数据">合并数据</h2><h3 id="pdmerge-left-right-on-how-suffixes-"><strong><em>pd.merge( left, right, on, how, suffixes )</em></strong></h3><blockquote><p><strong><em>on</em></strong> : 根据指定列进行合并, 默认为重叠列<br><strong><em>how</em></strong> : 连接效果, 默认为 ‘inner’, 其他方式还有 ‘outer’, ‘left’, ‘right’<br><strong><em>suffixes</em></strong> : 控制重复列的列名</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame({<span class="string">'key'</span>: [<span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>], </span><br><span class="line">                    <span class="string">'data1'</span>: <span class="built_in">range</span>(<span class="number">7</span>)})</span><br><span class="line">df2 = pd.DataFrame({<span class="string">'key'</span>: [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>], </span><br><span class="line">                    <span class="string">'data2'</span>: <span class="built_in">range</span>(<span class="number">3</span>)})</span><br><span class="line">df1, df2</span><br></pre></td></tr></table></figure><pre><code>(  key  data1
 0   b      0
 1   b      1
 2   a      2
 3   c      3
 4   a      4
 5   a      5
 6   b      6,
   key  data2
 0   a      0
 1   b      1
 2   d      2)</code></pre><h4 id="on--控制连接的列"><strong><em>on</em></strong> : 控制连接的列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df1, df2)</span><br><span class="line"><span class="comment"># 并没有指明要用哪个列进行连接, 如果没有指定, merge 就会将重叠列的列名当做键</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key</th><th>data1</th><th>data2</th></tr></thead><tbody><tr><th>0</th><td>b</td><td>0</td><td>1</td></tr><tr><th>1</th><td>b</td><td>1</td><td>1</td></tr><tr><th>2</th><td>b</td><td>6</td><td>1</td></tr><tr><th>3</th><td>a</td><td>2</td><td>0</td></tr><tr><th>4</th><td>a</td><td>4</td><td>0</td></tr><tr><th>5</th><td>a</td><td>5</td><td>0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df1, df2, on = <span class="string">'key'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key</th><th>data1</th><th>data2</th></tr></thead><tbody><tr><th>0</th><td>b</td><td>0</td><td>1</td></tr><tr><th>1</th><td>b</td><td>1</td><td>1</td></tr><tr><th>2</th><td>b</td><td>6</td><td>1</td></tr><tr><th>3</th><td>a</td><td>2</td><td>0</td></tr><tr><th>4</th><td>a</td><td>4</td><td>0</td></tr><tr><th>5</th><td>a</td><td>5</td><td>0</td></tr></tbody></table></div><p>根据多个列进行合并</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">left = pd.DataFrame({<span class="string">'key1'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>],</span><br><span class="line">                     <span class="string">'key2'</span>: [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>],</span><br><span class="line">                     <span class="string">'lval'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]})</span><br><span class="line">right = pd.DataFrame({<span class="string">'key1'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'bar'</span>],</span><br><span class="line">                      <span class="string">'key2'</span>: [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>],</span><br><span class="line">                      <span class="string">'rval'</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]})</span><br><span class="line">left, right</span><br></pre></td></tr></table></figure><p>( key1 key2 lval<br>0 foo one 1<br>1 foo two 2<br>2 bar one 3,<br>key1 key2 rval<br>0 foo one 4<br>1 foo one 5<br>2 bar one 6<br>3 bar two 7)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(left, right, on=[<span class="string">'key1'</span>, <span class="string">'key2'</span>], how=<span class="string">'outer'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key1</th><th>key2</th><th>lval</th><th>rval</th></tr></thead><tbody><tr><th>0</th><td>foo</td><td>one</td><td>1.0</td><td>4.0</td></tr><tr><th>1</th><td>foo</td><td>one</td><td>1.0</td><td>5.0</td></tr><tr><th>2</th><td>foo</td><td>two</td><td>2.0</td><td>NaN</td></tr><tr><th>3</th><td>bar</td><td>one</td><td>3.0</td><td>6.0</td></tr><tr><th>4</th><td>bar</td><td>two</td><td>NaN</td><td>7.0</td></tr></tbody></table></div><h4 id="suffixes--控制合并后重复列的命名"><strong><em>suffixes</em></strong> : 控制合并后重复列的命名</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(left, right, on=<span class="string">'key1'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key1</th><th>key2_x</th><th>lval</th><th>key2_y</th><th>rval</th></tr></thead><tbody><tr><th>0</th><td>foo</td><td>one</td><td>1</td><td>one</td><td>4</td></tr><tr><th>1</th><td>foo</td><td>one</td><td>1</td><td>one</td><td>5</td></tr><tr><th>2</th><td>foo</td><td>two</td><td>2</td><td>one</td><td>4</td></tr><tr><th>3</th><td>foo</td><td>two</td><td>2</td><td>one</td><td>5</td></tr><tr><th>4</th><td>bar</td><td>one</td><td>3</td><td>one</td><td>6</td></tr><tr><th>5</th><td>bar</td><td>one</td><td>3</td><td>two</td><td>7</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(left, right, on=<span class="string">'key1'</span>, suffixes=(<span class="string">'_left'</span>, <span class="string">'_right'</span>))</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key1</th><th>key2_left</th><th>lval</th><th>key2_right</th><th>rval</th></tr></thead><tbody><tr><th>0</th><td>foo</td><td>one</td><td>1</td><td>one</td><td>4</td></tr><tr><th>1</th><td>foo</td><td>one</td><td>1</td><td>one</td><td>5</td></tr><tr><th>2</th><td>foo</td><td>two</td><td>2</td><td>one</td><td>4</td></tr><tr><th>3</th><td>foo</td><td>two</td><td>2</td><td>one</td><td>5</td></tr><tr><th>4</th><td>bar</td><td>one</td><td>3</td><td>one</td><td>6</td></tr><tr><th>5</th><td>bar</td><td>one</td><td>3</td><td>two</td><td>7</td></tr></tbody></table></div><h3 id="pdmerge-left-right-left_on-right_on-how-suffixes---分别根据左右指定列进行合并"><strong><em>pd.merge( left, right, left_on, right_on, how, suffixes )</em></strong> : 分别根据左右指定列进行合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df3 = pd.DataFrame({<span class="string">'lkey'</span>: [<span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>],</span><br><span class="line">                    <span class="string">'data1'</span>: <span class="built_in">range</span>(<span class="number">7</span>)})</span><br><span class="line">df4 = pd.DataFrame({<span class="string">'rkey'</span>: [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>],</span><br><span class="line">                    <span class="string">'data2'</span>: <span class="built_in">range</span>(<span class="number">3</span>)})</span><br><span class="line">df3, df4</span><br></pre></td></tr></table></figure><p>( lkey data1<br>0 b 0<br>1 b 1<br>2 a 2<br>3 c 3<br>4 a 4<br>5 a 5<br>6 b 6,<br>rkey data2<br>0 a 0<br>1 b 1<br>2 d 2)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df3, df4, left_on=<span class="string">'lkey'</span>, right_on=<span class="string">'rkey'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>lkey</th><th>data1</th><th>rkey</th><th>data2</th></tr></thead><tbody><tr><th>0</th><td>b</td><td>0</td><td>b</td><td>1</td></tr><tr><th>1</th><td>b</td><td>1</td><td>b</td><td>1</td></tr><tr><th>2</th><td>b</td><td>6</td><td>b</td><td>1</td></tr><tr><th>3</th><td>a</td><td>2</td><td>a</td><td>0</td></tr><tr><th>4</th><td>a</td><td>4</td><td>a</td><td>0</td></tr><tr><th>5</th><td>a</td><td>5</td><td>a</td><td>0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df3, df4, left_on=<span class="string">'lkey'</span>, right_on=<span class="string">'rkey'</span>, how = <span class="string">'outer'</span>)</span><br><span class="line"><span class="comment">### 出现了 c 和 d</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>lkey</th><th>data1</th><th>rkey</th><th>data2</th></tr></thead><tbody><tr><th>0</th><td>b</td><td>0.0</td><td>b</td><td>1.0</td></tr><tr><th>1</th><td>b</td><td>1.0</td><td>b</td><td>1.0</td></tr><tr><th>2</th><td>b</td><td>6.0</td><td>b</td><td>1.0</td></tr><tr><th>3</th><td>a</td><td>2.0</td><td>a</td><td>0.0</td></tr><tr><th>4</th><td>a</td><td>4.0</td><td>a</td><td>0.0</td></tr><tr><th>5</th><td>a</td><td>5.0</td><td>a</td><td>0.0</td></tr><tr><th>6</th><td>c</td><td>3.0</td><td>NaN</td><td>NaN</td></tr><tr><th>7</th><td>NaN</td><td>NaN</td><td>d</td><td>2.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df3, df4, left_on=<span class="string">'lkey'</span>, right_on=<span class="string">'rkey'</span>, how = <span class="string">'left'</span>)</span><br><span class="line"><span class="comment"># 只有 c</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>lkey</th><th>data1</th><th>rkey</th><th>data2</th></tr></thead><tbody><tr><th>0</th><td>b</td><td>0</td><td>b</td><td>1.0</td></tr><tr><th>1</th><td>b</td><td>1</td><td>b</td><td>1.0</td></tr><tr><th>2</th><td>a</td><td>2</td><td>a</td><td>0.0</td></tr><tr><th>3</th><td>c</td><td>3</td><td>NaN</td><td>NaN</td></tr><tr><th>4</th><td>a</td><td>4</td><td>a</td><td>0.0</td></tr><tr><th>5</th><td>a</td><td>5</td><td>a</td><td>0.0</td></tr><tr><th>6</th><td>b</td><td>6</td><td>b</td><td>1.0</td></tr></tbody></table></div><h3 id="pdmerge-left-right-left_index-right_index-how-suffixes---分别根据左右索引进行合并"><strong><em>pd.merge( left, right, left_index, right_index, how, suffixes )</em></strong> : 分别根据左右索引进行合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">left1 = pd.DataFrame({<span class="string">'key'</span>: [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>], </span><br><span class="line">                      <span class="string">'value'</span>: <span class="built_in">range</span>(<span class="number">6</span>)})</span><br><span class="line">right1 =  pd.DataFrame({<span class="string">'group_val'</span>: [<span class="number">3.5</span>, <span class="number">7</span>]}, index=[<span class="string">'a'</span>, <span class="string">'b'</span>])</span><br><span class="line">left1, right1</span><br></pre></td></tr></table></figure><p>( key value<br>0 a 0<br>1 b 1<br>2 a 2<br>3 a 3<br>4 b 4<br>5 c 5,<br>group_val<br>a 3.5<br>b 7.0)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(left1, right1, left_index=<span class="literal">True</span>, right_index=<span class="literal">True</span>, how=<span class="string">'outer'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key</th><th>value</th><th>group_val</th></tr></thead><tbody><tr><th>0</th><td>a</td><td>0.0</td><td>NaN</td></tr><tr><th>1</th><td>b</td><td>1.0</td><td>NaN</td></tr><tr><th>2</th><td>a</td><td>2.0</td><td>NaN</td></tr><tr><th>3</th><td>a</td><td>3.0</td><td>NaN</td></tr><tr><th>4</th><td>b</td><td>4.0</td><td>NaN</td></tr><tr><th>5</th><td>c</td><td>5.0</td><td>NaN</td></tr><tr><th>a</th><td>NaN</td><td>NaN</td><td>3.5</td></tr><tr><th>b</th><td>NaN</td><td>NaN</td><td>7.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(left1, right1, left_on=<span class="string">'key'</span>, right_index=<span class="literal">True</span>, how=<span class="string">'outer'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key</th><th>value</th><th>group_val</th></tr></thead><tbody><tr><th>0</th><td>a</td><td>0</td><td>3.5</td></tr><tr><th>2</th><td>a</td><td>2</td><td>3.5</td></tr><tr><th>3</th><td>a</td><td>3</td><td>3.5</td></tr><tr><th>1</th><td>b</td><td>1</td><td>7.0</td></tr><tr><th>4</th><td>b</td><td>4</td><td>7.0</td></tr><tr><th>5</th><td>c</td><td>5</td><td>NaN</td></tr></tbody></table></div><h4 id="层次化索引数据的合并--索引的合并默认是多键合并">层次化索引数据的合并 : 索引的合并默认是多键合并</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lefth = pd.DataFrame({<span class="string">'key1'</span>: [<span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>,</span><br><span class="line">                               <span class="string">'Nevada'</span>, <span class="string">'Nevada'</span>],</span><br><span class="line">                      <span class="string">'key2'</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>],</span><br><span class="line">                      <span class="string">'data'</span>: np.arange(<span class="number">5.</span>)})</span><br><span class="line">righth = pd.DataFrame(np.arange(<span class="number">12</span>).reshape((<span class="number">6</span>, <span class="number">2</span>)),</span><br><span class="line">                      index=[[<span class="string">'Nevada'</span>, <span class="string">'Nevada'</span>, <span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>,<span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>],</span><br><span class="line">                             [<span class="number">2001</span>, <span class="number">2000</span>, <span class="number">2000</span>, <span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>]],</span><br><span class="line">                      columns=[<span class="string">'event1'</span>, <span class="string">'event2'</span>])</span><br><span class="line">lefth, righth</span><br></pre></td></tr></table></figure><p>( key1 key2 data<br>0 Ohio 2000 0.0<br>1 Ohio 2001 1.0<br>2 Ohio 2002 2.0<br>3 Nevada 2001 3.0<br>4 Nevada 2002 4.0,<br>event1 event2<br>Nevada 2001 0 1<br>2000 2 3<br>Ohio 2000 4 5<br>2000 6 7<br>2001 8 9<br>2002 10 11)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(lefth, righth, left_on=[<span class="string">'key1'</span>, <span class="string">'key2'</span>], right_index=<span class="literal">True</span>, how=<span class="string">'outer'</span>)</span><br><span class="line"><span class="comment"># righth 索引的合并默认是多键合并, 所以 lefth 必须以列表的形式指明多个列</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key1</th><th>key2</th><th>data</th><th>event1</th><th>event2</th></tr></thead><tbody><tr><th>0</th><td>Ohio</td><td>2000</td><td>0.0</td><td>4.0</td><td>5.0</td></tr><tr><th>0</th><td>Ohio</td><td>2000</td><td>0.0</td><td>6.0</td><td>7.0</td></tr><tr><th>1</th><td>Ohio</td><td>2001</td><td>1.0</td><td>8.0</td><td>9.0</td></tr><tr><th>2</th><td>Ohio</td><td>2002</td><td>2.0</td><td>10.0</td><td>11.0</td></tr><tr><th>3</th><td>Nevada</td><td>2001</td><td>3.0</td><td>0.0</td><td>1.0</td></tr><tr><th>4</th><td>Nevada</td><td>2002</td><td>4.0</td><td>NaN</td><td>NaN</td></tr><tr><th>4</th><td>Nevada</td><td>2000</td><td>NaN</td><td>2.0</td><td>3.0</td></tr></tbody></table></div><h3 id="leftjoin-right-how-on---更方便地实现按索引合并-但要求没有重叠的列"><strong><em>left.join( right, how, on )</em></strong> : 更方便地实现按索引合并, 但要求没有重叠的列</h3><blockquote><p><strong><em>on</em></strong> : 合并时, left 按 on 指定的列合并, right 按索引进行合并<br><strong><em>right</em></strong> :</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">left2 = pd.DataFrame([[<span class="number">1.</span>, <span class="number">2.</span>], [<span class="number">3.</span>, <span class="number">4.</span>], [<span class="number">5.</span>, <span class="number">6.</span>]],</span><br><span class="line">                     index=[<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'e'</span>],</span><br><span class="line">                     columns=[<span class="string">'Ohio'</span>, <span class="string">'Nevada'</span>])</span><br><span class="line">right2 = pd.DataFrame([[<span class="number">7.</span>, <span class="number">8.</span>], [<span class="number">9.</span>, <span class="number">10.</span>], [<span class="number">11.</span>, <span class="number">12.</span>], [<span class="number">13</span>, <span class="number">14</span>]], </span><br><span class="line">                      index=[<span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>], </span><br><span class="line">                      columns=[<span class="string">'Missouri'</span>, <span class="string">'Alabama'</span>]) </span><br><span class="line">left2, right2</span><br></pre></td></tr></table></figure><p>( Ohio Nevada<br>a 1.0 2.0<br>c 3.0 4.0<br>e 5.0 6.0,<br>Missouri Alabama<br>b 7.0 8.0<br>c 9.0 10.0<br>d 11.0 12.0<br>e 13.0 14.0)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">left2.join(right2)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Ohio</th><th>Nevada</th><th>Missouri</th><th>Alabama</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>2.0</td><td>NaN</td><td>NaN</td></tr><tr><th>c</th><td>3.0</td><td>4.0</td><td>9.0</td><td>10.0</td></tr><tr><th>e</th><td>5.0</td><td>6.0</td><td>13.0</td><td>14.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">left1, right1</span><br></pre></td></tr></table></figure><p>( key value<br>0 a 0<br>1 b 1<br>2 a 2<br>3 a 3<br>4 b 4<br>5 c 5,<br>group_val<br>a 3.5<br>b 7.0)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">left1.join(right1, on=<span class="string">'key'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key</th><th>value</th><th>group_val</th></tr></thead><tbody><tr><th>0</th><td>a</td><td>0</td><td>3.5</td></tr><tr><th>1</th><td>b</td><td>1</td><td>7.0</td></tr><tr><th>2</th><td>a</td><td>2</td><td>3.5</td></tr><tr><th>3</th><td>a</td><td>3</td><td>3.5</td></tr><tr><th>4</th><td>b</td><td>4</td><td>7.0</td></tr><tr><th>5</th><td>c</td><td>5</td><td>NaN</td></tr></tbody></table></div><h3 id="npconcatenate-arrs-axis---numpy-的轴向连接"><strong><em>np.concatenate( arrs, axis )</em></strong> : NumPy 的轴向连接</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr = np.arange(<span class="number">12</span>).reshape((<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure><p>array([[ 0, 1, 2, 3],<br>[ 4, 5, 6, 7],<br>[ 8, 9, 10, 11]])</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.concatenate([arr, arr], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>array([[ 0, 1, 2, 3, 0, 1, 2, 3],<br>[ 4, 5, 6, 7, 4, 5, 6, 7],<br>[ 8, 9, 10, 11, 8, 9, 10, 11]])</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/06-pandas-data_wrangling_01/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/06-pandas-data_wrangling_01/" class="post-title-link" itemprop="url">数据分析-06-Pandas-数据重塑 Pt.1</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:42:04 / 修改时间：10:34:37" itemprop="dateCreated datePublished" datetime="2022-07-31T16:42:04Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><h2 id="层次化索引">层次化索引</h2><h3 id="series-的层次化索引"><strong><em>Series 的层次化索引</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = pd.Series(np.random.randn(<span class="number">6</span>),</span><br><span class="line">                 index=[[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'c'</span>],</span><br><span class="line">                        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>]])</span><br><span class="line">data</span><br></pre></td></tr></table></figure><pre><code>a  1    0.971509
   2    1.042921
b  1    0.316566
   3    1.730938
c  2   -0.457496
   3    1.183176
dtype: float64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.index</span><br></pre></td></tr></table></figure><pre><code>MultiIndex([('a', 1),
            ('a', 2),
            ('b', 1),
            ('b', 3),
            ('c', 2),
            ('c', 3)],
           )</code></pre><h4 id="切片">切片</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">'b'</span>]</span><br></pre></td></tr></table></figure><pre><code>1    0.316566
3    1.730938
dtype: float64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">'b'</span>:<span class="string">'c'</span>]</span><br></pre></td></tr></table></figure><pre><code>b  1    0.316566
   3    1.730938
c  2   -0.457496
   3    1.183176
dtype: float64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[[<span class="string">'b'</span>, <span class="string">'a'</span>]]</span><br></pre></td></tr></table></figure><pre><code>b  1    0.316566
   3    1.730938
a  1    0.971509
   2    1.042921
dtype: float64</code></pre><p>在“内层”中进行切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.loc[:, <span class="number">2</span>]</span><br></pre></td></tr></table></figure><pre><code>a    1.042921
c   -0.457496
dtype: float64</code></pre><h3 id="seriesunstack--framestack---数据重塑-series--dataframe-dataframe--series"><strong><em>series.unstack( ), frame.stack( )</em></strong> : 数据重塑, Series → DataFrame, DataFrame → Series</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">frame = data.unstack()</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>1</th><th>2</th><th>3</th></tr></thead><tbody><tr><th>a</th><td>0.971509</td><td>1.042921</td><td>NaN</td></tr><tr><th>b</th><td>0.316566</td><td>NaN</td><td>1.730938</td></tr><tr><th>c</th><td>NaN</td><td>-0.457496</td><td>1.183176</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.stack()</span><br></pre></td></tr></table></figure><p>a 1 0.971509<br>2 1.042921<br>b 1 0.316566<br>3 1.730938<br>c 2 -0.457496<br>3 1.183176<br>dtype: float64</p><h3 id="dataframe-的层次化索引"><strong><em>DataFrame 的层次化索引</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.arange(<span class="number">12</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)),</span><br><span class="line">                     index=[[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>], </span><br><span class="line">                            [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>]],</span><br><span class="line">                     columns=[[<span class="string">'Ohio'</span>, <span class="string">'Ohio'</span>, <span class="string">'Colorado'</span>],</span><br><span class="line">                              [<span class="string">'Green'</span>, <span class="string">'Red'</span>, <span class="string">'Green'</span>]])</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}</style><table border="1" class="dataframe"><thead><tr><th></th><th></th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th></th><th>Green</th><th>Red</th><th>Green</th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><td>3</td><td>4</td><td>5</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><h4 id="names-属性"><strong><em>names</em></strong> 属性</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">frame.index.names = [<span class="string">'key1'</span>, <span class="string">'key2'</span>]</span><br><span class="line">frame.columns.names = [<span class="string">'state'</span>, <span class="string">'color'</span>]</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><td>3</td><td>4</td><td>5</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><h4 id="切片方式">切片方式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame[<span class="string">'Ohio'</span>], frame[<span class="string">'Ohio'</span>][<span class="string">'Green'</span>]</span><br></pre></td></tr></table></figure><p>(color Green Red<br>key1 key2<br>a 1 0 1<br>2 3 4<br>b 1 6 7<br>2 9 10,<br>key1 key2<br>a 1 0<br>2 3<br>b 1 6<br>2 9<br>Name: Green, dtype: int32)</p><h3 id="frameset_index-keys-drop--framereset_index-level---将-dataframe-的列转为索引"><strong><em>frame.set_index( keys, drop ), frame.reset_index( level )</em></strong> : 将 DataFrame 的列转为索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">frame2 = frame.reset_index()</span><br><span class="line">frame2</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}</style><table border="1" class="dataframe"><thead><tr><th>state</th><th>key1</th><th>key2</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th>color</th><th></th><th></th><th>Green</th><th>Red</th><th>Green</th></tr></thead><tbody><tr><th>0</th><td>a</td><td>1</td><td>0</td><td>1</td><td>2</td></tr><tr><th>1</th><td>a</td><td>2</td><td>3</td><td>4</td><td>5</td></tr><tr><th>2</th><td>b</td><td>1</td><td>6</td><td>7</td><td>8</td></tr><tr><th>3</th><td>b</td><td>2</td><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame2.set_index([<span class="string">'key1'</span>, <span class="string">'key2'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><td>3</td><td>4</td><td>5</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame2.set_index([<span class="string">'key1'</span>, <span class="string">'key2'</span>], drop=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th>key1</th><th>key2</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th></th><th></th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>a</td><td>1</td><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><td>a</td><td>2</td><td>3</td><td>4</td><td>5</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>b</td><td>1</td><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><td>b</td><td>2</td><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><h3 id="frameswaplevel-level1-level2--framesort_index-level---重排与分级排序"><strong><em>frame.swaplevel( level1, level2 ), frame.sort_index( level )</em></strong> : 重排与分级排序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><td>3</td><td>4</td><td>5</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.sort_index(level=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>a</th><th>1</th><td>0</td><td>1</td><td>2</td></tr><tr><th>b</th><th>1</th><td>6</td><td>7</td><td>8</td></tr><tr><th>a</th><th>2</th><td>3</td><td>4</td><td>5</td></tr><tr><th>b</th><th>2</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.swaplevel(<span class="string">'key1'</span>, <span class="string">'key2'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key2</th><th>key1</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1</th><th>a</th><td>0</td><td>1</td><td>2</td></tr><tr><th>2</th><th>a</th><td>3</td><td>4</td><td>5</td></tr><tr><th>1</th><th>b</th><td>6</td><td>7</td><td>8</td></tr><tr><th>2</th><th>b</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.swaplevel(<span class="string">'key1'</span>, <span class="string">'key2'</span>).sort_index(level=<span class="string">'key2'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th></th><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key2</th><th>key1</th><th></th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">1</th><th>a</th><td>0</td><td>1</td><td>2</td></tr><tr><th>b</th><td>6</td><td>7</td><td>8</td></tr><tr><th rowspan="2" valign="top">2</th><th>a</th><td>3</td><td>4</td><td>5</td></tr><tr><th>b</th><td>9</td><td>10</td><td>11</td></tr></tbody></table></div><h3 id="framegroupby-axis-level-sum---汇总统计"><strong><em>frame.groupby( axis, level ).sum( )</em></strong> : 汇总统计</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.groupby(level=<span class="string">'key2'</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th>state</th><th colspan="2" halign="left">Ohio</th><th>Colorado</th></tr><tr><th>color</th><th>Green</th><th>Red</th><th>Green</th></tr><tr><th>key2</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1</th><td>6</td><td>8</td><td>10</td></tr><tr><th>2</th><td>12</td><td>14</td><td>16</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.groupby(axis=<span class="number">1</span>, level=<span class="string">'color'</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>color</th><th>Green</th><th>Red</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th></tr></thead><tbody><tr><th rowspan="2" valign="top">a</th><th>1</th><td>2</td><td>1</td></tr><tr><th>2</th><td>8</td><td>4</td></tr><tr><th rowspan="2" valign="top">b</th><th>1</th><td>14</td><td>7</td></tr><tr><th>2</th><td>20</td><td>10</td></tr></tbody></table></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/06-pandas-data_wrangling_04/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/06-pandas-data_wrangling_04/" class="post-title-link" itemprop="url">数据分析-06-Pandas-数据重塑 Pt.4</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:42:04 / 修改时间：10:34:37" itemprop="dateCreated datePublished" datetime="2022-07-31T16:42:04Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><h2 id="数据重塑和轴向旋转">数据重塑和轴向旋转</h2><h3 id="pt3-数据重塑和轴向旋转回顾"><a href="./06-pandas-data_wrangling_03.md">Pt.3 数据重塑和轴向旋转回顾</a></h3><blockquote><p><strong><em>frame.stack( level )</em></strong> : 将横轴旋转为竖轴, DataFrame → Series<br><strong><em>series.unstack( level )</em></strong> : 将竖轴旋转为横轴, Series → DataFrame</p></blockquote><h3 id="framepivot-index-columns-values---将长格式旋转为宽格式"><strong><em>frame.pivot( index, columns, values )</em></strong> : 将长格式旋转为宽格式</h3><p>index 和 columns 分别用作行和列索引, values 用于填充的数据列（可选）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/macrodata.csv'</span>)</span><br><span class="line">periods = pd.PeriodIndex(year=data.year, quarter=data.quarter,</span><br><span class="line">                         name=<span class="string">'date'</span>)</span><br><span class="line">columns = pd.Index([<span class="string">'realgdp'</span>, <span class="string">'infl'</span>, <span class="string">'unemp'</span>], name=<span class="string">'item'</span>)</span><br><span class="line">data = data.reindex(columns=columns)</span><br><span class="line">data.index = periods.to_timestamp(<span class="string">'D'</span>, <span class="string">'end'</span>)</span><br><span class="line">ldata = data.stack().reset_index().rename(columns={<span class="number">0</span>: <span class="string">'value'</span>})</span><br><span class="line">ldata</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>date</th><th>item</th><th>value</th></tr></thead><tbody><tr><th>0</th><td>1959-03-31 23:59:59.999999999</td><td>realgdp</td><td>2710.349</td></tr><tr><th>1</th><td>1959-03-31 23:59:59.999999999</td><td>infl</td><td>0.000</td></tr><tr><th>2</th><td>1959-03-31 23:59:59.999999999</td><td>unemp</td><td>5.800</td></tr><tr><th>3</th><td>1959-06-30 23:59:59.999999999</td><td>realgdp</td><td>2778.801</td></tr><tr><th>4</th><td>1959-06-30 23:59:59.999999999</td><td>infl</td><td>2.340</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td></tr><tr><th>604</th><td>2009-06-30 23:59:59.999999999</td><td>infl</td><td>3.370</td></tr><tr><th>605</th><td>2009-06-30 23:59:59.999999999</td><td>unemp</td><td>9.200</td></tr><tr><th>606</th><td>2009-09-30 23:59:59.999999999</td><td>realgdp</td><td>12990.341</td></tr><tr><th>607</th><td>2009-09-30 23:59:59.999999999</td><td>infl</td><td>3.560</td></tr><tr><th>608</th><td>2009-09-30 23:59:59.999999999</td><td>unemp</td><td>9.600</td></tr></tbody></table><p>609 rows × 3 columns</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ldata.pivot(<span class="string">'date'</span>, <span class="string">'item'</span>, <span class="string">'value'</span>)</span><br><span class="line"><span class="comment"># 以 date 为索引（去除共同项）, 将 item 进行拆分旋转, 将 value 填到对应的位置中</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th>item</th><th>infl</th><th>realgdp</th><th>unemp</th></tr><tr><th>date</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1959-03-31 23:59:59.999999999</th><td>0.00</td><td>2710.349</td><td>5.8</td></tr><tr><th>1959-06-30 23:59:59.999999999</th><td>2.34</td><td>2778.801</td><td>5.1</td></tr><tr><th>1959-09-30 23:59:59.999999999</th><td>2.74</td><td>2775.488</td><td>5.3</td></tr><tr><th>1959-12-31 23:59:59.999999999</th><td>0.27</td><td>2785.204</td><td>5.6</td></tr><tr><th>1960-03-31 23:59:59.999999999</th><td>2.31</td><td>2847.699</td><td>5.2</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td></tr><tr><th>2008-09-30 23:59:59.999999999</th><td>-3.16</td><td>13324.600</td><td>6.0</td></tr><tr><th>2008-12-31 23:59:59.999999999</th><td>-8.79</td><td>13141.920</td><td>6.9</td></tr><tr><th>2009-03-31 23:59:59.999999999</th><td>0.94</td><td>12925.410</td><td>8.1</td></tr><tr><th>2009-06-30 23:59:59.999999999</th><td>3.37</td><td>12901.504</td><td>9.2</td></tr><tr><th>2009-09-30 23:59:59.999999999</th><td>3.56</td><td>12990.341</td><td>9.6</td></tr></tbody></table><p>203 rows × 3 columns</p></div><h4 id="假设有两个需要同时重塑的数据列">假设有两个需要同时重塑的数据列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ldata[<span class="string">'value2'</span>] = np.random.randn(<span class="built_in">len</span>(ldata))</span><br><span class="line">ldata</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>date</th><th>item</th><th>value</th><th>value2</th></tr></thead><tbody><tr><th>0</th><td>1959-03-31 23:59:59.999999999</td><td>realgdp</td><td>2710.349</td><td>0.176200</td></tr><tr><th>1</th><td>1959-03-31 23:59:59.999999999</td><td>infl</td><td>0.000</td><td>-0.194493</td></tr><tr><th>2</th><td>1959-03-31 23:59:59.999999999</td><td>unemp</td><td>5.800</td><td>-0.363329</td></tr><tr><th>3</th><td>1959-06-30 23:59:59.999999999</td><td>realgdp</td><td>2778.801</td><td>-1.510863</td></tr><tr><th>4</th><td>1959-06-30 23:59:59.999999999</td><td>infl</td><td>2.340</td><td>0.144886</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>604</th><td>2009-06-30 23:59:59.999999999</td><td>infl</td><td>3.370</td><td>-0.936350</td></tr><tr><th>605</th><td>2009-06-30 23:59:59.999999999</td><td>unemp</td><td>9.200</td><td>1.452993</td></tr><tr><th>606</th><td>2009-09-30 23:59:59.999999999</td><td>realgdp</td><td>12990.341</td><td>-0.137653</td></tr><tr><th>607</th><td>2009-09-30 23:59:59.999999999</td><td>infl</td><td>3.560</td><td>-0.423567</td></tr><tr><th>608</th><td>2009-09-30 23:59:59.999999999</td><td>unemp</td><td>9.600</td><td>0.086320</td></tr></tbody></table><p>609 rows × 4 columns</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldata.pivot(<span class="string">'date'</span>, <span class="string">'item'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th colspan="3" halign="left">value</th><th colspan="3" halign="left">value2</th></tr><tr><th>item</th><th>infl</th><th>realgdp</th><th>unemp</th><th>infl</th><th>realgdp</th><th>unemp</th></tr><tr><th>date</th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1959-03-31 23:59:59.999999999</th><td>0.00</td><td>2710.349</td><td>5.8</td><td>-0.194493</td><td>0.176200</td><td>-0.363329</td></tr><tr><th>1959-06-30 23:59:59.999999999</th><td>2.34</td><td>2778.801</td><td>5.1</td><td>0.144886</td><td>-1.510863</td><td>0.619092</td></tr><tr><th>1959-09-30 23:59:59.999999999</th><td>2.74</td><td>2775.488</td><td>5.3</td><td>-1.519818</td><td>1.400742</td><td>-0.669686</td></tr><tr><th>1959-12-31 23:59:59.999999999</th><td>0.27</td><td>2785.204</td><td>5.6</td><td>-0.027059</td><td>1.053187</td><td>-1.069302</td></tr><tr><th>1960-03-31 23:59:59.999999999</th><td>2.31</td><td>2847.699</td><td>5.2</td><td>-1.157763</td><td>-1.174653</td><td>-0.562152</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>2008-09-30 23:59:59.999999999</th><td>-3.16</td><td>13324.600</td><td>6.0</td><td>0.632464</td><td>-0.447070</td><td>1.267958</td></tr><tr><th>2008-12-31 23:59:59.999999999</th><td>-8.79</td><td>13141.920</td><td>6.9</td><td>-1.030839</td><td>-0.359484</td><td>0.606553</td></tr><tr><th>2009-03-31 23:59:59.999999999</th><td>0.94</td><td>12925.410</td><td>8.1</td><td>-1.447697</td><td>0.711061</td><td>-0.873898</td></tr><tr><th>2009-06-30 23:59:59.999999999</th><td>3.37</td><td>12901.504</td><td>9.2</td><td>-0.936350</td><td>0.395591</td><td>1.452993</td></tr><tr><th>2009-09-30 23:59:59.999999999</th><td>3.56</td><td>12990.341</td><td>9.6</td><td>-0.423567</td><td>-0.137653</td><td>0.086320</td></tr></tbody></table><p>203 rows × 6 columns</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldata.pivot(<span class="string">'date'</span>, <span class="string">'item'</span>, [<span class="string">'value'</span>, <span class="string">'value2'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th colspan="3" halign="left">value</th><th colspan="3" halign="left">value2</th></tr><tr><th>item</th><th>infl</th><th>realgdp</th><th>unemp</th><th>infl</th><th>realgdp</th><th>unemp</th></tr><tr><th>date</th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1959-03-31 23:59:59.999999999</th><td>0.00</td><td>2710.349</td><td>5.8</td><td>-0.194493</td><td>0.176200</td><td>-0.363329</td></tr><tr><th>1959-06-30 23:59:59.999999999</th><td>2.34</td><td>2778.801</td><td>5.1</td><td>0.144886</td><td>-1.510863</td><td>0.619092</td></tr><tr><th>1959-09-30 23:59:59.999999999</th><td>2.74</td><td>2775.488</td><td>5.3</td><td>-1.519818</td><td>1.400742</td><td>-0.669686</td></tr><tr><th>1959-12-31 23:59:59.999999999</th><td>0.27</td><td>2785.204</td><td>5.6</td><td>-0.027059</td><td>1.053187</td><td>-1.069302</td></tr><tr><th>1960-03-31 23:59:59.999999999</th><td>2.31</td><td>2847.699</td><td>5.2</td><td>-1.157763</td><td>-1.174653</td><td>-0.562152</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>2008-09-30 23:59:59.999999999</th><td>-3.16</td><td>13324.600</td><td>6.0</td><td>0.632464</td><td>-0.447070</td><td>1.267958</td></tr><tr><th>2008-12-31 23:59:59.999999999</th><td>-8.79</td><td>13141.920</td><td>6.9</td><td>-1.030839</td><td>-0.359484</td><td>0.606553</td></tr><tr><th>2009-03-31 23:59:59.999999999</th><td>0.94</td><td>12925.410</td><td>8.1</td><td>-1.447697</td><td>0.711061</td><td>-0.873898</td></tr><tr><th>2009-06-30 23:59:59.999999999</th><td>3.37</td><td>12901.504</td><td>9.2</td><td>-0.936350</td><td>0.395591</td><td>1.452993</td></tr><tr><th>2009-09-30 23:59:59.999999999</th><td>3.56</td><td>12990.341</td><td>9.6</td><td>-0.423567</td><td>-0.137653</td><td>0.086320</td></tr></tbody></table><p>203 rows × 6 columns</p></div><h4 id="pivot-其实就是用-set_index-创建层次化索引-再用-unstack-重塑">pivot 其实就是用 set_index 创建层次化索引, 再用 unstack 重塑</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldata.set_index([<span class="string">'date'</span>, <span class="string">'item'</span>]).unstack(<span class="string">'item'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead tr th{text-align:left}.dataframe thead tr:last-of-type th{text-align:right}</style><table border="1" class="dataframe"><thead><tr><th></th><th colspan="3" halign="left">value</th><th colspan="3" halign="left">value2</th></tr><tr><th>item</th><th>infl</th><th>realgdp</th><th>unemp</th><th>infl</th><th>realgdp</th><th>unemp</th></tr><tr><th>date</th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1959-03-31 23:59:59.999999999</th><td>0.00</td><td>2710.349</td><td>5.8</td><td>-0.194493</td><td>0.176200</td><td>-0.363329</td></tr><tr><th>1959-06-30 23:59:59.999999999</th><td>2.34</td><td>2778.801</td><td>5.1</td><td>0.144886</td><td>-1.510863</td><td>0.619092</td></tr><tr><th>1959-09-30 23:59:59.999999999</th><td>2.74</td><td>2775.488</td><td>5.3</td><td>-1.519818</td><td>1.400742</td><td>-0.669686</td></tr><tr><th>1959-12-31 23:59:59.999999999</th><td>0.27</td><td>2785.204</td><td>5.6</td><td>-0.027059</td><td>1.053187</td><td>-1.069302</td></tr><tr><th>1960-03-31 23:59:59.999999999</th><td>2.31</td><td>2847.699</td><td>5.2</td><td>-1.157763</td><td>-1.174653</td><td>-0.562152</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>2008-09-30 23:59:59.999999999</th><td>-3.16</td><td>13324.600</td><td>6.0</td><td>0.632464</td><td>-0.447070</td><td>1.267958</td></tr><tr><th>2008-12-31 23:59:59.999999999</th><td>-8.79</td><td>13141.920</td><td>6.9</td><td>-1.030839</td><td>-0.359484</td><td>0.606553</td></tr><tr><th>2009-03-31 23:59:59.999999999</th><td>0.94</td><td>12925.410</td><td>8.1</td><td>-1.447697</td><td>0.711061</td><td>-0.873898</td></tr><tr><th>2009-06-30 23:59:59.999999999</th><td>3.37</td><td>12901.504</td><td>9.2</td><td>-0.936350</td><td>0.395591</td><td>1.452993</td></tr><tr><th>2009-09-30 23:59:59.999999999</th><td>3.56</td><td>12990.341</td><td>9.6</td><td>-0.423567</td><td>-0.137653</td><td>0.086320</td></tr></tbody></table><p>203 rows × 6 columns</p></div><h3 id="pdmelt-frame-id_vars-value_vars---将宽格式旋转为长格式"><strong><em>pd.melt( frame, id_vars, value_vars )</em></strong> : 将宽格式旋转为长格式</h3><p>id_vars 为分组指标, value_vars 为合并到一起的列</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame({<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>],</span><br><span class="line">                   <span class="string">'A'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">                   <span class="string">'B'</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">                   <span class="string">'C'</span>: [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]})</span><br><span class="line">df</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key</th><th>A</th><th>B</th><th>C</th></tr></thead><tbody><tr><th>0</th><td>foo</td><td>1</td><td>4</td><td>7</td></tr><tr><th>1</th><td>bar</td><td>2</td><td>5</td><td>8</td></tr><tr><th>2</th><td>baz</td><td>3</td><td>6</td><td>9</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.melt(df, [<span class="string">'key'</span>], [<span class="string">'A'</span>, <span class="string">'B'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key</th><th>variable</th><th>value</th></tr></thead><tbody><tr><th>0</th><td>foo</td><td>A</td><td>1</td></tr><tr><th>1</th><td>bar</td><td>A</td><td>2</td></tr><tr><th>2</th><td>baz</td><td>A</td><td>3</td></tr><tr><th>3</th><td>foo</td><td>B</td><td>4</td></tr><tr><th>4</th><td>bar</td><td>B</td><td>5</td></tr><tr><th>5</th><td>baz</td><td>B</td><td>6</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.melt(df, [<span class="string">'A'</span>, <span class="string">'B'</span>], [<span class="string">'C'</span>, <span class="string">'key'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>A</th><th>B</th><th>variable</th><th>value</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>4</td><td>C</td><td>7</td></tr><tr><th>1</th><td>2</td><td>5</td><td>C</td><td>8</td></tr><tr><th>2</th><td>3</td><td>6</td><td>C</td><td>9</td></tr><tr><th>3</th><td>1</td><td>4</td><td>key</td><td>foo</td></tr><tr><th>4</th><td>2</td><td>5</td><td>key</td><td>bar</td></tr><tr><th>5</th><td>3</td><td>6</td><td>key</td><td>baz</td></tr></tbody></table></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/04-pandas-data_loading/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/04-pandas-data_loading/" class="post-title-link" itemprop="url">数据分析-04-Pandas-数据读写</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:23:07 / 修改时间：10:31:13" itemprop="dateCreated datePublished" datetime="2022-07-31T16:23:07Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><h2 id="读文件">读文件</h2><h3 id="pdread_csv-path-sep-header-index_col-names-skiprows-na_values-nrows-chunksize-encoding-"><strong><em>pd.read_csv( path, sep, header, index_col, names, skiprows, na_values, nrows, chunksize, encoding )</em></strong></h3><blockquote><p><strong><em>path</em></strong> : 文件位置<br><strong><em>sep</em></strong> : 对每行各字段进行拆分的字符序列<br><strong><em>header</em></strong> : 用作列名的行号, 默认为 0 , 没有标题行设为 None<br><strong><em>names</em></strong> : 用作设置列名的 list<br><strong><em>index_col</em></strong> : 用作索引的列标签, 可以是单个或多个列名组成的 list<br><strong><em>skiprows</em></strong> : 需要忽略的行号的 list<br><strong><em>na_values</em></strong> : 用作替换缺失值 NaN 的 list 或 dict<br><strong><em>nrows</em></strong> : 需要读取的行数<br><strong><em>chunksize</em></strong> : 返回分块读取的迭代器<br><strong><em>encoding</em></strong> : 用作 unicode 的文本编码格式</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex1.csv'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>2</td><td>3</td><td>4</td><td>hello</td></tr><tr><th>1</th><td>5</td><td>6</td><td>7</td><td>8</td><td>world</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td><td>12</td><td>foo</td></tr></tbody></table></div><h4 id="header--处理没有标题行的文件"><strong><em>header</em></strong> : 处理没有标题行的文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex2.csv'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>1</th><th>2</th><th>3</th><th>4</th><th>hello</th></tr></thead><tbody><tr><th>0</th><td>5</td><td>6</td><td>7</td><td>8</td><td>world</td></tr><tr><th>1</th><td>9</td><td>10</td><td>11</td><td>12</td><td>foo</td></tr></tbody></table></div><p>header = None</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex2.csv'</span>, header=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>2</td><td>3</td><td>4</td><td>hello</td></tr><tr><th>1</th><td>5</td><td>6</td><td>7</td><td>8</td><td>world</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td><td>12</td><td>foo</td></tr></tbody></table></div><p>names = list</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex2.csv'</span>, names=[<span class="string">'q'</span>, <span class="string">'w'</span>, <span class="string">'e'</span>, <span class="string">'r'</span>, <span class="string">'message'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>q</th><th>w</th><th>e</th><th>r</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>2</td><td>3</td><td>4</td><td>hello</td></tr><tr><th>1</th><td>5</td><td>6</td><td>7</td><td>8</td><td>world</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td><td>12</td><td>foo</td></tr></tbody></table></div><h4 id="index_col--设置索引"><strong><em>index_col</em></strong> : 设置索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex2.csv'</span>, </span><br><span class="line">            names=[<span class="string">'q'</span>, <span class="string">'w'</span>, <span class="string">'e'</span>, <span class="string">'r'</span>, <span class="string">'message'</span>], </span><br><span class="line">            index_col=<span class="string">'message'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>q</th><th>w</th><th>e</th><th>r</th></tr><tr><th>message</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>hello</th><td>1</td><td>2</td><td>3</td><td>4</td></tr><tr><th>world</th><td>5</td><td>6</td><td>7</td><td>8</td></tr><tr><th>foo</th><td>9</td><td>10</td><td>11</td><td>12</td></tr></tbody></table></div><p>层次化索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/csv_mindex.csv'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>key1</th><th>key2</th><th>value1</th><th>value2</th></tr></thead><tbody><tr><th>0</th><td>one</td><td>a</td><td>1</td><td>2</td></tr><tr><th>1</th><td>one</td><td>b</td><td>3</td><td>4</td></tr><tr><th>2</th><td>one</td><td>c</td><td>5</td><td>6</td></tr><tr><th>3</th><td>one</td><td>d</td><td>7</td><td>8</td></tr><tr><th>4</th><td>two</td><td>a</td><td>9</td><td>10</td></tr><tr><th>5</th><td>two</td><td>b</td><td>11</td><td>12</td></tr><tr><th>6</th><td>two</td><td>c</td><td>13</td><td>14</td></tr><tr><th>7</th><td>two</td><td>d</td><td>15</td><td>16</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/csv_mindex.csv'</span>, index_col=[<span class="string">'key1'</span>, <span class="string">'key2'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th></th><th>value1</th><th>value2</th></tr><tr><th>key1</th><th>key2</th><th></th><th></th></tr></thead><tbody><tr><th rowspan="4" valign="top">one</th><th>a</th><td>1</td><td>2</td></tr><tr><th>b</th><td>3</td><td>4</td></tr><tr><th>c</th><td>5</td><td>6</td></tr><tr><th>d</th><td>7</td><td>8</td></tr><tr><th rowspan="4" valign="top">two</th><th>a</th><td>9</td><td>10</td></tr><tr><th>b</th><td>11</td><td>12</td></tr><tr><th>c</th><td>13</td><td>14</td></tr><tr><th>d</th><td>15</td><td>16</td></tr></tbody></table></div><h4 id="skiprows--跳行"><strong><em>skiprows</em></strong> : 跳行</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>(<span class="built_in">open</span>(<span class="string">'pydata-book-2nd-edition/examples/ex4.csv'</span>))</span><br></pre></td></tr></table></figure><p>['# hey!',<br>'a,b,c,d,message',<br>'# just wanted to make things more difficult for you',<br>'# who reads CSV files with computers, anyway?',<br>'1,2,3,4,hello',<br>'5,6,7,8,world',<br>'9,10,11,12,foo']</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex4.csv'</span>, skiprows=[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="comment"># 跳过第1、3、4行</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>2</td><td>3</td><td>4</td><td>hello</td></tr><tr><th>1</th><td>5</td><td>6</td><td>7</td><td>8</td><td>world</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td><td>12</td><td>foo</td></tr></tbody></table></div><h4 id="na_values--处理缺失值"><strong><em>na_values</em></strong> : 处理缺失值</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>(<span class="built_in">open</span>(<span class="string">'pydata-book-2nd-edition/examples/ex5.csv'</span>))</span><br></pre></td></tr></table></figure><p>['something,a,b,c,d,message',<br>'one,1,2,3,4,NA',<br>'two,5,6,,8,world',<br>'three,9,10,11,12,foo']</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex5.csv'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>something</th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>one</td><td>1</td><td>2</td><td>3.0</td><td>4</td><td>NaN</td></tr><tr><th>1</th><td>two</td><td>5</td><td>6</td><td>NaN</td><td>8</td><td>world</td></tr><tr><th>2</th><td>three</td><td>9</td><td>10</td><td>11.0</td><td>12</td><td>foo</td></tr></tbody></table></div><p>na_value = dic/list</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex5.csv'</span>, na_values=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>something</th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>NaN</td><td>1</td><td>2</td><td>3.0</td><td>4</td><td>NaN</td></tr><tr><th>1</th><td>NaN</td><td>5</td><td>6</td><td>NaN</td><td>8</td><td>world</td></tr><tr><th>2</th><td>NaN</td><td>9</td><td>10</td><td>11.0</td><td>12</td><td>foo</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字典的各列可以使用不同的 NaN 标记值</span></span><br><span class="line">sentinels = {<span class="string">'message'</span>: [<span class="string">'foo'</span>, <span class="string">'NA'</span>], <span class="string">'something'</span>: [<span class="string">'two'</span>]}  </span><br><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex5.csv'</span>, na_values=sentinels)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>something</th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>one</td><td>1</td><td>2</td><td>3.0</td><td>4</td><td>NaN</td></tr><tr><th>1</th><td>NaN</td><td>5</td><td>6</td><td>NaN</td><td>8</td><td>world</td></tr><tr><th>2</th><td>three</td><td>9</td><td>10</td><td>11.0</td><td>12</td><td>NaN</td></tr></tbody></table></div><h3 id="pdread_table-path-sep--"><strong><em>pd.read_table( path, sep, ... )</em></strong></h3><h4 id="sep--分隔符"><strong><em>sep</em></strong> : 分隔符</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_table(<span class="string">'pydata-book-2nd-edition/examples/ex1.csv'</span>, sep=<span class="string">','</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>2</td><td>3</td><td>4</td><td>hello</td></tr><tr><th>1</th><td>5</td><td>6</td><td>7</td><td>8</td><td>world</td></tr><tr><th>2</th><td>9</td><td>10</td><td>11</td><td>12</td><td>foo</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>(<span class="built_in">open</span>(<span class="string">'pydata-book-2nd-edition/examples/ex3.txt'</span>))</span><br></pre></td></tr></table></figure><p>[' A B C',<br>'aaa -0.264438 -1.026059 -0.619500',<br>'bbb 0.927272 0.302904 -0.032399',<br>'ccc -0.264273 -0.386314 -0.217601',<br>'ddd -0.871858 -0.348382 1.100491']</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.read_table(<span class="string">'pydata-book-2nd-edition/examples/ex3.txt'</span>, sep=<span class="string">'\s+'</span>)</span><br><span class="line"><span class="comment"># 由于列名比数据行的数量少, 所以 read_table 推断第一列应该是 DataFrame 的索引</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>A</th><th>B</th><th>C</th></tr></thead><tbody><tr><th>aaa</th><td>-0.264438</td><td>-1.026059</td><td>-0.619500</td></tr><tr><th>bbb</th><td>0.927272</td><td>0.302904</td><td>-0.032399</td></tr><tr><th>ccc</th><td>-0.264273</td><td>-0.386314</td><td>-0.217601</td></tr><tr><th>ddd</th><td>-0.871858</td><td>-0.348382</td><td>1.100491</td></tr></tbody></table></div><h2 id="逐块读取文件">逐块读取文件</h2><h3 id="pdread_csv-path-nrows-"><strong><em>pd.read_csv( path, nrows )</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex6.csv'</span>, nrows=<span class="number">5</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th><th>three</th><th>four</th><th>key</th></tr></thead><tbody><tr><th>0</th><td>0.467976</td><td>-0.038649</td><td>-0.295344</td><td>-1.824726</td><td>L</td></tr><tr><th>1</th><td>-0.358893</td><td>1.404453</td><td>0.704965</td><td>-0.200638</td><td>B</td></tr><tr><th>2</th><td>-0.501840</td><td>0.659254</td><td>-0.421691</td><td>-0.057688</td><td>G</td></tr><tr><th>3</th><td>0.204886</td><td>1.074134</td><td>1.388361</td><td>-0.982404</td><td>R</td></tr><tr><th>4</th><td>0.354628</td><td>-0.133116</td><td>0.283763</td><td>-0.837063</td><td>Q</td></tr></tbody></table></div><h3 id="pdread_csv-path-chunksize---迭代器"><strong><em>pd.read_csv( path, chunksize )</em></strong> : 迭代器</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">chunker = pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex6.csv'</span>, chunksize=<span class="number">1000</span>)</span><br><span class="line"><span class="comment"># 设置分块大小为1000行</span></span><br><span class="line">tot = pd.Series([])</span><br><span class="line"><span class="keyword">for</span> piece <span class="keyword">in</span> chunker:</span><br><span class="line">    <span class="comment"># 1000行分块</span></span><br><span class="line">    tot = tot.add(piece[<span class="string">'key'</span>].value_counts(), fill_value=<span class="number">0</span>)  </span><br><span class="line">    <span class="comment"># piece['key'].value_counts() : 返回一个 series</span></span><br><span class="line">    <span class="comment"># 计算 key 中各值出现的次数</span></span><br><span class="line"></span><br><span class="line">tot = tot.sort_values(ascending=<span class="literal">False</span>)</span><br><span class="line">tot[:<span class="number">10</span>]</span><br></pre></td></tr></table></figure><p><ipython-input-19-c6c0008a71bc>:3: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.<br>tot = pd.Series([])</ipython-input-19-c6c0008a71bc></p><p>E 368.0<br>X 364.0<br>L 346.0<br>O 343.0<br>Q 340.0<br>M 338.0<br>J 337.0<br>F 335.0<br>K 334.0<br>H 330.0<br>dtype: float64</p><h2 id="写文件">写文件</h2><h3 id="framesto_csv-path-sep-na_rep-index-header-columns-"><strong><em>frames.to_csv( path, sep, na_rep, index, header, columns )</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_csv(<span class="string">'pydata-book-2nd-edition/examples/ex5.csv'</span>)</span><br><span class="line">data</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>something</th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>one</td><td>1</td><td>2</td><td>3.0</td><td>4</td><td>NaN</td></tr><tr><th>1</th><td>two</td><td>5</td><td>6</td><td>NaN</td><td>8</td><td>world</td></tr><tr><th>2</th><td>three</td><td>9</td><td>10</td><td>11.0</td><td>12</td><td>foo</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_csv(<span class="string">'pydata-book-2nd-edition/examples/out.csv'</span>)</span><br></pre></td></tr></table></figure><h4 id="sep--分隔符号"><strong><em>sep</em></strong> : 分隔符号</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.to_csv(sys.stdout, sep=<span class="string">'|'</span> )</span><br><span class="line"><span class="comment"># 直接写出到 sys.stdout , 所以仅仅是打印出文本结果而已</span></span><br></pre></td></tr></table></figure><p>|something|a|b|c|d|message<br>0|one|1|2|3.0|4|<br>1|two|5|6||8|world<br>2|three|9|10|11.0|12|foo</p><h4 id="na_rep--缺失值"><strong><em>na_rep</em></strong> : 缺失值</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_csv(sys.stdout, na_rep=<span class="string">'-9999'</span>)</span><br></pre></td></tr></table></figure><p>,something,a,b,c,d,message<br>0,one,1,2,3.0,4,-9999<br>1,two,5,6,-9999,8,world<br>2,three,9,10,11.0,12,foo</p><h4 id="index-header--索引-列标题的控制"><strong><em>index, header</em></strong> : 索引, 列标题的控制</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_csv(sys.stdout, index=<span class="literal">False</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>one,1,2,3.0,4,<br>two,5,6,,8,world<br>three,9,10,11.0,12,foo</p><h4 id="columns--输出指定的行或列"><strong><em>columns</em></strong> : 输出指定的行或列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_csv(sys.stdout, index=<span class="literal">False</span>, columns=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</span><br></pre></td></tr></table></figure><p>a,b,c<br>1,2,3.0<br>5,6,<br>9,10,11.0</p><h3 id="seriesto_csv-path-"><strong><em>series.to_csv( path )</em></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dates = pd.date_range(<span class="string">'1/1/2000'</span>, periods=<span class="number">7</span>)</span><br><span class="line">obj = pd.Series(np.arange(<span class="number">7</span>), index=dates)</span><br><span class="line">obj.to_csv(sys.stdout)</span><br></pre></td></tr></table></figure><p>,0<br>2000-01-01,0<br>2000-01-02,1<br>2000-01-03,2<br>2000-01-04,3<br>2000-01-05,4<br>2000-01-06,5<br>2000-01-07,6</p><h2 id="读写-excel-文件">读写 Excel 文件</h2><h3 id="pdexcelfile-path---pdread_excel-excelfile-sheet_name-"><strong><em>pd.ExcelFile( path ) + pd.read_excel( ExcelFile, sheet_name )</em></strong></h3><blockquote><p>读取一个文件的多个 sheet 时, 先创建 ExcelFile 传递路径, 然后使用 read_excel 读取, 速度更快</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xlsx = pd.ExcelFile(<span class="string">'pydata-book-2nd-edition/examples/ex1.xlsx'</span>)</span><br><span class="line">pd.read_excel(xlsx, <span class="string">'Sheet1'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Unnamed: 0</th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>hello</td></tr><tr><th>1</th><td>1</td><td>5</td><td>6</td><td>7</td><td>8</td><td>world</td></tr><tr><th>2</th><td>2</td><td>9</td><td>10</td><td>11</td><td>12</td><td>foo</td></tr></tbody></table></div><h3 id="pdread_excel-path-sheet_name-"><strong><em>pd.read_excel( path, sheet_name )</em></strong></h3><blockquote><p>直接传递文件路径到 pd.read_excel 中</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_excel(<span class="string">'pydata-book-2nd-edition/examples/ex1.xlsx'</span>, <span class="string">'Sheet1'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Unnamed: 0</th><th>a</th><th>b</th><th>c</th><th>d</th><th>message</th></tr></thead><tbody><tr><th>0</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>hello</td></tr><tr><th>1</th><td>1</td><td>5</td><td>6</td><td>7</td><td>8</td><td>world</td></tr><tr><th>2</th><td>2</td><td>9</td><td>10</td><td>11</td><td>12</td><td>foo</td></tr></tbody></table></div><h3 id="pdexcelwriter-path---frameto_excel-excelwriter-sheet_name---excelwritersave-"><strong><em>pd.ExcelWriter( path ) + frame.to_excel( ExcelWriter, sheet_name ) + ExcelWriter.save( )</em></strong></h3><blockquote><p>首先创建 ExcelWriter , 然后使用 to_excel 方法将数据写入到其中</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.read_excel(<span class="string">'pydata-book-2nd-edition/examples/ex1.xlsx'</span>, <span class="string">'Sheet1'</span>)</span><br><span class="line">writer = pd.ExcelWriter(<span class="string">'pydata-book-2nd-edition/examples/ex2.xlsx'</span>)</span><br><span class="line">frame.to_excel(writer, <span class="string">'Sheet1'</span>)</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure><h3 id="frameto_excel-path-sheet_name-"><strong><em>frame.to_excel( path, sheet_name )</em></strong></h3><blockquote><p>直接传递文件路径到 to_excel 中</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.to_excel(<span class="string">'pydata-book-2nd-edition/examples/ex2.xlsx'</span>, <span class="string">'Sheet1'</span>)</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="http://buujun.github.io/2022/cdo/03-pandas_04/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="undefined | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/cdo/03-pandas_04/" class="post-title-link" itemprop="url">数据分析-03-Pandas Pt.4</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:11:16 / 修改时间：10:30:37" itemprop="dateCreated datePublished" datetime="2022-07-31T16:11:16Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><span id="more"></span><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series, DataFrame</span><br></pre></td></tr></table></figure><h2 id="统计计算">统计计算</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame([[<span class="number">1</span>, np.nan], [<span class="number">2</span>, <span class="number">4</span>],</span><br><span class="line">                      [np.nan, np.nan], [<span class="number">3</span>, <span class="number">5</span>]],</span><br><span class="line">                    index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>],</span><br><span class="line">                    columns=[<span class="string">'one'</span>, <span class="string">'two'</span>])</span><br></pre></td></tr></table></figure><h3 id="objsum-axis-skipna-level---求和"><strong><em>obj.sum( axis, skipna, level )</em></strong> : 求和</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td></tr><tr><th>b</th><td>2.0</td><td>4.0</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>3.0</td><td>5.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure><p>one 6.0<br>two 9.0<br>dtype: float64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>a 1.0<br>b 6.0<br>c 0.0<br>d 8.0<br>dtype: float64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.<span class="built_in">sum</span>(axis=<span class="number">1</span>, skipna=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>a NaN<br>b 6.0<br>c NaN<br>d 8.0<br>dtype: float64</p><h3 id="objmean-axis-skipna-level---求平均数"><strong><em>obj.mean( axis, skipna, level )</em></strong> : 求平均数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.mean()</span><br></pre></td></tr></table></figure><p>one 2.0<br>two 4.5<br>dtype: float64</p><h3 id="objmedian-axis-skipna-level---求中位数"><strong><em>obj.median( axis, skipna, level )</em></strong> : 求中位数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.median()</span><br></pre></td></tr></table></figure><p>one 2.0<br>two 4.5<br>dtype: float64</p><h3 id="objmad-axis-skipna-level---求绝对离差-frac1nsumx-overlinex"><strong><em>obj.mad( axis, skipna, level )</em></strong> : 求绝对离差 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.798ex" xmlns="http://www.w3.org/2000/svg" width="11.711ex" height="2.755ex" role="img" focusable="false" viewbox="0 -864.9 5176 1217.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(255.4,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><rect width="624.3" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(1030.9,0)"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(2253.6,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"/></g><g data-mml-node="mi" transform="translate(2531.6,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3325.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(4326,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><svg width="572" height="237" x="0" y="148" viewbox="143 148 572 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(1.716,1)"/></svg></g></g><g data-mml-node="mo" transform="translate(4898,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"/></g></g></g></svg></mjx-container></span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.mad()</span><br></pre></td></tr></table></figure><p>one 0.666667<br>two 0.500000<br>dtype: float64</p><h3 id="objvar-axis-skipna-level---求方差-frac1nsumx-overlinex2"><strong><em>obj.var( axis, skipna, level )</em></strong> : 求方差 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.798ex" xmlns="http://www.w3.org/2000/svg" width="12.823ex" height="2.755ex" role="img" focusable="false" viewbox="0 -864.9 5667.9 1217.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(255.4,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><rect width="624.3" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(1030.9,0)"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(2086.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2475.9,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3270.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(4270.4,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><svg width="572" height="237" x="0" y="148" viewbox="143 148 572 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(1.716,1)"/></svg></g></g><g data-mml-node="msup" transform="translate(4842.4,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mn" transform="translate(422,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></svg></mjx-container></span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.var()</span><br></pre></td></tr></table></figure><p>one 1.0<br>two 0.5<br>dtype: float64</p><h3 id="objstd-axis-skipna-level---求标准差-sqrtfrac1nsumx-overlinex2"><strong><em>obj.std( axis, skipna, level )</em></strong> : 求标准差 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-1.304ex" xmlns="http://www.w3.org/2000/svg" width="15.131ex" height="4.208ex" role="img" focusable="false" viewbox="0 -1283.6 6687.9 1860"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msqrt"><g transform="translate(1020,0)"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(255.4,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><rect width="624.3" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(1030.9,0)"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(2086.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2475.9,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3270.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(4270.4,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><svg width="572" height="237" x="0" y="148" viewbox="143 148 572 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(1.716,1)"/></svg></g></g><g data-mml-node="msup" transform="translate(4842.4,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mn" transform="translate(422,289) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g><g data-mml-node="mo" transform="translate(0,73.6)"><path data-c="221A" d="M1001 1150Q1017 1150 1020 1132Q1020 1127 741 244L460 -643Q453 -650 436 -650H424Q423 -647 423 -645T421 -640T419 -631T415 -617T408 -594T399 -560T385 -512T367 -448T343 -364T312 -259L203 119L138 41L111 67L212 188L264 248L472 -474L983 1140Q988 1150 1001 1150Z"/></g><rect width="5667.9" height="60" x="1020" y="1163.6"/></g></g></g></svg></mjx-container></span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.std()</span><br></pre></td></tr></table></figure><p>one 1.000000<br>two 0.707107<br>dtype: float64</p><h3 id="objskew-axis-skipna-level---求偏度-fracfrac1nsumx-overlinex3sigma3"><strong><em>obj.skew( axis, skipna, level )</em></strong> : 求偏度 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.87ex" xmlns="http://www.w3.org/2000/svg" width="9.352ex" height="3.588ex" role="img" focusable="false" viewbox="0 -1201.1 4133.6 1585.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mrow" transform="translate(220,589.5) scale(0.707)"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(255.4,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><rect width="624.3" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(1030.9,0)"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(2086.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2475.9,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3047.9,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(3825.9,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><svg width="572" height="237" x="0" y="148" viewbox="143 148 572 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(1.716,1)"/></svg></g></g><g data-mml-node="msup" transform="translate(4397.9,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mn" transform="translate(422,363) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"/></g></g></g><g data-mml-node="msup" transform="translate(1710.6,-376.9) scale(0.707)"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g><g data-mml-node="mn" transform="translate(604,289) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"/></g></g><rect width="3893.6" height="60" x="120" y="220"/></g></g></g></svg></mjx-container></span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.skew()</span><br></pre></td></tr></table></figure><p>one 0.0<br>two NaN<br>dtype: float64</p><h3 id="objkurt-axis-skipna-level---求峰度-fracfrac1nsumx-overlinex4sigma4"><strong><em>obj.kurt( axis, skipna, level )</em></strong> : 求峰度 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.884ex" xmlns="http://www.w3.org/2000/svg" width="9.352ex" height="3.601ex" role="img" focusable="false" viewbox="0 -1201.1 4133.6 1591.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mrow" transform="translate(220,589.5) scale(0.707)"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(255.4,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><rect width="624.3" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(1030.9,0)"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(2086.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2475.9,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(3047.9,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(3825.9,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><svg width="572" height="237" x="0" y="148" viewbox="143 148 572 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(1.716,1)"/></svg></g></g><g data-mml-node="msup" transform="translate(4397.9,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mn" transform="translate(422,363) scale(0.707)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"/></g></g></g><g data-mml-node="msup" transform="translate(1710.6,-382.9) scale(0.707)"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g><g data-mml-node="mn" transform="translate(604,289) scale(0.707)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"/></g></g><rect width="3893.6" height="60" x="120" y="220"/></g></g></g></svg></mjx-container></span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>]).kurt()</span><br></pre></td></tr></table></figure><p>0 -0.7<br>dtype: float64</p><h3 id="objquantile-q-axis---求分位数二分位四分位四分之三分位--"><strong><em>obj.quantile( q, axis )</em></strong> : 求分位数（二分位、四分位、四分之三分位 ... ）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame, frame.quantile(<span class="number">0.5</span>), frame.mean()</span><br></pre></td></tr></table></figure><p>( one two<br>a 1.0 NaN<br>b 2.0 4.0<br>c NaN NaN<br>d 3.0 5.0,<br>one 2.0<br>two 4.5<br>Name: 0.5, dtype: float64,<br>one 2.0<br>two 4.5<br>dtype: float64)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.quantile(<span class="number">0.75</span>) - frame.quantile(<span class="number">0.25</span>) <span class="comment">### 离差IQR</span></span><br></pre></td></tr></table></figure><p>one 1.0<br>two 0.5<br>dtype: float64</p><h3 id="objcumsum-axis-skipna-level--objcumprod-axis-skipna-level---累加-累乘"><strong><em>obj.cumsum( axis, skipna, level ), obj.cumprod( axis, skipna, level )</em></strong> : 累加, 累乘</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td></tr><tr><th>b</th><td>2.0</td><td>4.0</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>3.0</td><td>5.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.cumsum()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td></tr><tr><th>b</th><td>3.0</td><td>4.0</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>6.0</td><td>9.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.cumprod()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td></tr><tr><th>b</th><td>2.0</td><td>4.0</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>6.0</td><td>20.0</td></tr></tbody></table></div><h3 id="objcummin-axis-skipna-level--objcummax-axis-skipna-level---累计最小值和累计最大值"><strong><em>obj.cummin( axis, skipna, level ), obj.cummax( axis, skipna, level )</em></strong> : 累计最小值和累计最大值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.cummax()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td></tr><tr><th>b</th><td>2.0</td><td>4.0</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>3.0</td><td>5.0</td></tr></tbody></table></div><h3 id="objidmax-axis-skipna-level--objidmin-axis-skipna-level---返回最大值或最小值的索引"><strong><em>obj.idmax( axis, skipna, level ), obj.idmin( axis, skipna, level )</em></strong> : 返回最大值或最小值的索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td></tr><tr><th>b</th><td>2.0</td><td>4.0</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>3.0</td><td>5.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.idxmax()</span><br></pre></td></tr></table></figure><p>one d<br>two d<br>dtype: object</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.idxmax(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>a one<br>b two<br>c NaN<br>d two<br>dtype: object</p><h3 id="objdescribe---返回多个汇总统计"><strong><em>obj.describe( )</em></strong> : 返回多个汇总统计</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>a</th><td>1.0</td><td>NaN</td></tr><tr><th>b</th><td>2.0</td><td>4.0</td></tr><tr><th>c</th><td>NaN</td><td>NaN</td></tr><tr><th>d</th><td>3.0</td><td>5.0</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.describe()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>one</th><th>two</th></tr></thead><tbody><tr><th>count</th><td>3.0</td><td>2.000000</td></tr><tr><th>mean</th><td>2.0</td><td>4.500000</td></tr><tr><th>std</th><td>1.0</td><td>0.707107</td></tr><tr><th>min</th><td>1.0</td><td>4.000000</td></tr><tr><th>25%</th><td>1.5</td><td>4.250000</td></tr><tr><th>50%</th><td>2.0</td><td>4.500000</td></tr><tr><th>75%</th><td>2.5</td><td>4.750000</td></tr><tr><th>max</th><td>3.0</td><td>5.000000</td></tr></tbody></table></div><h4 id="对于非数值类型">对于非数值类型</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = pd.Series([<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>] * <span class="number">4</span>)</span><br><span class="line">obj.head(), obj.describe()</span><br></pre></td></tr></table></figure><p>(0 a<br>1 a<br>2 b<br>3 c<br>4 a<br>dtype: object,<br>count 16<br>unique 3<br>top a<br>freq 8<br>dtype: object)</p><h3 id="series1cov-series2--framecov---计算协方差-covx-y--frac1nsumx-overlinexy-overliney"><strong><em>series1.cov( series2 ), frame.cov( )</em></strong> : 计算协方差 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.798ex" xmlns="http://www.w3.org/2000/svg" width="31.953ex" height="2.755ex" role="img" focusable="false" viewbox="0 -864.9 14123 1217.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"/></g><g data-mml-node="mi" transform="translate(760,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(1245,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="mo" transform="translate(1730,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2119,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"/></g><g data-mml-node="mo" transform="translate(2971,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(3415.7,0)"><path data-c="1D44C" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"/></g><g data-mml-node="mo" transform="translate(4178.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(4845.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(5901.2,0)"><g data-mml-node="mn" transform="translate(255.4,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><rect width="624.3" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(6932.2,0)"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(7988.2,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(8377.2,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(9171.4,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(10171.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><svg width="572" height="237" x="0" y="148" viewbox="143 148 572 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(1.716,1)"/></svg></g></g><g data-mml-node="mo" transform="translate(10743.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(11132.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(11521.6,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(12233.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(13234,0)"><g data-mml-node="mi" transform="translate(5,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><path data-c="2013" d="M0 248V285H499V248H0Z"/></g></g><g data-mml-node="mo" transform="translate(13734,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g></g></svg></mjx-container></span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据准备</span></span><br><span class="line">price = pd.read_pickle(<span class="string">'pydata-book-2nd-edition/examples/yahoo_price.pkl'</span>) <span class="comment">#股票价格</span></span><br><span class="line">volume = pd.read_pickle(<span class="string">'pydata-book-2nd-edition/examples/yahoo_volume.pkl'</span>) <span class="comment">#股票成交量</span></span><br><span class="line">returns = price.pct_change() <span class="comment">#计算变化率 : (后一个值 - 前一个值) / 前一个值</span></span><br><span class="line">returns</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>GOOG</th><th>IBM</th><th>MSFT</th></tr><tr><th>Date</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>2010-01-04</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>2010-01-05</th><td>0.001729</td><td>-0.004404</td><td>-0.012080</td><td>0.000323</td></tr><tr><th>2010-01-06</th><td>-0.015906</td><td>-0.025209</td><td>-0.006496</td><td>-0.006137</td></tr><tr><th>2010-01-07</th><td>-0.001849</td><td>-0.023280</td><td>-0.003462</td><td>-0.010400</td></tr><tr><th>2010-01-08</th><td>0.006648</td><td>0.013331</td><td>0.010035</td><td>0.006897</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>2016-10-17</th><td>-0.000680</td><td>0.001837</td><td>0.002072</td><td>-0.003483</td></tr><tr><th>2016-10-18</th><td>-0.000681</td><td>0.019616</td><td>-0.026168</td><td>0.007690</td></tr><tr><th>2016-10-19</th><td>-0.002979</td><td>0.007846</td><td>0.003583</td><td>-0.002255</td></tr><tr><th>2016-10-20</th><td>-0.000512</td><td>-0.005652</td><td>0.001719</td><td>-0.004867</td></tr><tr><th>2016-10-21</th><td>-0.003930</td><td>0.003011</td><td>-0.012474</td><td>0.042096</td></tr></tbody></table><p>1714 rows × 4 columns</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">returns[<span class="string">'MSFT'</span>].cov(returns[<span class="string">'IBM'</span>])</span><br></pre></td></tr></table></figure><p>8.870655479703546e-05</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">returns.cov()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>GOOG</th><th>IBM</th><th>MSFT</th></tr></thead><tbody><tr><th>AAPL</th><td>0.000277</td><td>0.000107</td><td>0.000078</td><td>0.000095</td></tr><tr><th>GOOG</th><td>0.000107</td><td>0.000251</td><td>0.000078</td><td>0.000108</td></tr><tr><th>IBM</th><td>0.000078</td><td>0.000078</td><td>0.000146</td><td>0.000089</td></tr><tr><th>MSFT</th><td>0.000095</td><td>0.000108</td><td>0.000089</td><td>0.000215</td></tr></tbody></table></div><h3 id="series1corr-series2--framecorr---计算相关系数-rho--fraccovx-ysigma_xsigma_y--fracsumx-overlinexy-overlineysqrtsumx-overlinex2sqrtsumy-overliney2"><strong><em>series1.corr( series2 ), frame.corr( )</em></strong> : 计算相关系数 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-1.654ex" xmlns="http://www.w3.org/2000/svg" width="33.112ex" height="4.037ex" role="img" focusable="false" viewbox="0 -1053.5 14635.4 1784.4"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70C" d="M58 -216Q25 -216 23 -186Q23 -176 73 26T127 234Q143 289 182 341Q252 427 341 441Q343 441 349 441T359 442Q432 442 471 394T510 276Q510 219 486 165T425 74T345 13T266 -10H255H248Q197 -10 165 35L160 41L133 -71Q108 -168 104 -181T92 -202Q76 -216 58 -216ZM424 322Q424 359 407 382T357 405Q322 405 287 376T231 300Q217 269 193 170L176 102Q193 26 260 26Q298 26 334 62Q367 92 389 158T418 266T424 322Z"/></g><g data-mml-node="mo" transform="translate(794.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(1850.6,0)"><g data-mml-node="mrow" transform="translate(220,516.8) scale(0.707)"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"/></g><g data-mml-node="mi" transform="translate(760,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(1245,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="mo" transform="translate(1730,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2119,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"/></g><g data-mml-node="mo" transform="translate(2971,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="mi" transform="translate(3249,0)"><path data-c="1D44C" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"/></g><g data-mml-node="mo" transform="translate(4012,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g><g data-mml-node="mrow" transform="translate(909.8,-345) scale(0.707)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g><g data-mml-node="mi" transform="translate(604,-150) scale(0.707)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"/></g></g><g data-mml-node="msub" transform="translate(1256.5,0)"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g><g data-mml-node="mi" transform="translate(604,-150) scale(0.707)"><path data-c="1D44C" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"/></g></g></g><rect width="3312" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(5680.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(6736.1,0)"><g data-mml-node="mrow" transform="translate(1721.6,516.8) scale(0.707)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(1056,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1445,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(2017,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(2795,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><svg width="572" height="237" x="0" y="148" viewbox="143 148 572 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(1.716,1)"/></svg></g></g><g data-mml-node="mo" transform="translate(3367,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(3756,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(4145,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(4635,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(5413,0)"><g data-mml-node="mi" transform="translate(5,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><path data-c="2013" d="M0 248V285H499V248H0Z"/></g></g><g data-mml-node="mo" transform="translate(5913,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g></g><g data-mml-node="mrow" transform="translate(220,-534.7) scale(0.707)"><g data-mml-node="msqrt"><g transform="translate(1020,0)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(1056,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1445,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(2017,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(2795,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><svg width="572" height="237" x="0" y="148" viewbox="143 148 572 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(1.716,1)"/></svg></g></g><g data-mml-node="msup" transform="translate(3367,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mn" transform="translate(422,289) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g><g data-mml-node="mo" transform="translate(0,54.9)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"/></g><rect width="4192.6" height="42.4" x="1020" y="862.5"/></g><g data-mml-node="mo" transform="translate(5212.6,0)"><path data-c="B7" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"/></g><g data-mml-node="msqrt" transform="translate(5490.6,0)"><g transform="translate(1020,0)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="mo" transform="translate(1056,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(1445,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(1935,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mover" transform="translate(2713,0)"><g data-mml-node="mi" transform="translate(5,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(0,374)"><path data-c="2013" d="M0 248V285H499V248H0Z"/></g></g><g data-mml-node="msup" transform="translate(3213,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mn" transform="translate(422,289) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g><g data-mml-node="mo" transform="translate(0,54.9)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"/></g><rect width="4038.6" height="42.4" x="1020" y="862.5"/></g></g><rect width="7659.3" height="60" x="120" y="220"/></g></g></g></svg></mjx-container></span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">returns[<span class="string">'MSFT'</span>].corr(returns[<span class="string">'IBM'</span>])</span><br></pre></td></tr></table></figure><p>0.4997636114415114</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">returns.corr()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>AAPL</th><th>GOOG</th><th>IBM</th><th>MSFT</th></tr></thead><tbody><tr><th>AAPL</th><td>1.000000</td><td>0.407919</td><td>0.386817</td><td>0.389695</td></tr><tr><th>GOOG</th><td>0.407919</td><td>1.000000</td><td>0.405099</td><td>0.465919</td></tr><tr><th>IBM</th><td>0.386817</td><td>0.405099</td><td>1.000000</td><td>0.499764</td></tr><tr><th>MSFT</th><td>0.389695</td><td>0.465919</td><td>0.499764</td><td>1.000000</td></tr></tbody></table></div><h3 id="obj1corrwith-obj2-axis---计算-obj1-与-obj2-对应行或列的相关系数"><strong><em>obj1.corrwith( obj2, axis )</em></strong> : 计算 obj1 与 obj2 对应行或列的相关系数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">returns.corrwith(returns.IBM)</span><br></pre></td></tr></table></figure><p>AAPL 0.386817<br>GOOG 0.405099<br>IBM 1.000000<br>MSFT 0.499764<br>dtype: float64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">returns.corrwith(volume) <span class="comment"># 一一对应</span></span><br></pre></td></tr></table></figure><p>AAPL -0.075565<br>GOOG -0.007067<br>IBM -0.204849<br>MSFT -0.092950<br>dtype: float64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">returns.T.corrwith(volume.T, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>AAPL -0.075565<br>GOOG -0.007067<br>IBM -0.204849<br>MSFT -0.092950<br>dtype: float64</p><h3 id="seriesunique-series2---得到-series-唯一值数组"><strong><em>series.unique( series2 )</em></strong> : 得到 series 唯一值数组</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = pd.Series([<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'c'</span>])</span><br><span class="line">obj.unique()</span><br></pre></td></tr></table></figure><p>array(['c', 'a', 'd', 'b'], dtype=object)</p><h3 id="objisin-list---判断-obj-的元素是否在-list-中"><strong><em>obj.isin( list )</em></strong> : 判断 obj 的元素是否在 list 中</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame([[<span class="number">1</span>, np.nan], [<span class="number">2</span>, <span class="number">4</span>],</span><br><span class="line">                   [np.nan, np.nan], [<span class="number">3</span>, <span class="number">5</span>]],</span><br><span class="line">                  index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>],</span><br><span class="line">                  columns=[<span class="string">'one'</span>, <span class="string">'two'</span>])</span><br><span class="line">frame, frame.isin([<span class="number">1</span>, <span class="number">2</span>])</span><br></pre></td></tr></table></figure><p>( one two<br>a 1.0 NaN<br>b 2.0 4.0<br>c NaN NaN<br>d 3.0 5.0,<br>one two<br>a True False<br>b True False<br>c False False<br>d False False)</p><h3 id="objvalue_counts-normalize-sort---计算-obj-中各值出现的频率"><strong><em>obj.value_counts( normalize, sort )</em></strong> : 计算 obj 中各值出现的频率</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = pd.Series([<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'c'</span>])</span><br><span class="line">obj.value_counts()</span><br></pre></td></tr></table></figure><p>c 3<br>a 3<br>b 2<br>d 1<br>dtype: int64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame([[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>],</span><br><span class="line">                      [<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]],</span><br><span class="line">                     index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>],</span><br><span class="line">                     columns=[<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'thr'</span>])</span><br><span class="line">frame, frame.value_counts()</span><br></pre></td></tr></table></figure><p>( one two thr<br>a 1 3 5<br>b 2 4 6<br>c 1 3 6<br>d 2 4 6,<br>one two thr<br>2 4 6 2<br>1 3 5 1<br>6 1<br>dtype: int64)</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><nav class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a></nav></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">BUUJUN WANG</span></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script src="/js/third-party/fancybox.js"></script><script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script><script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"http://buujun.github.io/"}</script><script src="/js/third-party/quicklink.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline-server-buujun.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":false,"pageview":false,"locale":{"placeholder":"Welcome to comment"},"emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo","https://unpkg.com/@waline/emojis@1.0.1/alus","https://unpkg.com/@waline/emojis@1.0.1/tw-emoji"],"meta":["nick","mail"],"requiredMeta":[],"wordLimit":300,"pageSize":10,"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>document.addEventListener("page:loaded",()=>{NexT.utils.loadComments(CONFIG.waline.el).then(()=>NexT.utils.getScript(CONFIG.waline.libUrl,{condition:window.Waline})).then(()=>Waline.init(Object.assign({},CONFIG.waline,{el:document.querySelector(CONFIG.waline.el)})))})</script><script async src="/js/cursor/fireworks.js"></script><script src="/js/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,document.body.addEventListener("input",POWERMODE)</script></body></html>