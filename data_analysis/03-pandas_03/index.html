<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/bj.apple-touch.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/bj.medium.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/bj.small.png"><link rel="mask-icon" href="/images/bj.svg" color="#222"><meta name="baidu-site-verification" content="true"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"www.buujun.fun","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat","show_result":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta name="description" content="这篇博客主要介绍 Pandas 的两种数据类型：Series 和 DataFrame 相关的内容 Pt.1 部分主要介绍对 Pandas 两种数据类型的基本操作，包括创建、索引和修改 Pt.2 部分详细介绍了 Pandas 的索引操作 Pt.3 部分主要介绍了 Pandas 的计算和函数 Pt.4 部分详细介绍了 Pandas 的统计计算相关的函数"><meta property="og:type" content="article"><meta property="og:title" content="Pandas - 语法基础 Pt.3"><meta property="og:url" content="https://www.buujun.fun/data_analysis/03-pandas_03/index.html"><meta property="og:site_name" content="BUUJUN&#39;s Notes"><meta property="og:description" content="这篇博客主要介绍 Pandas 的两种数据类型：Series 和 DataFrame 相关的内容 Pt.1 部分主要介绍对 Pandas 两种数据类型的基本操作，包括创建、索引和修改 Pt.2 部分详细介绍了 Pandas 的索引操作 Pt.3 部分主要介绍了 Pandas 的计算和函数 Pt.4 部分详细介绍了 Pandas 的统计计算相关的函数"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2022-07-31T16:11:15.000Z"><meta property="article:modified_time" content="2022-07-31T13:26:40.000Z"><meta property="article:author" content="BUUJUN WANG"><meta property="article:tag" content="python"><meta property="article:tag" content="pandas"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.buujun.fun/data_analysis/03-pandas_03/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.buujun.fun/data_analysis/03-pandas_03/","path":"data_analysis/03-pandas_03/","title":"Pandas - 语法基础 Pt.3"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Pandas - 语法基础 Pt.3 | BUUJUN's Notes</title><link rel="dns-prefetch" href="https://waline-server-buujun.vercel.app"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>mjx-container[jax=SVG]{direction:ltr}mjx-container[jax=SVG]>svg{overflow:visible}mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=SVG][justify=left]{text-align:left}mjx-container[jax=SVG][justify=right]{text-align:right}g[data-mml-node=merror]>g{fill:red;stroke:red}g[data-mml-node=merror]>rect[data-background]{fill:#ff0;stroke:none}g[data-mml-node=mtable]>line[data-line]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>rect[data-frame]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>.mjx-dashed{stroke-dasharray:140}g[data-mml-node=mtable]>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}g[data-mml-node=mtable]>svg{overflow:visible}[jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}[jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#f8f8f8;color:#000;box-shadow:2px 2px 5px #aaa}g[data-mml-node=maction][data-toggle]{cursor:pointer}mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#f8f8f8;color:#000}foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}.MathJax path{stroke-width:3}mjx-container[display=true]{overflow:auto hidden}mjx-container[display=true]+br{display:none}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">BUUJUN's Notes</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">love and share</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">18</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">2</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">37</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%AF%B9%E9%BD%90"><span class="nav-number">1.</span> <span class="nav-text">算术运算与数据对齐</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#---times-div"><span class="nav-number">1.1.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#df1add-df2-fill_value--%E7%AD%89%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E5%87%BD%E6%95%B0"><span class="nav-number">1.2.</span> <span class="nav-text">df1.add( df2, fill_value ) 等算术运算函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%95%B0%E7%AE%97%E6%B3%95"><span class="nav-number">1.3.</span> <span class="nav-text">算数算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#div-%E4%B8%8E-rdiv-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.4.</span> <span class="nav-text">div 与 rdiv 的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dataframe-%E4%B8%8E-series-%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BF%90%E7%AE%97"><span class="nav-number">2.</span> <span class="nav-text">DataFrame 与 Series 之间的运算</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%88%97%E7%B4%A2%E5%BC%95-columns--%E5%9C%A8%E8%A1%8C%E4%B8%8A%E5%B9%BF%E6%92%AD-"><span class="nav-number">2.1.</span> <span class="nav-text">匹配列索引 columns , 在行上广播</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E8%A1%8C%E7%B4%A2%E5%BC%95-index--%E5%9C%A8%E5%88%97%E4%B8%8A%E5%B9%BF%E6%92%AD-"><span class="nav-number">2.2.</span> <span class="nav-text">匹配行索引 index , 在列上广播</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%BA%94%E7%94%A8%E4%B8%8E%E6%98%A0%E5%B0%84"><span class="nav-number">3.</span> <span class="nav-text">函数应用与映射</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#numpy-%E5%87%BD%E6%95%B0%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-number">3.1.</span> <span class="nav-text">Numpy 函数的应用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#frameapply-func-axis---%E5%B0%86%E5%87%BD%E6%95%B0%E5%BA%94%E7%94%A8%E5%88%B0%E5%90%84%E5%88%97%E6%88%96%E5%90%84%E8%A1%8C%E6%89%80%E5%BD%A2%E6%88%90%E7%9A%84%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%8A"><span class="nav-number">3.2.</span> <span class="nav-text">frame.apply( func, axis ) : 将函数应用到各列或各行所形成的一维数组上</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#frameapplymap-func---%E5%B0%86%E5%87%BD%E6%95%B0%E6%98%A0%E5%B0%84%E5%88%B0%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84%E5%90%84%E4%B8%AA%E5%85%83%E7%B4%A0%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C"><span class="nav-number">3.3.</span> <span class="nav-text">frame.applymap( func ) : 将函数映射到对象中的各个元素进行操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-number">4.</span> <span class="nav-text">排序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#objsort_index-axis-ascending---%E6%8C%89%E7%B4%A2%E5%BC%95%E6%8E%92%E5%BA%8F"><span class="nav-number">4.1.</span> <span class="nav-text">obj.sort_index( axis, ascending ) : 按索引排序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%99%8D%E5%BA%8F"><span class="nav-number">4.1.1.</span> <span class="nav-text">降序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#objsort_values-by---%E6%8C%89%E5%80%BC%E6%8E%92%E5%BA%8F"><span class="nav-number">4.2.</span> <span class="nav-text">obj.sort_values( by ) : 按值排序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%A8%E6%8E%92%E5%BA%8F%E6%97%B6-%E4%BB%BB%E4%BD%95%E7%BC%BA%E5%A4%B1%E5%80%BC%E9%BB%98%E8%AE%A4%E9%83%BD%E4%BC%9A%E8%A2%AB%E6%94%BE%E5%88%B0%E6%9C%AB%E5%B0%BE"><span class="nav-number">4.2.1.</span> <span class="nav-text">在排序时, 任何缺失值默认都会被放到末尾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%92%E5%BA%8Fdataframe%E6%97%B6-%E5%B0%86%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E5%88%97%E7%9A%84%E5%90%8D%E5%AD%97%E4%BC%A0%E9%80%92%E7%BB%99-by-%E9%80%89%E9%A1%B9%E5%8F%AF%E4%BB%A5-%E6%A0%B9%E6%8D%AE%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E5%88%97%E7%9A%84%E5%80%BC%E6%8E%92%E5%BA%8F"><span class="nav-number">4.2.2.</span> <span class="nav-text">排序DataFrame时, 将一个或多个列的名字传递给 by 选项可以 根据一个或多个列的值排序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#objrank-axis-ascending-method---%E8%BF%94%E5%9B%9E%E5%90%84%E7%BB%84%E7%9A%84%E5%B9%B3%E5%9D%87%E6%8E%92%E5%90%8D"><span class="nav-number">4.3.</span> <span class="nav-text">obj.rank( axis, ascending, method ) : 返回各组的平均排名</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#methodfirst--%E6%A0%B9%E6%8D%AE%E5%80%BC%E5%9C%A8%E5%8E%9F%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%87%BA%E7%8E%B0%E7%9A%84%E9%A1%BA%E5%BA%8F%E7%BB%99%E5%87%BA%E6%8E%92%E5%90%8D"><span class="nav-number">4.3.1.</span> <span class="nav-text">method&#x3D;&#39;first&#39; : 根据值在原数据中出现的顺序给出排名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89%E9%99%8D%E5%BA%8F%E6%8E%92%E5%BA%8F"><span class="nav-number">4.3.2.</span> <span class="nav-text">按降序排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#method-%E9%80%89%E9%A1%B9"><span class="nav-number">4.3.3.</span> <span class="nav-text">method 选项</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="BUUJUN WANG" src="/images/bj.avatar.gif"><p class="site-author-name" itemprop="name">BUUJUN WANG</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">37</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">2</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">18</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://gitee.com/buujun" title="GitHub → https:&#x2F;&#x2F;gitee.com&#x2F;buujun" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:wangbj27@mail2.sysu.edu.cn" title="E-Mail → mailto:wangbj27@mail2.sysu.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="sidebar-line"></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> <a href="/archives" title="近期文章" target="_blank">近期文章</a></div><ul class="links-of-blogroll-list"><li><a href="/Linux/%E7%B3%BB%E7%BB%9F%E9%87%8D%E8%A3%85/" title="Ubuntu - 系统重装" target="_blank">Ubuntu - 系统重装</a></li><li><a href="/WRF/02-Running_WRF/" title="WRF - 运行" target="_blank">WRF - 运行</a></li><li><a href="/NCL/01-Installing_NCL/" title="NCL - 安装和配置" target="_blank">NCL - 安装和配置</a></li></ul></div><div class="sidebar-line"></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa-solid fa-paperclip fa-" aria-hidden="true"></i> <a href="/links" title="常用链接" target="_blank">常用链接</a></div></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://music.163.com/" title="Music → https:&#x2F;&#x2F;music.163.com" rel="noopener" target="_blank"><i class="fa fa-compact-disc fa-fw"></i>Music</a> </span><span class="links-of-author-item"><a href="https://www.bilibili.com/" title="Bilibili → https:&#x2F;&#x2F;www.bilibili.com" rel="noopener" target="_blank"><i class="fa-brands fa-bilibili fa-fw"></i>Bilibili</a> </span><span class="links-of-author-item"><a href="https://docs.scipy.org/doc/scipy/reference/index.html" title="SciPy → https:&#x2F;&#x2F;docs.scipy.org&#x2F;doc&#x2F;scipy&#x2F;reference&#x2F;index.html" rel="noopener" target="_blank"><i class="fa fa-calculator fa-fw"></i>SciPy</a> </span><span class="links-of-author-item"><a href="https://docs.xarray.dev/en/stable/api.html" title="Xarray → https:&#x2F;&#x2F;docs.xarray.dev&#x2F;en&#x2F;stable&#x2F;api.html" rel="noopener" target="_blank"><i class="fa fa-cube fa-fw"></i>Xarray</a> </span><span class="links-of-author-item"><a href="https://matplotlib.org/stable/api/axes_api.html" title="Matplotlib → https:&#x2F;&#x2F;matplotlib.org&#x2F;stable&#x2F;api&#x2F;axes_api.html" rel="noopener" target="_blank"><i class="fa fa-chart-pie fa-fw"></i>Matplotlib</a> </span><span class="links-of-author-item"><a href="https://pytorch.org/docs/stable/nn.html" title="PyTorch → https:&#x2F;&#x2F;pytorch.org&#x2F;docs&#x2F;stable&#x2F;nn.html" rel="noopener" target="_blank"><i class="fa fa-droplet fa-fw"></i>PyTorch</a></span></div></div></div></div><div class="sidebar"><div class="sidebar-music-inner sidebar-nav-active sidebar-toc-active"><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa-solid fa-headphones" aria-hidden="true"></i> 听听看吧</div></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="280" height="86" src="//music.163.com/outchain/player?type=2&id=551338024&auto=0&height=66"></iframe></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.buujun.fun/data_analysis/03-pandas_03/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/bj.avatar.gif"><meta itemprop="name" content="BUUJUN WANG"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="BUUJUN's Notes"><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Pandas - 语法基础 Pt.3 | BUUJUN's Notes"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Pandas - 语法基础 Pt.3</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-07-31 16:11:15 / 修改时间：13:26:40" itemprop="dateCreated datePublished" datetime="2022-07-31T16:11:15Z">2022-07-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>这篇博客主要介绍 Pandas 的两种数据类型：Series 和 DataFrame 相关的内容<br>Pt.1 部分主要介绍对 Pandas 两种数据类型的基本操作，包括创建、索引和修改<br>Pt.2 部分详细介绍了 Pandas 的索引操作<br>Pt.3 部分主要介绍了 Pandas 的计算和函数<br>Pt.4 部分详细介绍了 Pandas 的统计计算相关的函数<br><span id="more"></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series, DataFrame</span><br></pre></td></tr></table></figure><h2 id="算术运算与数据对齐">算术运算与数据对齐</h2><h3 id="---times-div"><span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="10.059ex" height="1.758ex" role="img" focusable="false" viewbox="0 -583 4446 777"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="mo" transform="translate(1222.7,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mo" transform="translate(2000.7,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="mo" transform="translate(2445.3,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"/></g><g data-mml-node="mo" transform="translate(3223.3,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"/></g><g data-mml-node="mo" transform="translate(3668,0)"><path data-c="F7" d="M318 466Q318 500 339 518T386 537Q418 537 438 517T458 466Q458 438 440 417T388 396Q355 396 337 417T318 466ZM56 237T56 250T70 270H706Q721 262 721 250T706 230H70Q56 237 56 250ZM318 34Q318 68 339 86T386 105Q418 105 438 85T458 34Q458 6 440 -15T388 -36Q355 -36 337 -15T318 34Z"/></g></g></g></svg></mjx-container></span></h3><blockquote><p>在将对象相加时如果索引对不同, 则结果的索引就是索引对的并集</p></blockquote><p>自动的数据对齐操作在不重叠的索引处引入了 NaN 值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s1 = pd.Series([<span class="number">7.3</span>, -<span class="number">2.5</span>, <span class="number">3.4</span>, <span class="number">1.5</span>], index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>])</span><br><span class="line">s2 = pd.Series([-<span class="number">2.1</span>, <span class="number">3.6</span>, -<span class="number">1.5</span>, <span class="number">4</span>, <span class="number">3.1</span>],</span><br><span class="line">               index=[<span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>])</span><br><span class="line">s1, s2</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(a    7.3</span><br><span class="line"> b   -2.5</span><br><span class="line"> c    3.4</span><br><span class="line"> d    1.5</span><br><span class="line"> dtype: float64,</span><br><span class="line"> c   -2.1</span><br><span class="line"> d    3.6</span><br><span class="line"> e   -1.5</span><br><span class="line"> f    4.0</span><br><span class="line"> g    3.1</span><br><span class="line"> dtype: float64)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s1+s2</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a    NaN</span><br><span class="line">b    NaN</span><br><span class="line">c    1.3</span><br><span class="line">d    5.1</span><br><span class="line">e    NaN</span><br><span class="line">f    NaN</span><br><span class="line">g    NaN</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><p>对于 DataFrame , 对齐操作会同时发生在行和列上</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(np.arange(<span class="number">9.</span>).reshape((<span class="number">3</span>, <span class="number">3</span>)), columns=<span class="built_in">list</span>(<span class="string">'bcd'</span>),</span><br><span class="line">                   index=[<span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Colorado'</span>])</span><br><span class="line">df2 = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)), columns=<span class="built_in">list</span>(<span class="string">'cde'</span>),</span><br><span class="line">                   index=[<span class="string">'Utah'</span>, <span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Oregon'</span>])</span><br><span class="line">df1, df2</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(            b    c    d</span><br><span class="line"> Ohio      0.0  1.0  2.0</span><br><span class="line"> Texas     3.0  4.0  5.0</span><br><span class="line"> Colorado  6.0  7.0  8.0,</span><br><span class="line">           c     d     e</span><br><span class="line"> Utah    0.0   1.0   2.0</span><br><span class="line"> Ohio    3.0   4.0   5.0</span><br><span class="line"> Texas   6.0   7.0   8.0</span><br><span class="line"> Oregon  9.0  10.0  11.0)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1+df2</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Colorado</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>Ohio</th><td>NaN</td><td>4.0</td><td>6.0</td><td>NaN</td></tr><tr><th>Oregon</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>Texas</th><td>NaN</td><td>10.0</td><td>12.0</td><td>NaN</td></tr><tr><th>Utah</th><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr></tbody></table></div><h3 id="df1add-df2-fill_value--等算术运算函数"><strong><em>df1.add( df2, fill_value )</em></strong> 等算术运算函数</h3><blockquote><p>算术运算中的缺失值 : <strong><em>fill_value</em></strong> : 当一个对象中某个位置在另一个对象中找不到时填充一个指定值</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.add(df2, fill_value=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Colorado</th><td>6.0</td><td>7.0</td><td>8.0</td><td>NaN</td></tr><tr><th>Ohio</th><td>0.0</td><td>4.0</td><td>6.0</td><td>5.0</td></tr><tr><th>Oregon</th><td>NaN</td><td>9.0</td><td>10.0</td><td>11.0</td></tr><tr><th>Texas</th><td>3.0</td><td>10.0</td><td>12.0</td><td>8.0</td></tr><tr><th>Utah</th><td>NaN</td><td>0.0</td><td>1.0</td><td>2.0</td></tr></tbody></table></div><h3 id="算数算法">算数算法</h3><table><thead><tr class="header"><th><strong>类型</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr class="odd"><td><em>add, radd</em></td><td>用于加法（+）运算</td></tr><tr class="even"><td><em>sub, rsub</em></td><td>用于减法（-）运算</td></tr><tr class="odd"><td><em>div, rdiv</em></td><td>用于除法（/）运算</td></tr><tr class="even"><td><em>floordiv, rfloordiv</em></td><td>用于整除（//）运算</td></tr><tr class="odd"><td><em>mod, rmod</em></td><td>用于取余（%）运算</td></tr><tr class="even"><td><em>divmod, rdivmod</em></td><td>用于取整和取余（// 和 %）运算</td></tr><tr class="odd"><td><em>mul, rmul</em></td><td>用于乘法（*）运算</td></tr><tr class="even"><td><em>pow, rpow</em></td><td>用于指数（**）运算</td></tr></tbody></table><h3 id="div-与-rdiv-的区别"><strong><em>div</em></strong> 与 <strong><em>rdiv</em></strong> 的区别</h3><blockquote><p><strong><em>df1.div(df2)</em></strong> : df1/df2 ; <strong><em>df1.rdiv(df2)</em></strong> : df2/df1</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s1 = pd.Series(<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">6</span>)), index=<span class="built_in">list</span>(<span class="string">'abcde'</span>))</span><br><span class="line">s2 = pd.Series(<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">4</span>,<span class="number">9</span>)), index=<span class="built_in">list</span>(<span class="string">'cdefg'</span>))</span><br><span class="line">s1, s2</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(a    1</span><br><span class="line"> b    2</span><br><span class="line"> c    3</span><br><span class="line"> d    4</span><br><span class="line"> e    5</span><br><span class="line"> dtype: int64,</span><br><span class="line"> c    4</span><br><span class="line"> d    5</span><br><span class="line"> e    6</span><br><span class="line"> f    7</span><br><span class="line"> g    8</span><br><span class="line"> dtype: int64)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s1.mod(s2), s1.rmod(s2)  <span class="comment"># s1/s2, s2/s1</span></span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(a    NaN</span><br><span class="line"> b    NaN</span><br><span class="line"> c    3.0</span><br><span class="line"> d    4.0</span><br><span class="line"> e    5.0</span><br><span class="line"> f    NaN</span><br><span class="line"> g    NaN</span><br><span class="line"> dtype: float64,</span><br><span class="line"> a    NaN</span><br><span class="line"> b    NaN</span><br><span class="line"> c    1.0</span><br><span class="line"> d    1.0</span><br><span class="line"> e    1.0</span><br><span class="line"> f    NaN</span><br><span class="line"> g    NaN</span><br><span class="line"> dtype: float64)</span><br></pre></td></tr></table></figure><h2 id="dataframe-与-series-之间的运算">DataFrame 与 Series 之间的运算</h2><blockquote><p>广播</p></blockquote><h3 id="匹配列索引-columns--在行上广播-">匹配列索引 columns , 在行上广播 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.131ex" height="2.009ex" role="img" focusable="false" viewbox="0 -694 500 888"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2193" d="M473 86Q483 86 483 67Q483 63 483 61T483 56T481 53T480 50T478 48T474 47T470 46T464 44Q428 35 391 14T316 -55T264 -168Q264 -170 263 -173T262 -180T261 -184Q259 -194 251 -194Q242 -194 238 -176T221 -121T180 -49Q169 -34 155 -21T125 2T95 20T67 33T44 42T27 47L21 49Q17 53 17 67Q17 87 28 87Q33 87 42 84Q158 52 223 -45L230 -55V312Q230 391 230 482T229 591Q229 662 231 676T243 693Q244 694 251 694Q264 692 270 679V-55L277 -45Q307 1 353 33T430 76T473 86Z"/></g></g></g></svg></mjx-container></span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)),</span><br><span class="line">                     columns=<span class="built_in">list</span>(<span class="string">'bde'</span>),</span><br><span class="line">                     index=[<span class="string">'Utah'</span>, <span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Oregon'</span>])</span><br><span class="line">series = frame.iloc[<span class="number">0</span>]</span><br><span class="line">frame, series</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(          b     d     e</span><br><span class="line"> Utah    0.0   1.0   2.0</span><br><span class="line"> Ohio    3.0   4.0   5.0</span><br><span class="line"> Texas   6.0   7.0   8.0</span><br><span class="line"> Oregon  9.0  10.0  11.0,</span><br><span class="line"> b    0.0</span><br><span class="line"> d    1.0</span><br><span class="line"> e    2.0</span><br><span class="line"> Name: Utah, dtype: float64)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame-series</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><th>Ohio</th><td>3.0</td><td>3.0</td><td>3.0</td></tr><tr><th>Texas</th><td>6.0</td><td>6.0</td><td>6.0</td></tr><tr><th>Oregon</th><td>9.0</td><td>9.0</td><td>9.0</td></tr></tbody></table></div><p>参与运算的两个对象的索引不重合时, 形成并集</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">series2 = pd.Series(<span class="built_in">range</span>(<span class="number">3</span>), index=[<span class="string">'b'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>])</span><br><span class="line">frame + series2</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th><th>f</th></tr></thead><tbody><tr><th>Utah</th><td>0.0</td><td>NaN</td><td>3.0</td><td>NaN</td></tr><tr><th>Ohio</th><td>3.0</td><td>NaN</td><td>6.0</td><td>NaN</td></tr><tr><th>Texas</th><td>6.0</td><td>NaN</td><td>9.0</td><td>NaN</td></tr><tr><th>Oregon</th><td>9.0</td><td>NaN</td><td>12.0</td><td>NaN</td></tr></tbody></table></div><h3 id="匹配行索引-index--在列上广播-">匹配行索引 index , 在列上广播 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewbox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g></g></g></svg></mjx-container></span></h3><p><strong><em>frame.sub(series, axis)</em></strong> : 匹配轴 axis 进行广播, 其他算数运算函数同理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.arange(<span class="number">12.</span>).reshape((<span class="number">4</span>, <span class="number">3</span>)),</span><br><span class="line">                     columns=<span class="built_in">list</span>(<span class="string">'bde'</span>),</span><br><span class="line">                     index=[<span class="string">'Utah'</span>, <span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Oregon'</span>])</span><br><span class="line">series3 = frame[<span class="string">'d'</span>]</span><br><span class="line">frame, series3</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(          b     d     e</span><br><span class="line"> Utah    0.0   1.0   2.0</span><br><span class="line"> Ohio    3.0   4.0   5.0</span><br><span class="line"> Texas   6.0   7.0   8.0</span><br><span class="line"> Oregon  9.0  10.0  11.0,</span><br><span class="line"> Utah       1.0</span><br><span class="line"> Ohio       4.0</span><br><span class="line"> Texas      7.0</span><br><span class="line"> Oregon    10.0</span><br><span class="line"> Name: d, dtype: float64)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.sub(series3, axis=<span class="string">'index'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>-1.0</td><td>0.0</td><td>1.0</td></tr><tr><th>Ohio</th><td>-1.0</td><td>0.0</td><td>1.0</td></tr><tr><th>Texas</th><td>-1.0</td><td>0.0</td><td>1.0</td></tr><tr><th>Oregon</th><td>-1.0</td><td>0.0</td><td>1.0</td></tr></tbody></table></div><h2 id="函数应用与映射">函数应用与映射</h2><h3 id="numpy-函数的应用">Numpy 函数的应用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), columns=<span class="built_in">list</span>(<span class="string">'bde'</span>),</span><br><span class="line">                     index=[<span class="string">'Utah'</span>, <span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Oregon'</span>])</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>1.014427</td><td>-0.171110</td><td>-0.209578</td></tr><tr><th>Ohio</th><td>0.384411</td><td>0.098477</td><td>0.425979</td></tr><tr><th>Texas</th><td>0.618812</td><td>-0.087757</td><td>0.498332</td></tr><tr><th>Oregon</th><td>0.329589</td><td>-1.004679</td><td>0.205972</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.<span class="built_in">abs</span>(frame)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>1.014427</td><td>0.171110</td><td>0.209578</td></tr><tr><th>Ohio</th><td>0.384411</td><td>0.098477</td><td>0.425979</td></tr><tr><th>Texas</th><td>0.618812</td><td>0.087757</td><td>0.498332</td></tr><tr><th>Oregon</th><td>0.329589</td><td>1.004679</td><td>0.205972</td></tr></tbody></table></div><h3 id="frameapply-func-axis---将函数应用到各列或各行所形成的一维数组上"><strong><em>frame.apply( func, axis )</em></strong> : 将函数应用到各列或各行所形成的一维数组上</h3><blockquote><p>默认对 index 进行操作 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="1.131ex" height="2.009ex" role="img" focusable="false" viewbox="0 -694 500 888"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2193" d="M473 86Q483 86 483 67Q483 63 483 61T483 56T481 53T480 50T478 48T474 47T470 46T464 44Q428 35 391 14T316 -55T264 -168Q264 -170 263 -173T262 -180T261 -184Q259 -194 251 -194Q242 -194 238 -176T221 -121T180 -49Q169 -34 155 -21T125 2T95 20T67 33T44 42T27 47L21 49Q17 53 17 67Q17 87 28 87Q33 87 42 84Q158 52 223 -45L230 -55V312Q230 391 230 482T229 591Q229 662 231 676T243 693Q244 694 251 694Q264 692 270 679V-55L277 -45Q307 1 353 33T430 76T473 86Z"/></g></g></g></svg></mjx-container></span>, axis='columns' 时对 columns 进行操作 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewbox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g></g></g></svg></mjx-container></span></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">frame =  pd.DataFrame(np.random.randn(<span class="number">4</span>, <span class="number">3</span>), columns=<span class="built_in">list</span>(<span class="string">'bde'</span>),</span><br><span class="line">                     index=[<span class="string">'Utah'</span>, <span class="string">'Ohio'</span>, <span class="string">'Texas'</span>, <span class="string">'Oregon'</span>])</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>-0.504649</td><td>-0.773222</td><td>3.765686</td></tr><tr><th>Ohio</th><td>-1.138202</td><td>0.029167</td><td>0.841352</td></tr><tr><th>Texas</th><td>-0.649582</td><td>0.596585</td><td>-0.854243</td></tr><tr><th>Oregon</th><td>-0.353114</td><td>1.173491</td><td>-1.507888</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="keyword">lambda</span> x: x.<span class="built_in">max</span>() - x.<span class="built_in">min</span>()  <span class="comment"># func_name = lambda vars_in: vars_out </span></span><br><span class="line">frame.apply(f), frame.apply(f, axis=<span class="string">'columns'</span>)  <span class="comment"># f(frame)</span></span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(b    0.785088</span><br><span class="line"> d    1.946713</span><br><span class="line"> e    5.273573</span><br><span class="line"> dtype: float64,</span><br><span class="line"> Utah      4.538908</span><br><span class="line"> Ohio      1.979554</span><br><span class="line"> Texas     1.450828</span><br><span class="line"> Oregon    2.681378</span><br><span class="line"> dtype: float64)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x.<span class="built_in">max</span>()-x.<span class="built_in">min</span>()</span><br><span class="line">frame.apply(f)</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b    0.785088</span><br><span class="line">d    1.946713</span><br><span class="line">e    5.273573</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><p>计算各列/各行的最大值和最小值<br>&gt; 对各行/列操作的返回的结果可以是由多个值组成的 Series</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> pd.Series([x.<span class="built_in">min</span>(), x.<span class="built_in">max</span>()], index=[<span class="string">'min'</span>, <span class="string">'max'</span>])</span><br><span class="line">frame.apply(f)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>min</th><td>-1.138202</td><td>-0.773222</td><td>-1.507888</td></tr><tr><th>max</th><td>-0.353114</td><td>1.173491</td><td>3.765686</td></tr></tbody></table></div><h3 id="frameapplymap-func---将函数映射到对象中的各个元素进行操作"><strong><em>frame.applymap( func )</em></strong> : 将函数映射到对象中的各个元素进行操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>-0.504649</td><td>-0.773222</td><td>3.765686</td></tr><tr><th>Ohio</th><td>-1.138202</td><td>0.029167</td><td>0.841352</td></tr><tr><th>Texas</th><td>-0.649582</td><td>0.596585</td><td>-0.854243</td></tr><tr><th>Oregon</th><td>-0.353114</td><td>1.173491</td><td>-1.507888</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fmap = <span class="keyword">lambda</span> x: <span class="string">'%.2f'</span> % (x*<span class="number">10</span>) <span class="comment"># 只保留两位小数</span></span><br><span class="line">frame.applymap(fmap)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>d</th><th>e</th></tr></thead><tbody><tr><th>Utah</th><td>-5.05</td><td>-7.73</td><td>37.66</td></tr><tr><th>Ohio</th><td>-11.38</td><td>0.29</td><td>8.41</td></tr><tr><th>Texas</th><td>-6.50</td><td>5.97</td><td>-8.54</td></tr><tr><th>Oregon</th><td>-3.53</td><td>11.73</td><td>-15.08</td></tr></tbody></table></div><h2 id="排序">排序</h2><h3 id="objsort_index-axis-ascending---按索引排序"><strong><em>obj.sort_index( axis, ascending )</em></strong> : 按索引排序</h3><blockquote><p>ascending : 是否按升序排序</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = pd.Series(<span class="built_in">range</span>(<span class="number">4</span>), index=[<span class="string">'d'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</span><br><span class="line">obj.sort_index()</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a    1</span><br><span class="line">b    2</span><br><span class="line">c    3</span><br><span class="line">d    0</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.arange(<span class="number">8</span>).reshape((<span class="number">2</span>, <span class="number">4</span>)),</span><br><span class="line">                     index=[<span class="string">'three'</span>, <span class="string">'one'</span>],</span><br><span class="line">                     columns=[<span class="string">'d'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>d</th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>three</th><td>0</td><td>1</td><td>2</td><td>3</td></tr><tr><th>one</th><td>4</td><td>5</td><td>6</td><td>7</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.sort_index()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>d</th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>one</th><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><th>three</th><td>0</td><td>1</td><td>2</td><td>3</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.sort_index(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>a</th><th>b</th><th>c</th><th>d</th></tr></thead><tbody><tr><th>three</th><td>1</td><td>2</td><td>3</td><td>0</td></tr><tr><th>one</th><td>5</td><td>6</td><td>7</td><td>4</td></tr></tbody></table></div><h4 id="降序">降序</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.sort_index(axis=<span class="number">1</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>d</th><th>c</th><th>b</th><th>a</th></tr></thead><tbody><tr><th>three</th><td>0</td><td>3</td><td>2</td><td>1</td></tr><tr><th>one</th><td>4</td><td>7</td><td>6</td><td>5</td></tr></tbody></table></div><h3 id="objsort_values-by---按值排序"><strong><em>obj.sort_values( by )</em></strong> : 按值排序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = pd.Series([<span class="number">4</span>, <span class="number">7</span>, -<span class="number">3</span>, <span class="number">2</span>])</span><br><span class="line">obj.sort_values()</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2   -3</span><br><span class="line">3    2</span><br><span class="line">0    4</span><br><span class="line">1    7</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure><h4 id="在排序时-任何缺失值默认都会被放到末尾">在排序时, 任何缺失值默认都会被放到末尾</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = pd.Series([<span class="number">4</span>, np.nan, <span class="number">7</span>, np.nan, -<span class="number">3</span>, <span class="number">2</span>])</span><br><span class="line">obj.sort_values()</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">4   -3.0</span><br><span class="line">5    2.0</span><br><span class="line">0    4.0</span><br><span class="line">2    7.0</span><br><span class="line">1    NaN</span><br><span class="line">3    NaN</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><h4 id="排序dataframe时-将一个或多个列的名字传递给-by-选项可以-根据一个或多个列的值排序">排序DataFrame时, 将一个或多个列的名字传递给 <strong><em>by</em></strong> 选项可以 根据一个或多个列的值排序</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame({<span class="string">'b'</span>: [<span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">2</span>], <span class="string">'a'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>], <span class="string">'c'</span>: [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]})</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>a</th><th>c</th></tr></thead><tbody><tr><th>0</th><td>4</td><td>0</td><td>4</td></tr><tr><th>1</th><td>7</td><td>1</td><td>3</td></tr><tr><th>2</th><td>2</td><td>0</td><td>2</td></tr><tr><th>3</th><td>2</td><td>1</td><td>1</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.sort_values(by=<span class="string">'b'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>a</th><th>c</th></tr></thead><tbody><tr><th>2</th><td>2</td><td>0</td><td>2</td></tr><tr><th>3</th><td>2</td><td>1</td><td>1</td></tr><tr><th>0</th><td>4</td><td>0</td><td>4</td></tr><tr><th>1</th><td>7</td><td>1</td><td>3</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.sort_values(by=[<span class="string">'b'</span>, <span class="string">'c'</span>])</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>a</th><th>c</th></tr></thead><tbody><tr><th>3</th><td>2</td><td>1</td><td>1</td></tr><tr><th>2</th><td>2</td><td>0</td><td>2</td></tr><tr><th>0</th><td>4</td><td>0</td><td>4</td></tr><tr><th>1</th><td>7</td><td>1</td><td>3</td></tr></tbody></table></div><h3 id="objrank-axis-ascending-method---返回各组的平均排名"><strong><em>obj.rank( axis, ascending, method )</em></strong> : 返回各组的平均排名</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = pd.Series([<span class="number">7</span>, -<span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>])</span><br><span class="line">obj.rank()</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0    6.5</span><br><span class="line">1    1.0</span><br><span class="line">2    6.5</span><br><span class="line">3    4.5</span><br><span class="line">4    3.0</span><br><span class="line">5    2.0</span><br><span class="line">6    4.5</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><h4 id="methodfirst--根据值在原数据中出现的顺序给出排名"><strong><em>method='first'</em></strong> : 根据值在原数据中出现的顺序给出排名</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.rank(method=<span class="string">'first'</span>)</span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0    6.0</span><br><span class="line">1    1.0</span><br><span class="line">2    7.0</span><br><span class="line">3    4.0</span><br><span class="line">4    3.0</span><br><span class="line">5    2.0</span><br><span class="line">6    5.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><h4 id="按降序排序">按降序排序</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.rank(ascending=<span class="literal">False</span>, method=<span class="string">'min'</span>)  <span class="comment"># 并列第一、并列第三...</span></span><br></pre></td></tr></table></figure><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0    1.0</span><br><span class="line">1    7.0</span><br><span class="line">2    1.0</span><br><span class="line">3    3.0</span><br><span class="line">4    5.0</span><br><span class="line">5    6.0</span><br><span class="line">6    3.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame({<span class="string">'b'</span>: [<span class="number">4.3</span>, <span class="number">7</span>, -<span class="number">3</span>, <span class="number">2</span>], <span class="string">'a'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">                      <span class="string">'c'</span>: [-<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, -<span class="number">2.5</span>]})</span><br><span class="line">frame</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>a</th><th>c</th></tr></thead><tbody><tr><th>0</th><td>4.3</td><td>0</td><td>-2.0</td></tr><tr><th>1</th><td>7.0</td><td>1</td><td>5.0</td></tr><tr><th>2</th><td>-3.0</td><td>0</td><td>8.0</td></tr><tr><th>3</th><td>2.0</td><td>1</td><td>-2.5</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.rank(axis=<span class="string">'columns'</span>)</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>b</th><th>a</th><th>c</th></tr></thead><tbody><tr><th>0</th><td>3.0</td><td>2.0</td><td>1.0</td></tr><tr><th>1</th><td>3.0</td><td>1.0</td><td>2.0</td></tr><tr><th>2</th><td>1.0</td><td>2.0</td><td>3.0</td></tr><tr><th>3</th><td>3.0</td><td>2.0</td><td>1.0</td></tr></tbody></table></div><h4 id="method-选项"><strong><em>method</em></strong> 选项</h4><table><thead><tr class="header"><th><strong>类型</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr class="odd"><td><em>average</em></td><td>给相等的分组分配平均排名（默认）</td></tr><tr class="even"><td><em>min</em></td><td>给相等的分组分配最小排名</td></tr><tr class="odd"><td><em>max</em></td><td>给相等的分组分配最大排名</td></tr><tr class="even"><td><em>first</em></td><td>对相等的分组按出现顺序排名</td></tr><tr class="odd"><td><em>dense</em></td><td>类似于 min , 但是组间排名总是相差1</td></tr></tbody></table></div><footer class="post-footer"><div class="reward-container"><div>您的支持是我创作的最大动力！</div><button>赞赏</button><div class="post-reward"><div><img src="/images/wechatpay.png" alt="BUUJUN WANG 微信"> <span>微信</span></div><div><img src="/images/alipay.png" alt="BUUJUN WANG 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>本文作者： </strong>BUUJUN WANG</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://www.buujun.fun/data_analysis/03-pandas_03/" title="Pandas - 语法基础 Pt.3">https://www.buujun.fun/data_analysis/03-pandas_03/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="post-tags"><a href="/tags/python/" rel="tag"># python</a> <a href="/tags/pandas/" rel="tag"># pandas</a></div><div class="post-nav"><div class="post-nav-item"><a href="/data_analysis/03-pandas_02/" rel="prev" title="Pandas - 语法基础 Pt.2"><i class="fa fa-chevron-left"></i> Pandas - 语法基础 Pt.2</a></div><div class="post-nav-item"><a href="/data_analysis/03-pandas_04/" rel="next" title="Pandas - 语法基础 Pt.4">Pandas - 语法基础 Pt.4 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">BUUJUN WANG</span></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.3/mermaid.min.js","integrity":"sha256-TIYL00Rhw/8WaoUhYTLX9SKIEFdXxg+yMWSLVUbhiLg="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/fancybox.js"></script><script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script><script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://www.buujun.fun/data_analysis/03-pandas_03/"}</script><script src="/js/third-party/quicklink.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline-server-buujun.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":false,"pageview":false,"locale":{"placeholder":"Welcome to comment"},"emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo","https://unpkg.com/@waline/emojis@1.0.1/alus","https://unpkg.com/@waline/emojis@1.0.1/tw-emoji"],"meta":["nick","mail"],"requiredMeta":[],"wordLimit":300,"pageSize":10,"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/data_analysis/03-pandas_03/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>document.addEventListener("page:loaded",()=>{NexT.utils.loadComments(CONFIG.waline.el).then(()=>NexT.utils.getScript(CONFIG.waline.libUrl,{condition:window.Waline})).then(()=>Waline.init(Object.assign({},CONFIG.waline,{el:document.querySelector(CONFIG.waline.el)})))})</script><script async src="/js/cursor/fireworks.js"></script><script src="/js/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,document.body.addEventListener("input",POWERMODE)</script></body></html>